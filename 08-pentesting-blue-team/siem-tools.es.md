## **Herramientas SIEM**

### **Snorby**

Snorby es un interfaz para la monitorización de alertas basado en Ruby20. La ventaja clave es la flexibilidad, es decir, se puede configurar la interfaz para que acepte eventos provenientes de diferentes aplicaciones, siendo solo necesario añadir determinados códigos. Snorby se utiliza para supervisar la seguridad de red gracias a la incorporación de eventos de IDS/IPS como Snort o Suricata.

![Snorby](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/snorby.png?raw=true)

Mediante la captura de paquetes (CapME21) proporcionados por Snorby, se puede hacer un filtrado con las características que se deseen, por ejemplo seleccionar dirección del equipo y destino, el protocolo de transmisión, la fecha y hora en la que queremos buscar en la base de datos para obtener todos los eventos relacionados. De esta forma, se simplifica la búsqueda y permite centrar el análisis en los eventos necesarios.

### **Sguil**

La herramienta Sguil está construida por y para los analistas de seguridad de red. El principal componente de Sguil es una interfaz gráfica de usuario que proporciona acceso a los eventos en tiempo real, datos de sesión, y capturas de paquetes. Sguil facilita el seguimiento y análisis de eventos en la red. El cliente Sguil se puede ejecutar en multitud de sistemas operativos, incluyendo Linux, BSD, Solaris, MacOS y Windows.

![Sguil](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/sguil.png?raw=true)

Sguil proporciona visibilidad sobre los datos de evento recogidos y el contexto para validar la detección. Proporciona una única interfaz gráfica de usuario, en cual, se ven las alertas de Snort o Suricata, alertas OSSEC, eventos HTTP Bro, y las alertas del sistema de detección pasivo de activos en tiempo real (PRADS23).

Más importante aún, Sguil permite ver todo el tráfico asociado a una alerta, consultar todos los paquetes capturados, y también el tráfico que no tiene porqué pertenecer a esa alerta, pero podría estar asociado con la actividad maliciosa o no deseada.

Sguil se diferencia de otras interfaces de alerta en que permite la colaboración entre los analistas permitiendo comentar las alertas.

![Sguil1](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/sguil1.png?raw=true)

### **Squert**

Squert es una aplicación web que se utiliza para consultar y ver eventos de datos almacenados en una base de datos Sguil (por lo general son breves datos de alerta). Squert es una herramienta visual que intenta proporcionar información adicional a los eventos a través del uso de metadatos, representaciones de series de tiempo, ponderaciones y conjuntos de resultados agrupados de forma lógica.

![Squert](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/squert.png?raw=true)

La herramienta para búsqueda y almacenado de logs de empresa (ELSA - Enterprise Log Search and Archive) es un analizador de eventos que opera en tres niveles: receptor de log, base de datos o almacenador e interfaz web para syslog entrantes. Aprovecha un analizador basado en una base de patrones para la normalización de eventos y usa el motor de búsqueda Sphinx26 para la indexación de texto completo para realizar la búsqueda de eventos.

ELSA permite realizar una exploración que puede estar escalada en los diferentes nodos que tenga un sistema distribuido. El proceso de normalización asigna a cada usuario entrante un identificador según la clase de usuario. Los usuarios pueden conceder permisos (listas blancas) granulares para un host o programa, es decir, un usuario puede limitarse a uno o varios hosts pero es capaz de consultar cualquier programa o clase en estos equipos. ELSA se divide en tres componentes principales: los nodos finales, el DAEMON27 (proceso demonio) que se ejecuta en el servidor web, y el propio sitio Web. Los nodos no tienen conocimiento de la interfaz web y responden a cualquier petición a su puerto de escucha.

![Squert1](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/squert1.png?raw=true)

ELSA permite realizar búsquedas de logs igual que si fuera un navegador web, tan solo insertar un espacio de tiempo para realizar un filtrado de todos los logs e indicar un filtro ya predefinido para realizar la búsqueda.

**ELSA en redes industriales:** Los filtros configurados en ELSA no permiten hacer filtrado de protocolos industriales por defecto. Los protocolos industriales no son reconocidos, pero como se ve en el apartado que trata el IDS Snort, la implementación de las reglas Quickdraw permite reconocer y filtrar por ejemplo, el puerto 502 o por protocolo ModBus, sin que se encuentre como filtro por defecto.

### **SPLUNK**

Splunk es un sistema que permite la correlación de eventos y la incorporación de los datos de campo e informes para sguil, Bro IDS y OSSEC, e incluye varios cuadros de mando e interfaz de búsqueda para correlar eventos. Proporciona una plataforma altamente escalable para los datos generados por todos los dispositivos de los sistemas de control, sensores, sistemas SCADA, redes, aplicaciones y usuarios finales conectados a estas redes industriales. Splunk eleva la eficiencia operativa por medio de:

- La integración y agregación de datos a través de tecnología operativa.
- Busca, explora y correlaciona a través de múltiples fuentes para diagnosticar rápidamente los problemas operativos más costosos.
- Aprovecha la analítica avanzada, proporcionando la capacidad de detectar patrones, tendencias y anomalías
- Entrega rápidamente valores a través de modelos de implementación flexibles.

![SPLUNK](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/splunk.png?raw=true)

### **Security Onion**

Security Onion es una distribución de Linux para la detección de intrusiones sobre la que se basa este estudio con el fin de controlar la seguridad de la red y de gestionar los eventos. Creada por Doug Burks, esta distribución ha sido la elegida por tener como objetivo la monitorización de anomalías y detección de problemas de seguridad, dada la cantidad de las herramientas libres (Snort, Suricata, Bro, Sguil, Squert, Snorby, ELSA, Xplico, Network Miner, etc.) incluidas en la misma y sin obviar su fácil instalación y puesta en marcha

![Security Onion1](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/security-onion1.png?raw=true)

La idea de Doug Burks es crear un Gestor de Seguridad de Red NSM (Network Security Manager) por medio de la compilación de varios programas libres, creando como un conjunto de seguridad de fácil instalación. Las características de Security Onion favorecen su actuación en redes industriales, primero por el bajo coste de la solución, y después por la capacidad de introducir reglas definidas en Snort para monitorizar los protocolos industriales.

**Componentes Principales**

Security Onion se compone fundamentalmente de tres funcionalidades básicas:

- Captura de paquetes
- Sistemas de detección de intrusiones basado en host y basado en la red y (HIDS y NIDS)
- Herramientas de análisis con gran capacidad y potencia

La captura de paquetes completa se logra a través netsniff-ng, wireshark y otros programas que poseen el mismo objetivo, capturando todo el tráfico de los sensores definidos en Security Onion. La información capturada permite identificar no sólo de dónde o adónde van los paquetes, sino también dónde han sido almacenados (esto permite explotar payloads, correos electrónicos de phishing, exfiltración de archivos). Los HIDS y NIDS analizan el tráfico que pasa por el host y la red y proporcionan datos de alerta, registro de eventos y actividades detectadas. Security Onion ofrece múltiples opciones de IDS:

1. **NIDS: Security Onion dispone de Snort y Suricata.**
- **Análisis guiado por NIDS:** Para la detección de intrusiones de red impulsada por el análisis, se incluye Bro.
- **HIDS:** Security Onion ofrece OSSEC.

**Visión de conjunto**

Una Gestión de Seguridad de Red (NSM) se refiere a la monitorización de la red obteniendo los eventos relacionados con la seguridad. Puede ser que sea proactivo, cuando se utiliza para identificar las vulnerabilidades o los certificados SSL que expiran, o podría ser reactivo, tal como en la respuesta a incidentes y análisis forense de red. Ya sea porque esté realizando el seguimiento a un adversario o tratando de mantener a raya el malware, un NSM proporciona el contexto, la inteligencia y el conocimiento de la situación de la red.

Security Onion proporciona visibilidad en el tráfico de la red y el contexto en torno a las alertas y eventos anómalos, pero requiere un compromiso hacia el administrador o analista, el cual, deberá revisar las alertas y supervisar la actividad de la red. Security Onion integra para este cometido las herramientas Sguil, Squert y ELSA.

**Implantación**

Security Onion se basa en un modelo cliente-servidor distribuido. Un sensor de Security Onion es el cliente y otro un servidor. Los componentes del servidor y de los sensores se pueden ejecutar en una única máquina física o virtual, o múltiples sensores pueden ser distribuidos a través de una infraestructura y configurados para informar a un solo servidor designado. Los siguientes son los tres escenarios de implantación de Security Onion:

Independiente (Standalone): Una instalación independiente consiste en una única máquina física o virtual en la que se ejecuta tanto el servidor como los componentes de los sensores y los procesos relacionados. Una instalación independiente puede

controlar múltiples segmentos de red con diferentes interfaces de red para la monitorización. Una instalación independiente es el método más fácil y más conveniente para monitorizar una red o redes que son accesibles desde una misma ubicación.

**Servidor-Sensor:** Una instalación de servidor-sensor consta de una máquina que ejecuta el servidor y una o más máquinas separadas que ejecutan la detección y notifican de nuevo al servidor. Los sensores ejecutan todos los procesos de búsqueda y almacenan los paquetes asociados a la captura, alertas IDS y bases de datos para Sguil y ELSA.

El analista se conecta al servidor desde una máquina cliente independiente y todas las consultas enviadas al servidor se distribuyen a los sensores apropiados, la información solicitada se envía al cliente. Este modelo reduce el tráfico de red, manteniendo la mayor parte de los datos recogidos en los sensores hasta que es solicitado por el cliente. Todo el tráfico entre el servidor, los sensores y el cliente están protegidos con túneles cifrados por SSH.

**Híbrido:** Una instalación híbrida consiste en una mezcla de las dos arquitecturas presentadas, es una instalación independiente que también tiene uno o más sensores separados para informar al servidor de la máquina independiente.