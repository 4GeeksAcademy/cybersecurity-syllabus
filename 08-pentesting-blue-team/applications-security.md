---
Title: "Security Applications"  
Subtitle: "Comparison of the Best Firewalls for Large Enterprises: Akamai, AppTrana, AWS, Barracuda, Fastly, Azure, Radioware, and Wallarm"  
Tags: ["pentesting", "cybersecurity"]  
Authors: ["blindma1den", "lorenagubaira"]

---

## Best for large enterprises with high-traffic web applications

[Akamai App and API Protector](https://www.akamai.com/products/app-and-api-protector?gclid=EAIaIQobChMIutW2w7fc_gIVRJJmAh0b6gFFEAAYASABEgJ_XPD_BwE&utm_source=google&utm_medium=cpc&utm_campaign=F-MC-52611&utm_term=App%20API%20Protector&utm_content=ASEAN&ef_id=EAIaIQobChMIutW2w7fc_gIVRJJmAh0b6gFFEAAYASABEgJ_XPD_BwE:G:s&s_kwcid=AL!5241!3!620199055858!e!!g!!akamai%20app%20and%20api%20protector!15086065916!128574502466) is a cloud-based web application firewall (WAF) that protects an organization's web and mobile assets against sophisticated denial-of-service (DoS), web application, and API-based application threats. It leverages visibility across the Akamai Intelligent Edge Platform to protect websites and APIs against outages and data theft. Akamai has been ranked as a leader in Gartner's Magic Quadrant for cloud web application and API protection in 2022.

**Key Features**

- API visibility.
- AI and machine learning methods.
- Hybrid deployment options.
- Live traffic information.
- Automation.

### Advantages

- Provides adaptive defenses that immediately push the latest security updates to your applications and APIs.
- Preventive auto-tuning reduces the need for time-consuming manual maintenance.
- Technical and development resources provide rapid innovation.
- Advanced API discovery allows users to manage the risk associated with new or previously undisclosed APIs.
- DevOps integration through a simple graphical user interface or via the Terraform provider, API, or Akamai CLI.
- Built-in bot detection improves security and performance.
- Quick start with portal instructions, configuration procedures, and wizard settings.
- Custom dashboards, real-time notifications, and SIEM integration for examining security breaches and classification attacks.
- AppSec advanced management controls, managed services and professional services are optional.
- DDoS prevention that responds in seconds to application-layer attacks.

### Contras

- Configuration and maintenance can be complex and, in a large and sophisticated API environment, the management interface can be more difficult to use.
- Possibility of false positives.

### Pricing

- Akamai has not provided pricing, but [Azure Marketplace](https://azuremarketplace.microsoft.com/en-ca/marketplace/apps/akamai-technologies.akamai_wap_public?tab=PlansAndPrice) provides pricing information. Buyers should contact Akamai sales for a custom quote.

## AppTrana

**The best affordable WAF solution for SMBs**.

[AppTrana](https://www.indusface.com/web-application-firewall.php) provides real-time protection against Web application attacks by combining machine learning algorithms, security specialists, and a 24/7 security operations center. Unlike typical WAF solutions, AppTrana delivers a fully managed solution where AppTrana security professionals manage the WAF on behalf of the client, allowing the client's IT team to focus on other priorities. These services distinguish it as a distinct and attractive option for businesses looking for a simpler way to protect their online applications from cyberattacks.

### Key Features

- Ability to patch critical vulnerabilities within 24 hours.
- Unlimited DDoS mitigation and bot protection.
- API security.
- Zero false positives.
- Content delivery network.

### Advantages

- Offers 24/7 security operations.
- Provides comprehensive coverage against top 10 OWASP, zero-day, DDoS, bot, and API attacks.
- Continuously monitors websites and applications.
- Provides real-time detection and mitigation of web attacks.
- Provides an easy-to-use dashboard with comprehensive reporting and analysis.
- Offers easy configuration with no hardware or software installation.
- Provides automatic scaling to handle unexpected traffic spikes.
- Offers affordable pricing plans for businesses of all sizes.

### Cons

- Advanced users have less customization options.
- Advanced security measures may require additional charges.
- There are limited integration possibilities with other security programs.

### Pricing

- Advanced plan starts at $99/month. Alternatively, you can explore other pricing options at G2.

## AWS WAF

**Best for integration with other Amazon Web Services**.

[AWS WAF](https://aws.amazon.com/waf/) is an Amazon Web Services (AWS) web application firewall service that helps protect online applications from typical web attacks that could disrupt application availability, compromise security, or consume excessive resources. AWS can be used to define security rules that regulate bot traffic and prevent typical attack patterns such as SQL injection and cross-site scripting (XSS).

### Key Features

- Custom rule creation.
- Integration with other AWS services.
- Live metrics update.
- Easy configuration of pre-configured rules using the AWS Management Console.

### Advantages

- Allows the user to design rules that determine what traffic to accept or prohibit for web applications.
- Compatible with other AWS services such as Amazon CloudFront, Amazon API Gateway, and AWS AppSync.
- AWS WAF supports IP-based and resource-based access control lists (ACLs).
- Scales according to your application and traffic size.
- Provides a collection of pre-configured rules, allowing for easy deployment and configuration.

### Contras

- While AWS WAF provides customizable rules, it may not provide the level of customization needed for more complex web application environments.
- AWS WAF is an additional charge on top of the other AWS services used.
- It can be difficult to install and configure, especially for people who are new to AWS services.

### Pricing

- The starting price for web ACL is $5/month, plus $1/ WAF rule and request. AWS provides a custom calculation [here](https://calculator.aws/#/addService/WAF).

## Barracuda Web Application Firewall

### Best for ease of use and simple configuration

[Barracuda Web Application Firewall](https://www.barracuda.com/products/application-protection/web-application-firewall) is a hardware or virtual appliance that protects against numerous web application attacks and ensures secure application delivery. This is ideal for enterprises that demand a comprehensive, easy-to-use WAF solution with advanced security capabilities, such as bot protection and DDoS prevention.

### Key Features

- Protection against online threats and DDoS.
- Ability to stop malicious bots in their tracks.
- API and mobile application protection.
- Granular access restriction and secure application distribution.
- Automated security.
- Detailed information on attacks and traffic patterns.

### Advantages

- Easy to deploy and manage, making it an excellent choice for companies with limited IT resources.
- Provides SSL offloading and inspection, which helps detect and prevent attacks hidden within encrypted traffic.
- Uses machine learning to improve threat detection and response, allowing you to identify and respond to attacks in real-time.
- Provides comprehensive API security, which is becoming increasingly crucial as more applications communicate via APIs.
- Protects against the top ten OWASP threats, including SQL injection, cross-site scripting, and others.
- Provides centralized management and reporting for multiple applications.
- Multiple deployment options are available, including on-premises, virtual, and cloud.

### Contras

- Cost can be more expensive than other solutions.
- Customer support is not available 24/7.
- Some features may require the purchase of additional licenses.

### Prices

- WAF-as-a-Service for a 50 Mbps plan starts at $1.02 per unit.

**Cloudflare**

**The best cloud-based WAF solution with CDN integration and live analytics**.

[Cloudflare WAF](https://www.cloudflare.com/waf/) is a cloud-based web application firewall intended to protect websites and APIs from many forms of attacks. It offers a variety of security measures to help prevent attacks, as well as performance and reliability benefits. Cloudflare WAF offers a unique combination of global networking, machine learning, bot mitigation, an easy-to-use user interface, and DNS security.

**Key Features**

- Provides comprehensive application security, with a single, integrated rules engine for effective and consistent security.
- Security analytics deliver real-time attack intelligence.
- Rapid deployment of zero-day protections to enable instant virtual patching. These controlled rules are deployed globally in seconds.
- Machine learning safeguards detect evasions and attacks.
- Managed rule sets for automated protection against recognized threats, such as OWASP Top 10
- Custom rule creation.

### Advantages

- Faster and easier implementation of security installations, resulting in faster mitigations and time to value.
- Allows you to create your security policies and prohibit particular types of traffic using custom rules.
- Firewall rules are in place to prevent malicious traffic such as SQL injection, cross-site scripting (XSS), and other web application attacks.
- No hardware to purchase or maintain with cloud-based deployment.
- A web-based control panel simplifies configuration and maintenance.
- A free tier with basic security measures is included.
- Provides performance and reliability benefits such as CDN services and load balancing.

### Cons

- Higher level membership is required for advanced features such as API protection.
- Compared to other WAF tools, it has fewer customization options.
- Compared to other WAF tools, it may not provide as much granular control over security policies.
- Some users have complained about false positives and difficulties in configuring rule sets.

### Pricing

- Cloudflare's professional plan starts at $20 per month. Explore other pricing options on Cloudflare plans.

**F5 Advanced WAF**

**The best choice for advanced security capabilities.**

[F5 Advanced WAF](https://www.f5.com/pt_br/products/security/advanced-waf) (formerly known as F5 BIG-IP Application Security Manager) is a WAF product that protects online applications by combining traffic filtering, proactive bot protection, application-layer encryption, and behavioral analysis.

F5 Advanced WAF is based on proven F5 technology and goes beyond reactive security features, such as static signatures and reputation, to identify and neutralize bots, safeguard passwords and sensitive data, and fight application denial of service (DoS). F5 Advanced WAF is a good choice for organizations with sophisticated web-based applications that require advanced security capabilities such as automated threat detection and API protection.

### Key Features

- Advanced machine learning capabilities.
- SSL/TLS verification.
- Traffic management and load balancing.
- Application-layer encryption.
- Behavioral analysis.

### Advantages

- Provides continuous security monitoring and threat analysis to discover and protect against the latest security threats.
- Provides customized rules and fine-grained control to protect applications and infrastructure against known and evolving threats.
- Includes simple dashboards and reports to monitor application security status and provide information on security incidents.
- Can be easily integrated with other F5 products, such as BIG-IP and Silverline, DDoS prevention, and security monitoring.
- Provides a variety of deployment options, including on-premises, cloud, and hybrid configurations.

### Cons

- F5 Advanced WAF is a complicated solution that requires the use of experts and resources to configure and maintain.
- Licensing costs can be prohibitively expensive, especially for large enterprises.
- Improper implementation creates performance issues.
- Lacks native interaction with cloud systems such as AWS and Azure, requiring additional configuration and maintenance.

### Pricing

- F5 has not provided pricing information for this service, but you can contact F5 Sales for custom quotes. [Azure Marketplace](https://azuremarketplace.microsoft.com/en-ca/marketplace/apps/f5-networks.f5-big-ip-advanced-waf?tab=PlansAndPrice) also provides pricing information.

## Fastly

**The best choice for a flexible, cloud-based WAF solution and customer support**.

[Fastly Next-gen WAF](https://www.fastly.com/products/web-application-api-protection) is a cloud-based WAF that provides enhanced security capabilities to protect against web-based threats. It employs an innovative technique created by Signal Sciences that identifies and blocks malicious traffic without the need for rule refinement, allowing AppSec teams to focus on more pressing issues. Fastly received the Gartner Peer Insights Customers' Choice award for five consecutive years.

Fastly is the best cloud-based WAF option for enterprises looking for flexible deployment options, customer service availability, and real-time attack response capabilities.

### Key Features

- Real-time web application security.
- Integrated web application firewall.
- Robot security.
- Advanced DDoS protection.
- Customizable rules and policies.
- Customizable response pages.
- Centralized management and reporting.
- API security.

### Advantages

- Fastly's next-generation WAF uses machine learning and behavioral analytics to detect and mitigate sophisticated threats.
- Excellent customer support.
- Fastly's system is capable of handling large amounts of traffic and can easily scale to accommodate future demand.
- The solution features comprehensive APIs for system integration.
- Fastly's WAF minimizes false positives and helps companies reduce the need for manual intervention.
- Provides an easy-to-use user interface and extensive rule customization.

### Cons

- Reporting and event querying needs to be improved in the interface.
- Fastly's WAF may not be as configurable as other alternatives on the market.
- Since Fastly's solution is primarily cloud-based, it may not be the best choice for organizations that need an on-premises solution.
- Some customers report that the system can be difficult to install and configure, especially for companies with sophisticated infrastructure or security requirements.

### Pricing

- The TLS/SSL secure connection plan starts at $20.00 per month, while the bandwidth and requests plan starts at $50.00 per month. You can explore other pricing options at [Fastly](https://www.fastly.com/pricing?utm_source=saasworthy.com&utm_medium=cpc).

## Fortinet FortiWeb

**The best for comprehensive threat protection**.

[Fortinet FortiWeb](https://www.fortinet.com/products/web-application-firewall/fortiweb) protects online applications and APIs from top 10 OWASP threats, distributed denial-of-service attacks and malicious bot attacks. Advanced ML-based features increase security while reducing administrative costs. Provides anomaly detection, API discovery and protection, bot mitigation, and advanced threat analysis to identify the most serious threats across all protected applications.

### Key Features

- Web application protection.
- ML-based threat detection.
- Security fabric integration.
- Advanced scanning.
- False positive mitigation.
- Hardware-based acceleration.

### Advantages

- Incorporates automatic updates to ensure it is continuously updated with the latest threat information and security features.
- Extremely scalable and can be deployed in a wide range of contexts, including on-premises, cloud-based, and hybrid.
- Integrates with other Fortinet products such as FortiGate, FortiSandbox, and FortiSIEM.
- Provides comprehensive application-layer security, including capabilities such as URL and form hardening, session tracking, and content inspection.
- Employs powerful threat detection algorithms to detect and stop threats such as SQL injection attacks, cross-site scripting (XSS), and others. It also provides real-time threat intelligence to aid in the detection of evolving threats.

### Cons

- Some users have reported issues with the management console being somewhat complex and difficult to use.
- To maximize speed and reduce false positives, some tweaking and tuning may be necessary.

### Pricing

- A standard 1-year package starts at $2321. You can explore other packages and pricing options at [Azure Marketplace](https://azuremarketplace.microsoft.com/en-ca/marketplace/apps/fortinet.fortinet_fortiweb-vm_v5?tab=PlansAndPrice).

## Imperva WAF

**The best enterprise-grade WAF solution for advanced protection and 24/7 customer support**.

[Imperva](https://www.imperva.com/products/web-application-firewall-waf/) is a market leader in DoS/DDoS protection and is one of several vendors on this list to be named a Gartner Peer Insights Customer's Choice in 2023. Imperva is a cloud-based security solution that defends online applications against attacks such as SQL injection. Imperva WAF, cross-site scripting (XSS), and remote file inclusion (RFI).

Imperva WAF provides comprehensive capabilities that enable multi-layered threat prevention, ensuring the security and availability of online applications.

### Key Features

- False-positive WAF protection.
- Automated policy creation.
- Provides security for both live and legacy applications, third-party applications, APIs and microservices, cloud applications, containers, virtual machines, and more.
- Real-time threat detection.
- Behavioral detection to detect and prevent zero-day attacks.

### Advantages

- Seamless deployment and requires no local hardware.
- Provides 24/7 customer support.
- Lower cost compared to other WAF tools
- Rules and policies can be customized for granular control over security settings.
- The solution protects against attacks and vulnerabilities in real-time, reducing the risk of data breaches and downtime that other WAF solutions may miss.
- Capable of detecting zero-day attacks thanks to the behavior-based detection feature.
- The technology is extremely flexible, allowing companies to create rules and policies that are tailored to their specific security requirements.
- Imperva WAF works with leading SIEM solutions to provide enhanced threat intelligence and improve incident response capabilities.

### Cons

- Users report frequent changes to the user interface, requiring a new learning curve for changes.
- Reporting, UI complexity, and advanced BOT protection rules are not intuitive, according to some users.
- Although Imperva offers lower plan costs, some plans can still be more expensive, especially for large enterprises.
- To take full advantage of all the solution's features and capabilities, some training may be required.
- Due to the degree of customization offered, the implementation process may take longer than with comparable WAF solutions.

### Pricing

- Pro plan starts at $59 per site per month.

### Microsoft Azure Application Gateway

**Best for scalability and integration with Azure services**.

[Microsoft Azure Application Gateway WAF](https://learn.microsoft.com/en-us/azure/web-application-firewall/ag/ag-overview) is a web application firewall service that is integrated with Azure Application Gateway. It provides centralized security for online applications against common vulnerabilities and exploits. Common attacks protected by Azure include SQL injection, cross-site scripting, and cross-site request forgery.

### Key Features

- SQL injection protection.
- Cross-site scripting protection.
- Protection against other common web attacks, such as command injection, HTTP request smuggling, HTTP response splitting, and remote file inclusion.
- Protection against HTTP protocol violations and anomalies, such as missing host user agents and accepting headers.
- Protection against crawlers and scanners.
- Detection of common application misconfigurations (e.g., Apache and IIS).
- Configurable request size limits with upper and lower limits.
- Exclusion lists to omit certain request attributes from a WAF evaluation.
- Create custom rules to meet the specific needs of your applications.
- Geographically filter traffic to allow or block access from certain countries/regions to your applications.
- Bot protection with the Bot Mitigation Rule Set
- JSON and XML inspection in the request body.

### Advantages

- Offers Azure service integration.
- Easy to configure and manage.
- Supports load balancing at layers 4 and 7.
- Improves performance and availability with automatic scaling.
- Monitors and alerts on threat detection and real-time information.

### Cons

- Limited customization possibilities compared to other WAF systems.
- Higher cost compared to other WAF tools.
- Limited ability to integrate with non-Azure environments.

### Pricing

- Azure offers pay-as-you-go pricing. Explore pricing options [here](https://azure.microsoft.com/en-us/pricing/details/web-application-firewall/).

## Radioware

**Best for advanced machine learning-based threat detection and mitigation capabilities.**

[Radware Cloud WAF service](https://www.radware.com/products/cloud-waf-service/) protects online applications with enterprise-grade, continuously adaptive security. It is based on Radware's ICSA Labs-certified web application firewall and provides comprehensive coverage of the top 10 OWASP threats while dynamically adapting defenses to emerging threats and protected assets.

### Key Features

- Comprehensive coverage of the top 10 OWASP attacks.
- Protects against zero-day web attacks.
- Automatically generates policies for new applications.
- Single “pane of glass” with a unified portal fully managed by Radware's emergency response team.
- Real-time monitoring and reporting of insights.
- DDoS protection.
- Multi-layered security approach.

### Advantages

- Provides comprehensive web security protection, including OWASP Top 10 coverage, advanced attack prevention, and zero-day attack protection.
- Through automatic policy generation technology, detects and protects new web.applications as they are added to the [network.](https://www.esecurityplanet.com/networks/network-security/).
- Multi-layered security strategy ensures comprehensive protection.
- Automated security policy formulation and maintenance.
- Integration of different security technologies improves the overall security posture.
- DDoS defense adds an extra degree of security.
- Optional deployment flexibility.

### Cons

- User interface and policy configuration procedure is complex.
- Insufficient documentation and troubleshooting resources.

### Pricing

- Pricing depends on your customized plan. You can explore Radware's different pricing options [here](https://www.radware.com/cyberpedia/application-security/web-application-firewall-waf-pricing/#WAFPricingModelsComparison).

## Wallarm WAF

**The best AI-based WAF solution for real-time threat detection in containers and microservices**

[Wallarm WAF](https://www.wallarm.com/product/cloud-waf) is an AI-powered web application firewall that protects APIs and applications in real-time with Cloud Web Application and API Protection (WAAP) with comprehensive API support for REST, SOAP, WebSocket, graphQL and gRPC. With a single DNS update, Wallarm Cloud WAF protects your applications, APIs, and serverless workloads.

### Key Features

- AI-driven threat identification and mitigation.
- Real-time API security.
- Comprehensive reporting and analysis.
- Integration with popular CI/CD tools.
- Automated vulnerability detection and patching.
- Customizable WAF policies and regulations.

### Advantages

- Artificial intelligence-based security.
- Highly adaptive.
- Minimizes the risk of false positives.
- Offers an interface that is quick and easy to use.
- Generates real-time monitoring and reporting
- Provides advanced API protection
- Allows easy integration with DevOps procedures.

### Cons

- No support for local deployment.
- Some users report problems with the accuracy of threat detection.
- Configuration and maintenance may require some complex technical knowledge.
- Limited support for some programming languages.

### Pricing

- Wallarm has not provided pricing information for this service, but you can contact Wallarm Sales for their subscription plans. [Azure Marketplace](https://azuremarketplace.microsoft.com/en-ca/marketplace/apps/wallarm.wallarm-ng-waf-offer-1?tab=PlansAndPrice) also provides pricing and plan information for Wallarm.

## How to choose a WAF provider

In addition to features and deployment options, WAF buyers should look for a solution that offers the security and management capabilities they need. Some important ones to consider:

- Effectively and comprehensively discovers and corrects application vulnerabilities promptly.
- Constantly detect new threats and DDoS attacks.
- Fits the organization's budget and is affordable. Compared to on-premises WAFs, cloud-based WAFs typically have lower monthly subscription fees and faster updates.
- Enables simple rule adaptation to overcome flaws in business logic.
- Allows the security team to choose the appropriate course of action for requests (blocking, signaling, challenge).
- Provides a robust defense against a wide range of cyber threats, including SQL injection, cross-site scripting, and other forms of attacks.
- Is simple to deploy, configure, and manage, especially in organizations that do not have specialized security professionals.
- It can handle high levels of web traffic while protecting against large-scale DDoS attacks.
- Allows customization of rules to meet industry requirements and protect against unique threats.
- Integrates with other security solutions, such as content delivery networks (CDNs) or load balancers, effortlessly.
- Provides extensive documentation and support to help companies get the most out of their WAF solutions.

### Conclusion: Web Application Firewalls

In selecting WAF products for this list, we looked for those that offered an optimal combination of protection, scalability, ease of use, customization, integration, and support, along with factors such as price, reputation, and customer feedback. We analyzed WAF vendors using multiple data points and product features, including sources such as vendor documentation, analyst reports, security data, and user reviews.

Each organization will need to balance its needs for aspects such as ease of use and high security with available resources and expertise.

Web application firewall (WAF) solutions are a critical tool for protecting web applications from a variety of cyber threats, including SQL injection, cross-site scripting, DDoS attacks, and more. Each WAF tool has its own set of capabilities, strengths and weaknesses.

Cloud-based WAFs are typically less expensive and provide faster updates than on-premises WAFs. WAF solutions that include artificial intelligence and machine learning can offer more advanced and proactive protection against emerging threats.

Buyers should analyze multiple WAF vendors and products to find the best option for their needs. Ultimately, the best WAF solution is determined by the specific needs and requirements of the business.

## The best open-source web application firewall

Thousands of websites are hacked every day due to misconfiguration or vulnerable code. Web Application Firewall (WAF) is one of the best ways to protect your website from online threats. If your website is available on the Internet, you can use online tools to scan a website for vulnerabilities and get an idea of how secure your website is. Don't worry if it is an intranet website; you can use the open-source Nikto web server scanner.

Commercial WAF can be expensive and if you are looking for a free solution to protect your website using WAF, you may find the following open-source web application firewall useful.

### ModSecurity

TrustWave's [ModSecurity](https://github.com/SpiderLabs/ModSecurity) is one of the most popular web application firewalls and supports Apache HTTP, Microsoft IIS, and Nginx.

The free ModSecurity rules will be useful if you are looking for the following protection.

- cross-site scripting.
- Trojan.
- data leakage.
- SQL injection
- Common web attacks.
- Malicious activity.

ModSecurity does not have a graphical interface and, if you are looking for one, you may consider using [WAF-FLE](https://github.com/klaubert/waf-fle). It allows you to store, search, and view the event in a console.

![WAF-FLE](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/waf-fle.png?raw=true)

**NAXSI**

[NAXSI](https://github.com/nbs-system/naxsi) is Nginx Anti-XSS and SQL injection. So, as you can guess, this is only for the Nginx web server and its main purpose is to protect against SQL injection and cross-site scripting attacks. NAXSI filters only GET and PUT requests, and the default configuration will act as a DROP firewall by default, so you must add the ACCEPT rule for it to work properly.

![NAXSI](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/naxsi.png?raw=true)

**[WebKnight](https://www.iis.net/downloads/community/2016/04/aqtronix-webknight)**

[WebKnight](https://www.iis.net/downloads/community/2016/04/aqtronix-webknight) WAF is for Microsoft IIS. It is an ISAPI filter that protects your web server by blocking incorrect requests. WebKnight is useful for protecting the following.

- Buffer overflows.
- Directory traversal.
- Character encoding.
- SQL injection.
- Block bad bots.
- Direct linking.
- Brute force.
- And much more...

![webKnight](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/webknight.png?raw=true)

In a default configuration, all blocked requests are logged and you can customize them according to your needs. WebKnight 3.0 has an administration web interface where you can customize rules and perform administration tasks, including statistics.

**[Shadow Daemon](https://github.com/zecure/shadowd)**

[Shadow Daemon](https://github.com/zecure/shadowd) detects, logs, and prevents web attacks by filtering malicious parameter requests. It comes with an interface where you can perform administration and manage this WAF. It is compatible with the PHP language framework, Perl and Python.

It can detect the following attacks.

- SQL injection.
- XML injection.
- code injection.
- command injection.
- XSS.
- Backdoor access.
- Inclusion of local/remote files.

![shadow-daemon](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/shadow-daemon.png?raw=true)

### What is modSecurity?

**modSecurity** is an embeddable GNU-licensed Web application firewall that runs as a module of the Apache web server, provides protection against various attacks on Web applications, and allows HTTP traffic monitoring and real-time analysis without requiring changes to the existing infrastructure. **modSecurity** filters attacks by XSS, SQL Injection, anomalous behavior in protocols, robots, Trojans, LFI... It also incorporates specific rules for some of the most popular content management systems such as Joomla or Wordpress.

It supports integration with ModProxy so we can protect applications deployed on other servers thanks to this integration. In addition **modSecurity** has an administration console that allows you to collect monitoring logs and real-time alerts as well as automated maintenance options, among other features.

![modsecurity](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/modsecurity.png?raw=true)

### Installation of modSecurity

Next we are going to describe the installation process of modSecurity 2.7 in Debian, in Ubuntu it is available in the repositories. The necessary downloads can be done from the official website of the project [http://www.modsecurity.org/](http://www.modsecurity.org/)

**1. Download the sources and unzip them:**

> wget [https://www.modsecurity.org/tarball/2.7.5/modsecurity-apache_2.7.5.tar.gz](https://www.modsecurity.org/tarball/2.7.5/modsecurity-apache_2.7.5.tar.gz)

```bash
tar -zxvf modsecurity-apache_2.7.5.tar.gz
```

**2. We install some necessary dependencies:**

```bash
apt-getinstall apache2-threaded-dev libxml2-dev libcurl4-gnutls-dev -y
```

**3. Compile and install:**

```bash
cd modsecurity-apache_2.7.5

./configure

make

make install
```

**4. We load the module:** We create the following file

```bash
vim /etc/apache2/mods-available/mod-security2.load
```

- With the following content:

```bash
LoadFile /usr/lib/libxml2.so
LoadFile /usr/lib/liblua5.1.so.0
LoadModule security2_module /usr/lib/apache2/modules/mod_security2.so
```

**5. Activate modSecurity:** Before activating modSecurity we must activate `unique_id`

```bash
a2enmod unique_id
```

- Then, enable modSecurity now:

```bash
a2enmod mod-security2
```

**6. Configure the rules:** Once we have installed modSecurity it is necessary to establish the rules that will set the conditions for filtering methods. We download the filtering rules in /etc/apache2:

```bash
cd /etc/apache2

apt-get install git

git clone[https://github.com/SpiderLabs/owasp-modsecurity-crs](https://github.com/SpiderLabs/owasp-modsecurity-crs)
```

Once downloaded we will see several directories as well as several utilities. For a first approach we will rename `modsecurity_crs_10_config.conf.example` to `modsecurity_crs_10_config.conf`:

```bash
cp modsecurity_crs_10_config.conf.example modsecurity_crs_10_config.conf
```

Finally edit `apache2.conf` with the following content:

```bash
vim /etc/apache2/apache2.conf
```

```bash
SecRuleEngine On
SecRequestBodyAccess On
SecResponseBodyAccess Off
SecDebugLog /var/log/apache2/modsec_debug.log
SecDebugLogLevel 1
SecAuditEngine RelevantOnly
SecAuditLogRelevantStatus ^5
SecAuditLogParts ABIFHZ
SecAuditLogType Serial
SecAuditLog /var/log/apache2/modsec_audit.log
SecRequestBodyLimit 131072
SecRequestBodyInMemoryLimit 131072
SecResponseBodyLimit 524288
SecDataDir /tmp/
SecUploadDir /tmp/
SecTmpDir /tmp/
Include owasp-modsecurity-crs/modsecurity_crs_10_config.conf
Include owasp-modsecurity-crs/base_rules/*.conf
Include owasp-modsecurity-crs/optional_rules/*.conf
Include owasp-modsecurity-crs/slr_rules/*.conf
```

⚠️ **Warning:**

Be careful with the `SecDataDir`, `SecUploadDir`, and `SecTmpDir` settings, as applications that upload files and use temporary files may not function correctly.

Similarly, pay attention to the possible configurations of the `SecRequestBodyLimit`, `SecRequestBodyInMemoryLimit`, and `SecResponseBodyLimit` attributes, which are typically defined in the `apache2.conf` file.

These configurations will determine the file upload characteristics through our web applications. If all goes well, we will soon start to see in our Apache log file, dozens if not hundreds of logs of this type:

```bash
[client 192.168.1.154] ModSecurity: Access denied with code 403 (phase 2).
Pattern match "^[\\d.:]+$" at REQUEST_HEADERS:Host.
[file "owasp-modsecurity-crs/base_rules/modsecurity_crs_21_protocol_anomalies.conf"]
[line "98"] [id "960017"]
```

If we want to extend the filtering potential of our module we can go to [http://www.gotroot.com/mod_security+rules](https://wiki.atomicorp.com/wiki/index.php/Atomic_ModSecurity_Rules) and freely download their rule collections. I hope that this first introduction to modSecurity will help you to strengthen the security of your Apache web servers, an essential task in these times.