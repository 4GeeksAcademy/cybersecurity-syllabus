---
title: "¿Qué es un Honeypot y Cómo Configurar Uno"
subtitle: "Entendiendo el concepto, los tipos y la implementación de honeypots en ciberseguridad"
tags: ["honeypot", "ciberseguridad", "pentesting"]
authors: ["alesanchezr"]
---

Un honeypot es una trampa diseñada para atrapar a los hackers.

En 2008, una importante institución financiera de EE. UU. utilizó exitosamente un honeypot para detectar y prevenir una amenaza interna significativa. El caso fue documentado por el [SANS Institute](https://www.sans.org/):

1. **La Configuración**: La compañía configuró un honeypot interno disfrazado como un servidor que contenía datos financieros sensibles.

2. **La Amenaza**: Un empleado con acceso privilegiado intentó acceder y extraer datos de este servidor honeypot.

3. **Detección**: El honeypot alertó de inmediato al equipo de seguridad cuando se intentó acceder de manera no autorizada.

4. **Respuesta**: 
   - El equipo de seguridad identificó rápidamente al empleado responsable.
   - Monitorizaron las actividades del empleado en tiempo real.
   - Se recopilaron pruebas para una posible acción legal.

5. **Resultado**: 
   - La amenaza interna fue neutralizada antes de que ocurriera algún daño real.
   - La compañía evitó posibles pérdidas financieras y daños reputacionales.
   - El caso proporcionó valiosos aprendizajes para mejorar la detección de amenazas internas.

## ¿Qué es un honeypot?

Un honeypot es un mecanismo de ciberseguridad diseñado para atraer y atrapar a posibles atacantes, sirviendo como herramienta tanto de defensa como de recolección de información. Es esencialmente un sistema o red señuelo configurado para atraer a los ciberdelincuentes y estudiar sus tácticas.

Por ejemplo: Puedes configurar un honeypot que emule una máquina vulnerable con Windows para atraer y atrapar atacantes.

## Propósito de un honeypot:

- Detectar intentos de acceso no autorizado
- Estudiar el comportamiento y las técnicas de los atacantes
- Desviar a los atacantes de los objetivos reales
- Recoger inteligencia sobre nuevas amenazas y vulnerabilidades

## Tipos de Honeypots

- **Baja interacción**: Simula solo servicios y protocolos básicos, por ejemplo, un honeypot que solo tiene habilitado SSH.
  
- **Interacción media**: Emula sistemas más complejos, pero con funcionalidad limitada, por ejemplo, un honeypot que tiene habilitado RDP, pero sin otros servicios.
  
- **Alta interacción**: Sistemas o redes completamente funcionales, por ejemplo, un honeypot que tiene un sistema operativo Linux totalmente funcional con servicios y aplicaciones.

## Estrategias de Despliegue

- **Honeypots de producción**: Colocados dentro de la red real para mejorar la seguridad.
- **Honeypots de investigación**: Usados principalmente para estudiar el comportamiento de los atacantes.

## Beneficios de usar Honeypots

- Sistema de alerta temprana para ataques
- Reduce falsos positivos en la detección de intrusiones
- Proporciona inteligencia valiosa sobre amenazas
- Puede ralentizar o prevenir ataques automatizados

### Desafíos de usar Honeypots

- Requiere una gestión cuidadosa para evitar que se convierta en una responsabilidad. Dejar expuestos los honeypots puede ser peligroso, ya que los atacantes podrían detectarlo y atacarlo intencionadamente.
- Los honeypots pueden ser intensivos en recursos, especialmente los de alta interacción.
- Consideraciones legales y éticas (por ejemplo, preocupaciones sobre el posible uso indebido o el consentimiento de las partes implicadas).

## Configuración de un Honeypot Básico

Aquí tienes un ejemplo sencillo de cómo configurar un honeypot básico usando Python:

```python
# necesitamos un socket para escuchar las conexiones entrantes
import socket

def start_honeypot():
    # El puerto 135 es común porque se usa para la Instrumentación de Administración de Windows (WMI) y los hackers lo suelen atacar.
    server_address = ('0.0.0.0', 135)  
    server = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    server.bind(server_address)
    server.listen(1)
    print("El honeypot está funcionando en el puerto 135")

    while True:
        # Esto aceptará una conexión de un atacante
        client_socket, client_address = server.accept()
        # podemos registrar la conexión en un archivo
        with open("honeypot.log", "a") as log_file:
            log_file.write(f"Conexión desde {client_address}\n")
        client_socket.close()

if __name__ == "__main__":
    start_honeypot()
```

Este script configura un servidor TCP simple en el puerto 135, que es un puerto común para el servicio WMI de Windows. Cuando se realiza una conexión a este puerto, el servidor registra la conexión y la cierra, simulando un honeypot que atrae a los atacantes sin causar ningún daño.

Para recopilar datos del honeypot, puedes usar herramientas como [honeytrap](https://github.com/honeytrap/honeytrap), [honeymon](https://github.com/paralax/honeymon), o wazuh.

Otra opción es usar [honeypot.io](https://honeypot.io/), que es un servicio de honeypot basado en la nube que proporciona visibilidad en tiempo real sobre la seguridad de tu red.

### Integrar nuestro honeypot con Wazuh

Para integrar nuestro honeypot básico con Wazuh, necesitamos modificar nuestro script de Python para enviar logs a Wazuh. Utilizaremos la API de Wazuh para enviar eventos personalizados. Así es como podemos modificar nuestro script de honeypot:

```python
import requests

def send_to_wazuh(message):
    url = "http://localhost:55000/wazuh-api/v1/alert"
    headers = {"Content-Type": "application/json", "Authorization": "Bearer TU_API_KEY"}
    data = {"rule_id": "10000", "description": message}
    response = requests.post(url, headers=headers, json=data)
    
    if response.status_code == 200:
        print("Evento enviado a Wazuh")
    else:
        print("Error al enviar el evento a Wazuh")
```

## Caso Famoso de Honeypot: The Honeynet Project

Uno de los proyectos de honeypots más conocidos e influyentes es [The Honeynet Project](https://www.honeynet.org/), fundado en 1999 por Lance Spitzner. Esta organización de investigación global y sin fines de lucro ha contribuido significativamente al campo de la tecnología de honeypots y la inteligencia de amenazas.

Aspectos clave del Honeynet Project:

1. **Alcance global**: Involucra a profesionales de seguridad de todo el mundo.
2. **Enfoque en la investigación**: Busca aprender las herramientas, tácticas y motivaciones de los ciberdelincuentes.
3. **Código abierto**: Proporciona herramientas gratuitas y comparte hallazgos con la comunidad.
4. **Impacto en el mundo real**: Ha descubierto numerosas nuevas técnicas de ataque y variedades de malware.

Un caso notable de [The Honeynet Project](https://www.honeynet.org/) fue el descubrimiento del ataque "Cuckoo's Egg" a principios de los años 2000. Este ataque involucraba un rootkit sofisticado que anteriormente era desconocido. El honeypot permitió a los investigadores estudiar el rootkit en detalle, lo que llevó a mejorar los métodos de detección y prevención para amenazas similares.

The Honeynet Project demuestra el poder de los honeypots no solo para organizaciones individuales, sino para avanzar en todo el campo de la ciberseguridad a través de la investigación colaborativa y el intercambio de información.

## Honeypots y el Marco MITRE ATT&CK

Los honeypots están estrechamente relacionados con el marco MITRE ATT&CK (Tácticas, Técnicas y Conocimientos Comunes del Adversario). MITRE ATT&CK es una base de conocimientos accesible globalmente de tácticas y técnicas de adversarios basadas en observaciones del mundo real. La relación entre honeypots y MITRE ATT&CK se manifiesta de varias maneras:

1. **Detección de técnicas**: Los honeypots pueden ser diseñados para detectar y registrar técnicas específicas descritas en el marco MITRE ATT&CK. Por ejemplo:

   - Técnica T1078 (Cuentas Válidas): Un honeypot puede detectar intentos de usar cuentas válidas para acceso no autorizado.
   - Técnica T1190 (Explotación de Aplicaciones Externas): Un honeypot que simula una aplicación pública puede detectar intentos de explotación.

2. **Mapeo de tácticas**: La información recopilada por los honeypots puede mapearse a las tácticas de MITRE ATT&CK, ayudando a comprender las estrategias de los atacantes.

3. **Inteligencia de amenazas**: Los datos de los honeypots pueden enriquecer la inteligencia de amenazas, contribuyendo potencialmente a la base de conocimientos de MITRE ATT&CK.

4. **Mejora de defensas**: Al correlacionar los datos de honeypots con el marco MITRE ATT&CK, las organizaciones pueden mejorar sus defensas contra técnicas específicas.

5. **Pruebas y validación**: Los honeypots pueden ser utilizados para probar y validar la efectividad de las defensas contra técnicas descr

itas en MITRE ATT&CK.

Ejemplo de uso:

- Un honeypot detecta la técnica de ataque T1078 (Cuentas Válidas) y registra el evento.
- El evento es analizado y mapeado a la táctica "Descubrimiento" de MITRE ATT&CK.
- Esta información puede ser utilizada para mejorar las defensas contra ataques similares.

En general, la relación entre honeypots y MITRE ATT&CK es simbiótica. Los honeypots proporcionan datos del mundo real que ayudan a validar y mejorar la efectividad de las defensas contra amenazas conocidas y desconocidas. MITRE ATT&CK, a su vez, ofrece una manera estructurada de entender y responder a estas amenazas.