A honeypot is a trap set to catch hackers.

In 2008, a major U.S. financial institution successfully used a honeypot to detect and prevent a significant insider threat, the case was documented by the [SANS Institute](https://www.sans.org/):

1. **The Setup**: The company set up an internal honeypot disguised as a server containing sensitive financial data.

2. **The Threat**: An employee with privileged access attempted to access and exfiltrate data from this honeypot server.

3. **Detection**: The honeypot immediately alerted the security team when unauthorized access was attempted.

4. **Response**: 
   - The security team quickly identified the employee responsible.
   - They monitored the employee's activities in real-time.
   - Evidence was gathered for potential legal action.

5. **Outcome**: 
   - The insider threat was neutralized before any real damage could occur.
   - The company avoided potential financial losses and reputational damage.
   - The case provided valuable insights for improving insider threat detection.

## What is a honeypot?

A honeypot is a cybersecurity mechanism designed to attract and trap potential attackers, serving as both a defensive and information-gathering tool. It's essentially a decoy system or network set up to lure cybercriminals and study their tactics.

For example: You can setup a honeypot that emulates a vulnerable Windows machine to attract and trap attackers.

## Purpose of a honeypot:

- Detect unauthorized access attempts
- Study attacker behavior and techniques
- Divert attackers from real targets
- Gather intelligence on new threats and vulnerabilities

## Types of Honeypots

- **Low-interaction**: Simulates only basic services and protocols, for example a honeypot that only has SSH enabled.
  
- **Medium-interaction**: Emulates more complex systems but with limited functionality, for example a honeypot that has RDP enabled but no other services.
  
- **High-interaction**: Fully functional systems or networks, for example a honeypot that has a fully functional Linux operating system with services and applications.

## Deployment Strategies

- **Production Honeypots**: Placed within the actual network to enhance security
- **Research Honeypots**: Used primarily for studying attacker behavior

## Benefits of using Honeypots

- Early warning system for attacks
- Reduces false positives in intrusion detection
- Provides valuable threat intelligence
- Can slow down or prevent automated attacks

### Challenges of using Honeypots

- Requires careful management to avoid becoming a liability. Leaving honeypots exposed can be dangerous because attackers will know that the honeypot is there and they will target it.
- Honeypots can be resource-intensive, especially for high-interaction honeypots.
- Legal and ethical considerations (e.g., entrapment concerns)

## Setting Up a Basic Honeypot

Here's a simple example of how to set up a basic honeypot using Python:

```python
# we need a socket because we need to listen for incoming connections
import socket

def start_honeypot():
    # 135 is a common port because it's used for Windows Management Instrumentation (WMI) and hackers will target it.
    server_address = ('0.0.0.0', 135)  
    server = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    server.bind(server_address)
    server.listen(1)
    print("Honeypot is running on port 135")

    while True:
        # This will accept a connection from an attacker
        client_socket, client_address = server.accept()
        # we can log the connection to a file
        with open("honeypot.log", "a") as log_file:
            log_file.write(f"Connection from {client_address}\n")
        client_socket.close()

if __name__ == "__main__":
    start_honeypot()
```

This script sets up a simple TCP server on port 135, which is a common port for the Windows Management Instrumentation (WMI) service. When a connection is made to this port, the server logs the connection and closes it, simulating a honeypot that attracts attackers without causing any harm. 

In order to collect data from the honeypot you can use a tool like [honeytrap](https://github.com/honeytrap/honeytrap) or [honeymon](https://github.com/paralax/honeymon) or wazuh.

Another option is to use [honeypot.io](https://honeypot.io/) which is a cloud-based honeypot service that provides real-time visibility into your network's security posture.

### Integrating our honeypot with Wazuh

To integrate our basic honeypot with Wazuh, we need to modify our Python script to send logs to Wazuh. We'll use the Wazuh API to send custom events. Here's how we can modify our honeypot script: 

```python
import requests

def send_to_wazuh(message):
    url = "http://localhost:55000/wazuh-api/v1/alert"
    headers = {"Content-Type": "application/json", "Authorization": "Bearer YOUR_API_KEY"}
    data = {"rule_id": "10000", "description": message}
    response = requests.post(url, headers=headers, json=data)
    
    if response.status_code == 200:
        print("Event sent to Wazuh")
    else:
        print("Failed to send event to Wazuh")
```


## Famous Honeypot Case: The Honeynet Project

One of the most well-known and influential honeypot initiatives is [the Honeynet Project](https://www.honeynet.org/), founded in 1999 by Lance Spitzner. This global, non-profit research organization has significantly contributed to the field of honeypot technology and threat intelligence.

Key aspects of the Honeynet Project:

1. **Global Reach**: Involves security professionals from around the world.
2. **Research Focus**: Aims to learn the tools, tactics, and motives of cybercriminals.
3. **Open Source**: Provides free tools and shares findings with the community.
4. **Real-World Impact**: Has uncovered numerous new attack techniques and malware strains.

A notable case from [the Honeynet Project](https://www.honeynet.org/) was the discovery of the "Cuckoo's Egg" attack in the early 2000s. This attack involved a sophisticated rootkit that was previously unknown. The honeypot allowed researchers to study the rootkit in detail, leading to improved detection and prevention methods for similar threats.

The Honeynet Project demonstrates the power of honeypots not just for individual organizations, but for advancing the entire field of cybersecurity through collaborative research and information sharing.

## Honeypots and MITRE ATT&CK Framework

Honeypots are closely related to the MITRE ATT&CK (Adversarial Tactics, Techniques, and Common Knowledge) framework. MITRE ATT&CK is a globally accessible knowledge base of adversary tactics and techniques based on real-world observations. The relationship between honeypots and MITRE ATT&CK manifests in several ways:

1. **Technique Detection**: Honeypots can be designed to detect and log specific techniques described in the MITRE ATT&CK framework. For example:

   - Technique T1078 (Valid Accounts): A honeypot can detect attempts to use valid accounts for unauthorized access.
   - Technique T1190 (Exploit Public-Facing Application): A honeypot simulating a public application can detect exploitation attempts.

2. **Tactic Mapping**: Information gathered by honeypots can be mapped to MITRE ATT&CK tactics, helping to understand attacker strategies.

3. **Threat Intelligence**: Honeypot data can enrich threat intelligence, potentially contributing to the MITRE ATT&CK knowledge base.

4. **Defense Improvement**: By correlating honeypot data with the MITRE ATT&CK framework, organizations can improve their defenses against specific techniques.

5. **Testing and Validation**: Honeypots can be used to test and validate the effectiveness of defenses against techniques described in MITRE ATT&CK.

Example usage:

- A honeypot detects an attack technique T1078 (Valid Accounts) and logs the event.
- The event is analyzed and mapped to the MITRE ATT&CK tactic "Discovery."
- This information can be used to improve defenses against similar attacks.

Overall, the relationship between honeypots and MITRE ATT&CK is symbiotic. Honeypots provide real-world data that helps validate and improve the effectiveness of defenses against known and unknown threats. MITRE ATT&CK, in turn, provides a structured way to understand and respond to these threats.