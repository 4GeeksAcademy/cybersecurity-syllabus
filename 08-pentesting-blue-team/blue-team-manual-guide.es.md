---
title: "Guía de Investigación de Incidentes para Analistas Blue Team"
subtitle: "Pasos clave para detectar amenazas y restaurar un servidor Linux comprometido"
tags: ["pentesting", "cybersecurity", "blue team", "incident response", "linux security", "digital forensics", "system hardening"]
authors: ["rosinni"]
---

Esta guía está diseñada para ayudarte a investigar de manera metódica un incidente en un servidor Linux comprometido. Más que una simple lista de comandos, se trata de una secuencia de pasos guiados con preguntas clave que te permitirán detectar actividad sospechosa, identificar mecanismos de persistencia y aplicar una lógica defensiva sólida, tal como lo haría un analista Blue Team profesional.


Aprender a realizar esta investigación de forma manual no solo fortalece tu criterio analítico, sino que te prepara para enfrentar escenarios reales donde las herramientas automatizadas pueden fallar, estar ausentes o incluso haber sido manipuladas. Además, en muchos entornos restringidos o durante evaluaciones como certificaciones técnicas, no se permite su uso. Esta metodología te enseña a detectar patrones, anomalías y correlaciones por ti mismo, y a justificar cada acción con argumentos sólidos, algo fundamental en contextos forenses y de ciberseguridad profesional.

## Paso 1: Observación general del sistema

**Preguntas clave:**
- ¿Está el sistema respondiendo más lento de lo habitual?
- ¿Está usando CPU, RAM o red de forma extraña?

**Comprobaciones sugeridas:**
```bash
uptime
free -h
top (o htop)
ip a
```

## Paso 2: Revisar procesos activos

**Preguntas clave:**
- ¿Hay procesos con nombres extraños o ubicaciones raras?
- ¿Hay procesos ejecutándose como root que no deberían estar?
- ¿Se está ejecutando algo de forma repetitiva?

**Comandos sugeridos:**
```bash
ps aux --sort=start_time
ps aux | grep -v “[” | less
```

Busca procesos que se repitan, nombres extraños, o comandos como `curl`, `wget`, `nc`, `bash`, etc.

## Paso 3: Revisar tareas programadas (cronjobs)

**Preguntas clave:**
- ¿Hay tareas automáticas que ejecutan scripts sospechosos?
- ¿Existen cronjobs no documentados?

**Comandos sugeridos:**
```bash
ls /etc/cron.d/
cat /etc/cron.d/*
crontab -l
```

Presta atención a rutas como `/usr/local/bin/*.sh` o tareas ejecutadas por `root` de forma periódica.

## Paso 4: Revisión de usuarios y accesos

**Preguntas clave:**
- ¿Hay usuarios que no deberían existir?
- ¿Hay actividad reciente de usuarios inusuales?

**Comandos sugeridos:**
```bash
cat /etc/passwd | grep -v "/usr/sbin/nologin"
last -a
grep "Failed password" /var/log/auth.log
```

Verifica cuentas con acceso a shell, accesos fallidos o usuarios sin justificación clara.

## Paso 5: Revisar logs del sistema

**Preguntas clave:**
- ¿Se registraron accesos inusuales por SSH?
- ¿Se ejecutaron comandos sospechosos?

**Comandos sugeridos:**
```bash
tail -n 100 /var/log/auth.log
journalctl -xe
cat ~/.bash_history
```

Revisa líneas que incluyan `scp`, `curl`, `chmod +x`, etc.

## Paso 6: Revisar configuración de red y firewall

**Preguntas clave:**
- ¿Hay puertos abiertos que no deberían estarlo?
- ¿Existen reglas sospechosas en iptables?

**Comandos sugeridos:**
```bash
ss -tuln
iptables -L -n -v
```

Verifica accesos entrantes desde IPs desconocidas o reglas que permitan conexiones sospechosas.

## Paso 7: Detectar persistencia y backdoors

**Preguntas clave:**
- ¿Qué se ejecuta automáticamente al iniciar?
- ¿Hay scripts ocultos en directorios sensibles?

**Comandos sugeridos:**
```bash
ls -la /usr/local/bin/
find /opt -type f -iname "*.sh"
cat /etc/rc.local
```

Revisa cualquier script sospechoso fuera del comportamiento esperado del sistema.

## Paso 8: Confirmar hallazgos y actuar

**Preguntas clave:**
- ¿Puedes explicar qué está pasando?
- ¿Identificaste procesos, usuarios, tareas o conexiones implicadas?

**Recomendación:** Documenta tus hallazgos con capturas o evidencias, enumera qué eliminarías, qué bloquearías y qué reforzarías y si es posible, comparte los hallazgos con otro compañero para validación.



**En resumen:** Esta metodología es profesional, pedagógica y aplicable a entornos reales. Las herramientas pueden ayudar, pero el criterio del analista es insustituible.
