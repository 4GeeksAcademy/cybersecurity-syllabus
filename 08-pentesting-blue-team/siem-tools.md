---
Title: "SIEM Tools"
Subtitle: "Discover Key Tools for Network Security Monitoring and Analysis"
Tags: ["cybersecurity", "pentesting"]
Authors: ["blindma1den", "lorenagubaira"]

---

### Snorby

Snorby is an interface for alert monitoring based on Ruby20. The key advantage is flexibility, i.e. the interface can be configured to accept events from different applications, and only certain codes need to be added. Snorby is used to monitor network security by incorporating events from IDS/IPS such as Snort or Suricata.

![Snorby](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/snorby.png?raw=true)

Using the packet capture (CapME21) provided by Snorby, you can make filtering with the desired characteristics, for example, select the address of the equipment and destination, the transmission protocol, and the date and time in which we want to search the database to obtain all related events. This simplifies the search and allows the analysis of the necessary events.

### Sguil

The Sguil tool is built by and for network security analysts. The main component of Sguil is a graphical user interface that provides access to real-time events, session data, and packet captures. Sguil facilitates the tracking and analysis of network events. The Sguil client can run on a multitude of operating systems, including Linux, BSD, Solaris, MacOS, and Windows.

![Sguil](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/sguil.png?raw=true)

Sguil provides visibility over collected event data and context to validate detection. It provides a single graphical user interface, in which, Snort or Suricata alerts, OSSEC alerts, HTTP Bro events, and real-time passive asset detection system (PRADS23) alerts are viewed.

More importantly, Sguil allows you to view all traffic associated with an alert, query all captured packets, and also traffic that need not pertain to that alert, but could be associated with malicious or unwanted activity.

Sguil differs from other alerting interfaces in that it allows collaboration between analysts by allowing them to comment on alerts.

![Sguil1](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/sguil1.png?raw=true)

### Squert

Squert is a web application used to query and view data events stored in a Sguil database (usually short alert data). Squert is a visual tool that attempts to provide additional information to events through the use of metadata, time series representations, weightings, and logically grouped result sets.

![Squert](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/squert.png?raw=true)

The Enterprise Log Search and Archive (ELSA) tool is an event analyzer that operates on three levels: log receiver, database or store, and web interface for incoming syslog. It leverages a pattern-based parser for event normalization and uses the Sphinx26 search engine for full-text indexing to perform event search.

ELSA allows to performance of a scan that can be scaled across the different nodes of a distributed system. The normalization process assigns each incoming user an identifier according to the user class. Users can grant granular permissions (whitelisting) for a host or program, i.e. a user can be limited to one or more hosts but can query any program or class on these machines. ELSA is divided into three main components: the end nodes, the DAEMON27 (daemon process) running on the web server, and the website itself. The nodes do not know the web interface and respond to any request to their listening port.

![Squert1](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/squert1.png?raw=true)

ELSA allows to perform log searches as if it were a web browser, just insert a time slot to perform a filtering of all logs and indicate a predefined filter to perform the search.

**ELSA in industrial networks:** The filters configured in ELSA do not allow filtering of industrial protocols by default. Industrial protocols are not recognized, but as seen in the section on Snort IDS, the implementation of Quickdraw rules allows one to recognize and filter, for example, port 502 or by ModBus protocol, without it being found as a default filter.

### SPLUNK

Splunk is a system that allows the correlation of events and the incorporation of field data and reports for sguil, Bro IDS, and OSSEC, and includes several dashboards and search interfaces to correlate events. It provides a highly scalable platform for data generated by all control system devices, sensors, SCADA systems, networks, applications, and end users connected to these industrial networks. Splunk elevates operational efficiency through:

- Integrating and aggregating data across operational technology.
- Searches, scans, and correlates across multiple sources to quickly diagnose the most costly operational problems.
- Leverages advanced analytics, providing the ability to detect patterns, trends, and anomalies.
- Rapidly delivers value through flexible deployment models.

![SPLUNK](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/splunk.png?raw=true)

### Security Onion

Security Onion is an intrusion detection Linux distribution upon which this study is based for network security monitoring and event management. Created by Doug Burks, this distribution was chosen for its focus on anomaly monitoring and detection of security problems, given the number of free tools (Snort, Suricata, Bro, Sguil, Squert, Snorby, ELSA, Xplico, Network Miner, etc.) included in it, as well as its easy installation and startup.

![Security Onion1](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/security-onion1.png?raw=true)

Doug Burks' idea is to create a Network Security Manager (NSM) by compiling several free programs and creating an easy-to-install security suite. Security Onion's features favor its performance in industrial networks, first because of the low cost of the solution, and then because of the ability to introduce rules defined in Snort to monitor industrial protocols.

**Main Components**

Security Onion is essentially composed of three basic functionalities:

- Packet capture.
- Host-based and network-based intrusion detection systems (HIDS and NIDS).
- Powerful and powerful analysis tools.

Full packet capture is achieved through netsniff-ng, wireshark, and other programs that have the same objective, capturing all traffic from the sensors defined in Security Onion. The captured information allows us to identify not only where or where the packets go but also where they have been stored (this allows us to exploit payloads, phishing emails, and file exfiltration). HIDS and NIDS analyze traffic passing through the host and network and provide alerting data, event logs, and detected activities. Security Onion offers multiple IDS options:

1. **NIDS: Security Onion has Snort and Suricata available.**
- **NIDS-guided scanning:** For scanning-driven network intrusion detection, Bro.
- **HIDS:** Security Onion offers OSSEC.

**Overview**

Network Security Management (NSM) refers to network monitoring by obtaining security-related events. It may be proactive when used to identify vulnerabilities or expiring SSL certificates, or it could be reactive, such as in incident response and network forensics. Whether it's tracking an adversary or trying to keep malware at bay, an NSM provides context, intelligence, and situational awareness of the network.

Security Onion provides visibility into network traffic and context around alerts and anomalous events but requires a commitment to the administrator or analyst, who must review alerts and monitor network activity. Security Onion integrates Sguil, Squert, and ELSA tools for this purpose.

**Implementation**

Security Onion is based on a distributed client-server model. One Security Onion sensor is the client and the other a server. The server and sensor components can run on a single physical or virtual machine, or multiple sensors can be distributed across an infrastructure and configured to report to a single designated server. The following are the three Security Onion deployment scenarios:

**Standalone**: A standalone installation consists of a single physical or virtual machine running both the server and the sensor components and related processes. A standalone installation can control multiple network segments with different network interfaces for monitoring. A stand-alone installation is the easiest and most convenient method to monitor a network or networks that are accessible from a single location.

**A server-sensor:** installation consists of one machine running the server and one or more separate machines running the detection and reporting back to the server. The sensors run all the search processes and store the packets associated with the capture, IDS alerts, and databases for Sguil and ELSA.

The analyst connects to the server from a separate client machine and all queries sent to the server are distributed to the appropriate sensors, and the requested information is sent to the client. This model reduces network traffic, keeping most of the data collected from the sensors until it is requested by the client. All traffic between the server, sensors, and client is protected with SSH encrypted tunnels.

**Hybrid:** A hybrid installation consists of a mix of the two architectures presented, it is a standalone installation that also has one or more separate sensors to report to the standalone machine server.