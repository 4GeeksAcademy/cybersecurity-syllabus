# IDS

**IDS** (*Intrusion Detection System*) el sistema de detección de intrusiones consiste en un conjunto de métodos y técnicas para revelar actividad sospechosa sobre un recurso o recursos informáticos. Es decir, eventos que sugieran un comportamiento anómalo, incorrecto o inapropiado sobre un sistema.

Un sistema de detección de intrusiones  puede ser descrito como un proceso de detección y monitorización de eventos que suceden en una red. Este sistema escucha y analiza toda la información que circula por una red, permite ayudar a entender los ataques, estimar los daños causados y tratar de prevenir otros ataques. Para detectar intrusiones en un sistema, los IDS utilizan tres tipos de información: un histórico de eventos, la configuración actual del sistema y, finalmente, procesos activos del sistema o reglas.

![Splunk5](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/splunk5.png?raw=true)

### **¿En qué consiste un IDS y cómo funciona?**

Hemos de partir de la base que aunque tengamos el cortafuegos habilitado, por normal general, tendremos muchos puertos abiertos, como por ejemplo el 80 y el 443 para las aplicaciones web. Por lo que debemos tener un sistema adicional que nos ayude a controlar estas puertas abiertas. Por lo que para llevar un mayor control debemos de utilizar un sistema IDS, esto es, un sistema de detección de intrusos y también de vulnerabilidades. Existen los IDS activos y los pasivos. Con los primeros se genera entradas en el registro y se generan alertas. Con los segundos en cambio, además de realizar las mismas funciones que con el pasivo, también se generarían acciones, como bloquear direcciones IP o cerrar el acceso a puertos restringidos.

Además desde el punto de vista del programación (*software*) existen diferentes tipos de herramienta, los sistemas de detección de intrusos (HIDS), sistemas de detección de intrusos en red (IDPS), los sistemas de detección de intrusos basados en firmas (SIDS) y por último los sistemas de detección de intrusos basados en anomalías.

![Splunk6](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/splunk6.png?raw=true)

Los sistemas IDS utilizan tres métodos para detectar el tráfico. Estos son la detección de anomalías, el análisis de protocolos y el análisis de firmas.

- Con la detección de anomalías tenemos como objetivo detectar un comportamiento anormal. Ejemplo de ello sería un volumen de tráfico ICMP (el que usa ping) inusual y muy elevado, que nos indicaría que somos el blanco o el emisor de un ataque de DDoS (Denegación de servicio)
- Respecto al análisis de protocolos se busca un tráfico de aplicación que no cumple el estándar del protocolo habitual.
- Por último, el análisis de firmas permite identificar ataques o comportamientos perjudiciales ya publicados. Suele ser la técnica más eficaz y la que no está sujeta a errores, ya que sólo se generan ataques o intrusiones que ya han tenido éxito en otro lugar, por lo que, pueden ser fácilmente identificados.

> ⚠️ Es importante que nuestro IDS actualice la información de forma habitual,  para así tener actualizadas siempre sus técnicas de análisis así como de las bases de datos de firmas.
</aside>

Existen una serie de organizaciones, asociaciones y empresas que nos permiten estar al corriente de las evoluciones en materia de técnicas de intrusión y ataques. Las principales son:

- Bugtraq: Es una lista de difusión dedicada a la publicación de vulnerabilidades, su uso y corrección. ([https://www.securityfocus.com/](https://www.securityfocus.com/))
- CERT: *Computer Emergency Response Team*. Se trata de una organización que estudia las vulnerabilidades, investiga las evaluaciones en términos de redes y seguridad y ofrece servicios relacionados con la seguridad. ([Entrada de Wikipedia al respecto](https://es.wikipedia.org/wiki/Equipo_de_Respuesta_ante_Emergencias_Inform%C3%A1ticas))
- CIAC: Computer Incident Advisory Capability. Una organización de alerta e investigación gestionado por el departament de energía de Estados Unidos. ( [https://www.energy.gov/cio/about-our-services/integrated-joint-cybersecurity-coordination-center](https://www.energy.gov/cio/about-our-services/integrated-joint-cybersecurity-coordination-center))

## **Tareas de un IDS**

Un IDS realiza dos tareas fundamentales:

- Prevención: se realiza por medio de herramientas que escuchan el tráfico en la red o en un ordenador, denominados sensores, e identifican los ataques aplicando reglas, reconocimiento de patrones o técnicas inteligentes.
- Reacción: trata de detectar patrones de intrusión en las trazas de los servicios de red o en el comportamiento del sistema.

Existen indicadores estadísticos de sensibilidad, especificidad y precisión que permiten comprobar la efectividad del IDS, se basan en los siguientes conceptos:

- Verdaderos positivos (TP): Intrusión existente y correctamente detectada.
- Falsos positivos (FP): Intrusión no existente e incorrectamente detectada.
- Falsos negativos (FN): Intrusión existente y no detectada.
- Verdaderos negativos (TN): Intrusión no existente y no detectada.

### **Tipos de IDS**

Existen distintas clasificaciones de los IDS, según sea su enfoque, origen de datos, estructura y comportamiento

![Splunk7](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/splunk7.png?raw=true)

## **En función del enfoque**

Se presentan dos grupos: Los sistemas de detección de usos indebidos, que comparan las firmas con la información recogida; y los de detección de anomalías, que usan técnicas estadísticas para distinguir el comportamiento usual del anormal.

1. **Detección de anomalías:** Es necesario definir cuál es el comportamiento normal de un sistema por medio de un aprendizaje de actividades, para clasificar los comportamientos que se desvíen de lo normal como sospechosos. Estos sistemas son propensos a dar falsos positivos, que son producidos cuando se dispara una alerta con actividad normal. Tienen la desventaja de que depende de la calidad del proceso de aprendizaje. Existen tres técnicas diferentes para realizar la detección de anomalías en un sistema:
- **Sistemas basados en conocimiento:** Representa el inicio en los IDS, y se basa en las violaciones de seguridad detectadas mediante el uso de reglas. Resultan más fiables y proporcionan mejores rendimientos frente a ataques conocidos, con el inconveniente de su baja capacidad para detectar nuevos ataques no incluidos en la base de datos de firmas.
- **Sistemas basados en métodos estadísticos**: Basado en perfiles de actividad que vienen definidos por el comportamiento del usuario, con respecto a ficheros, programas, registros, etc. Se realiza mediante el establecimiento de métricas y modelos estadísticos.
- **Sistemas basados en aprendizaje automático:** Son los más desarrollados para el modelado de comportamientos normales y buscan mejorar los resultados en cuanto a detección, reducción de falsos positivos y tiempo de computación. Una ventaja reside en recoger las características de un ataque y añadirlo a una base de datos como firmas nuevas, permitiendo actualizar la base de firmas en un breve lapso de tiempo.
1. **Detección de usos incorrectos (detección por firma/regla):** Los sistemas de detección basados en uso indebido monitorizan las actividades que ocurren en un sistema y las compara con una base de datos de firmas de ataques. Cuando se encuentra una actividad que coincide con una de estas firmas, se genera una alarma. Presentan una facilidad de adaptación ya que basta con actualizar la base de datos, ya sea, escribiendo la nueva regla u obteniéndose de un tercero.
- **Sistemas Expertos:** Conocimiento codificado mediante reglas de implicación (condición-acción), si se cumplen todas las condiciones se aplica la acción o regla. Presenta la desventaja de que las reglas no son secuenciales, lo que dificulta aislar pasos de intrusiones en el tiempo.
- **Detección de firmas:** Realiza comparaciones entre los eventos que ocurren en el sistema y las firmas almacenadas en la base de datos en busca de similitudes.
- **Análisis de transacción de estados:** Los ataques se representan como una secuencia de transiciones (máquina de estados finitos). Cuando se alcanza un estado considerado como intrusión se lanza una alarma.
1. **Híbridos:** Los IDS basados en firmas resultan más fiables y proporcionan mejores rendimientos frente a ataques conocidos, pero presentan una deficiencia ante nuevos ataques. Los IDS basados en anomalías presentan la capacidad de detectar ataques desconocidos, pero su rendimiento es inferior. Los sistemas híbridos serán una mezcla de ambos, y por lo tanto, pueden ajustarse para operar como ambos tipos de detectores, mejorando la funcionalidad, la detección de ataques y la mejora de rendimiento.

## **En función del origen de los datos**

Se encuentran tres tipos de IDS atendiendo a las fuentes de información que se utilicen:

**HIDS (*Host-based Intrusion Detection Systems*):** Los IDS basados en el host solo procesan información de las actividades de los usuarios y servicios en una máquina determinada. Permite monitorizar los datos generados por un usuario, mediante el uso de *syslog1*, e identificar amenazas e intrusiones a nivel de host. Una desventaja proviene del requerimiento de confianza en el sistema, que puede estar infectado anteriormente a la instalación, y lo hace vulnerable ante ataques directos.

**NIDS (*Network Intrusion Detection Systems*):** Los NIDS son instalados en un dispositivo en modo promiscuo, realizan una escucha pasiva sobre la red de forma que no interfieren en su uso, analizando el tráfico en tiempo real, pero por contra, resultan inútiles ante ataques locales. Los nuevos sistemas, basados en agentes inteligentes, permiten una detección de nuevos ataques usando el concepto de centinelas, que supervisan el sistema para recoger toda la información necesaria para la detección.

![Splunk8](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/splunk8.png?raw=true)

**IDS Híbridos:** Los sistemas híbridos recogen lo mejor de ambos tipos HIDS y NIDS. Permiten una detección local de los sistemas y un sensor en cada segmento de red se encarga de la vigilancia. De esta forma se cubren las necesidades HIDS con las del NIDS, permitiendo el aprovechamiento de las ventajas de ambas arquitecturas.

### **En función de su estructura**

**Clasificación basada en las estrategias de control**

**Sistema de Detección de Intrusión Distribuido (DIDS):** Se basa en la instalación en un sistema distribuido, ubicando sensores repartidos por varios equipos de la red. Estos sensores se comunican con un nodo central donde se recibirá toda la información y donde se cruzan los datos, lo que nos permitirá detectar los ataques con fiabilidad y obtener una visión global mejorando la detección de incidentes.

![dids](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/dids.png?raw=true)

**Sistema de Detección de Intrusión Centralizado:** Emplea sensores que transmiten información a un sistema central que realiza el control, permitiendo ahorrar en equipamientos.

![sdi](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/sdi.png?raw=true)

### **En función de su comportamiento**

Encontramos dos tipos de IDS según si realizan la prevención escuchando el tráfico o si se elabora una respuesta defensiva cuando se detecta un ataque.

**IDS Pasivo:** Sólo notifican al administrador de la red pero no actúan sobre el ataque. Únicamente procesan la información en busca de intrusiones, y una vez detectada se genera una alerta.

**IDS Activos:** Es un tipo de IDS denominado Sistema de Prevención de Intrusión (IPS). A diferencia de los IDS, esta tecnología no se limita a escuchar el tráfico de la red y a mandar alertas, sino que permite establecer reglas, como se hace en los cortafuegos, para detener las intrusiones.

## **Suricata vs Snort: una comparación y revisión completas**

Cuando se trata de sistemas de detección de intrusiones en la red (NIDS), elegir entre Suricata y Snort es una discusión constante entre los profesionales de la seguridad cibernética. Estas herramientas de código abierto ofrecen funciones avanzadas para monitorear y proteger las redes de amenazas potenciales. Proporcionaremos una comparación en profundidad de Suricata y Snort, evaluando sus características, funcionalidad, rendimiento, escalabilidad, facilidad de uso, configuración y soporte de la comunidad.

Al explorar las distinciones y fortalezas clave de estos dos NIDS, obtendrá el conocimiento necesario para tomar una decisión informada sobre qué herramienta se alinea mejor con sus necesidades y objetivos específicos. Si es nuevo en el campo de la seguridad cibernética o un profesional experimentado que busca ampliar su experiencia, ofrecemos información valiosa y orientación práctica para implementar y administrar Suricata o Snort dentro de su entorno de red. Ahora, profundicemos en el mundo de NIDS y echemos un vistazo crítico a Suricata vs Snort.

### **¿Qué es un sistema de detección de intrusiones en la red?**

Un sistema de detección de intrusiones en la red (NIDS) es una herramienta de seguridad que monitorea el tráfico de la red en busca de actividades maliciosas o violaciones de políticas, detectando y alertando a los administradores sobre amenazas potenciales. NIDS analiza el tráfico y aplica reglas predefinidas para identificar patrones o comportamientos sospechosos, lo que ayuda a proteger las redes de intentos de intrusión, malware y otras amenazas cibernéticas. Estos sistemas desempeñan un papel crucial en la protección de la infraestructura de red, los datos críticos y los recursos de una organización contra los ciberataques.

Al implementar un NIDS, su posicionamiento dentro de la red es crucial para un monitoreo efectivo. Idealmente, el NIDS debería colocarse en los puntos de entrada y salida de la red, monitoreando todo el tráfico entrante y saliente. Esto permite que el sistema detecta y alerta sobre amenazas potenciales antes de que puedan infiltrarse en la red o filtrar datos confidenciales. Además, colocar dispositivos NIDS en puntos estratégicos dentro de la red puede ayudar a detectar movimientos laterales o amenazas internas, mejorando aún más la postura de seguridad de la organización.

NIDS emplea una variedad de métodos para detectar y alertar sobre amenazas potenciales. La detección basada en firmas (SIDS) utiliza patrones o firmas predefinidos de amenazas conocidas para identificar actividad maliciosa, mientras que la detección basada en anomalías (AIDS) identifica desviaciones del comportamiento normal de la red, que pueden indicar un ataque. Además, algunas soluciones NIDS ofrecen análisis heurístico, empleando aprendizaje automático e inteligencia artificial para predecir e identificar nuevas amenazas en función de su comportamiento.

### **¿Qué son Suricata y Snort?**

Echemos un vistazo de las dos herramientas que comparamos antes de profundizar en sus atributos y funcionalidades únicos.

- **Suricata**

![Suricata](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/suricata.png?raw=true)

Suricata es un sistema de detección de intrusiones en la red (NIDS) de código abierto desarrollado por la Open Information Security Foundation (OISF). Suricata se puede utilizar como sistema de prevención de intrusiones (IPS) y motor de monitoreo de seguridad de red, aunque esto depende en gran medida de su implementación dentro de su red. Si está basado en host o es pasivo, solo funciona como un IDS, mientras que si se implementa como una solución activa en línea le permite agregar la utilidad IPS. Es conocido por su arquitectura multiproceso de alto rendimiento y su enfoque en proporcionar capacidades avanzadas de detección y prevención de intrusiones.

Suricata funciona analizando el tráfico de la red, aplicando reglas predefinidas para identificar actividades maliciosas y alertando a los administradores sobre posibles amenazas. Lo que distingue a Suricata de otros NIDS es su arquitectura multiproceso, que le permite procesar de manera eficiente múltiples tareas simultáneamente. Esto da como resultado un procesamiento de paquetes más rápido y un mayor rendimiento en comparación con los sistemas de un solo subproceso.

**Descargar Suricata** **[https://suricata.io/download/](https://suricata.io/download/)**

- **Snort**

![Snort](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/snort.png?raw=true)

Snort es un popular sistema de detección de intrusiones en la red (NIDS) de código abierto, creado por Martin Roesch y mantenido por Cisco Systems. Snort lleva casi una década más en el mercado y goza de una amplia compatibilidad con varios dispositivos, sistemas operativos y herramientas de terceros. Su enfoque principal es la detección basada en reglas y el análisis de protocolos.

Snort funciona monitoreando el tráfico de la red y aplicando reglas predefinidas para detectar actividad maliciosa, generando alertas para que los administradores tomen las medidas adecuadas. La fortaleza de Snort radica en su extenso conjunto de reglas, que se pueden personalizar para satisfacer las necesidades de seguridad específicas de una organización. Esta adaptabilidad permite **a Snort sobresalir** en diversos entornos, brindando protección personalizada contra una amplia gama de amenazas.

**Descargar Snort** **[https://www.snort.org/downloads#snort-downloads](https://www.snort.org/downloads#snort-downloads)**

### **Características y funcionalidad**

Al comparar Suricata y Snort, es importante examinar las características clave que debe tener un IDS para determinar su efectividad e idoneidad para diferentes entornos. Aquí, profundizaremos en estas características principales de ambas herramientas, destacando sus similitudes y diferencias.

![ids2](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/ids2.png?raw=true)

Suricata sobre Elastic, de [https://elastic.co](https://elastic.co/)

![ids3](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/ids3.png?raw=true)

Snort con elástico (ELK) de [https://blog.snort.org](https://blog.snort.org/)

- **Captura de paquetes**

Tanto Suricata como Snort destacan en la captura de paquetes, lo que les permite monitorear y analizar el tráfico de la red en busca de actividad maliciosa. La arquitectura multiproceso de Suricata proporciona una ventaja en la captura de paquetes, permitiéndole procesar múltiples tareas simultáneamente y ofreciendo un rendimiento mejorado en comparación con Snort. Snort, por otro lado, se basa en una arquitectura de un solo subproceso, lo que puede limitar su rendimiento de captura de paquetes en entornos de mucho tráfico.

- **Análisis de protocolo**

Suricata y Snort proporcionan un análisis de protocolo integral, lo que les permite decodificar y analizar varios protocolos de red para detectar amenazas. Si bien ambos sistemas ofrecen un amplio soporte de protocolo, Suricata tiene la ventaja adicional de **[admitir datos X-Forwarded-For (XFF)](https://redmine.openinfosecfoundation.org/issues/478)** .

- **X-reenviado-para (XFF)**

El encabezado X-Forwarded-For (XFF), **[estandarizado en RFC 7239](https://datatracker.ietf.org/doc/rfc7239/)**  como "Extensión HTTP reenviada", permite a los servidores proxy compartir información sobre el cliente original y otros servidores proxy en una cadena. En pocas palabras, los servidores proxy ubicados entre un host y el destino (como un sitio web) agregarán este encabezado para incluir no solo su dirección IP sino también la dirección del host que inicialmente solicitó la información. Esto puede ser importante a la hora de solucionar problemas o por motivos de seguridad al intentar determinar quién está intentando acceder al sitio web. XFF también se puede utilizar con otros protocolos de red, como el correo electrónico.

- **Detección basada en reglas**

La detección basada en reglas es una característica central tanto de Suricata como de Snort, que utiliza reglas predefinidas para identificar actividad maliciosa dentro del tráfico de la red. La fortaleza de Snort radica en su extenso conjunto de reglas, que se pueden personalizar para satisfacer necesidades de seguridad específicas. Suricata también ofrece un conjunto de reglas sólido, con el beneficio adicional de Suricata-Update, una herramienta para administrar y actualizar conjuntos de reglas de manera más eficiente.

- **Arquitectura de subprocesos múltiples**

La arquitectura multiproceso de Suricata lo distingue de Snort en algunos aspectos, permitiéndole procesar múltiples tareas simultáneamente y ofreciendo un rendimiento mejorado. Snort se basa en una arquitectura de un solo subproceso, lo que puede limitar su rendimiento en entornos de mucho tráfico o cuando se procesan tareas que consumen muchos recursos.

- **Integración y compatibilidad**

Si bien tanto Suricata como Snort ofrecen integración con herramientas populares de código abierto, Snort tiene una trayectoria más extensa en el mercado y disfruta de una amplia compatibilidad con una variedad de dispositivos, sistemas operativos y herramientas de terceros. Suricata, sin embargo, se beneficia de su integración con ELK Stack, proporcionando visualización y análisis mejorados del tráfico de la red.

### **Resumen**

En resumen, tanto Suricata como Snort ofrecen características y funcionalidades sólidas que los convierten en soluciones IDS efectivas. La arquitectura multiproceso de Suricata, la compatibilidad con datos XFF y la gestión eficiente de reglas con Suricata-Update le otorgan una ventaja competitiva en ciertos aspectos.

Sin embargo, el extenso conjunto de reglas, las opciones de personalización y la amplia compatibilidad de Snort lo convierten en un fuerte contendiente. La elección entre Suricata y Snort depende en última instancia de sus necesidades específicas, entorno de red y requisitos de rendimiento.

| SURICATA | SNORT |
| --- | --- |
| La arquitectura multiproceso permite el procesamiento eficiente de múltiples tareas simultáneamente | Arquitectura de un solo subproceso |
| Suricata-Update para gestionar y actualizar conjuntos de reglas | Mayor compatibilidad con dispositivos, sistemas operativos y herramientas de terceros debido a su mayor presencia en el mercado. |
| Capacidades avanzadas de detección y prevención de intrusiones | Centrarse en la detección basada en reglas y el análisis de protocolos |
| Mejor rendimiento en entornos de mucho tráfico | Mejor rendimiento en entornos con recursos limitados |
| Admite modos en línea y pasivo | Admite modos en línea y pasivo |
- **Rendimiento y escalabilidad**

La próxima comparación entre Suricata y Snort examinará su rendimiento y escalabilidad para determinar qué NIDS se adapta a diferentes entornos y limitaciones de recursos. Aquí, discutiremos la velocidad, el uso de la memoria y la precisión tanto de Suricata como de Snort.

- **Velocidad**

Aquí, la arquitectura multiproceso de Suricata le permite procesar múltiples tareas simultáneamente, ofreciendo un rendimiento mejorado en comparación con la arquitectura de un solo subproceso de Snort. Esta ventaja permite a Suricata manejar mayores volúmenes de tráfico y proporcionar un procesamiento de paquetes más rápido, lo que la convierte en una opción más adecuada para entornos de mucho tráfico. Snort, por otro lado, aún puede ofrecer un rendimiento adecuado en situaciones de tráfico moderado. Sin embargo, su arquitectura de subproceso único puede limitar su velocidad en entornos de mucho tráfico o cuando se procesan tareas que consumen muchos recursos.

- **Uso de memoria**

En términos de uso de memoria, Snort generalmente consume menos recursos en comparación con Suricata. Esto hace que Snort sea una mejor opción para entornos con recursos limitados, como dispositivos de bajo consumo o redes con recursos de hardware limitados. Suricata, aunque normalmente requiere más memoria, aún puede proporcionar un rendimiento razonablemente eficiente debido a su arquitectura multiproceso, que le permite manejar grandes volúmenes de tráfico de manera más efectiva.

- **Exactitud**

Tanto Suricata como Snort ofrecen altos niveles de precisión en la detección de actividades maliciosas dentro del tráfico de la red. Lo logran a través de conjuntos completos de reglas y capacidades de análisis de protocolos. Sin embargo, el soporte de Suricata para datos X-Forwarded-For (XFF) y su capacidad para descifrar, analizar y luego volver a cifrar rápidamente datos de red cuando se colocan detrás de un proxy inverso pueden proporcionar una ligera ventaja en la detección de amenazas avanzadas.

### **Resumen**

En resumen, la arquitectura multiproceso de Suricata y el uso eficiente de los recursos lo hacen más escalable y adecuado para entornos de alto tráfico. Sin embargo, el menor uso de memoria de Snort lo convierte en una mejor opción para entornos con recursos limitados. La elección entre Suricata y Snort depende de las necesidades específicas, el entorno de red y las limitaciones de recursos de una organización.

| SURICATA | SNORT |
| --- | --- |
| El uso eficiente de los recursos permite un mejor manejo de grandes volúmenes de tráfico | El menor uso de recursos lo hace adecuado para entornos con recursos limitados |
| La arquitectura multiproceso proporciona un rendimiento mejorado | La arquitectura de un solo subproceso puede tener limitaciones de rendimiento en entornos de mucho tráfico |
| Escalable debido a su uso eficiente de recursos y capacidades de manejo de tráfico. | Puede ser menos escalable en comparación, especialmente en entornos de mucho tráfico. |
- **Facilidad de uso y configuración**

A continuación, consideraremos la facilidad de uso y configuración, ya que estos factores pueden afectar significativamente el tiempo y el esfuerzo necesarios para implementar y administrar una solución NIDS. En esta sección, discutiremos los aspectos de instalación, configuración y administración de reglas de Suricata y Snort, destacando sus diferencias y ventajas.

- **Instalación**

Suricata y Snort se pueden instalar con relativa facilidad en varios sistemas operativos, **incluido Kali Linux** . Sin embargo, el proceso de instalación de Suricata podría ser más ágil, ya que proporciona paquetes prediseñados para diferentes plataformas, lo que simplifica su instalación y configuración. Snort, aunque sigue siendo sencillo de instalar, puede requerir pasos y dependencias adicionales para configurarlo, especialmente cuando se integra con herramientas de terceros.

- **Configuración**

Configurar Suricata y Snort implica configurar sus respectivos ajustes y conjuntos de reglas. Suricata cuenta con una interfaz web y archivos de configuración basados ​​en YAML, que pueden simplificar el proceso de configuración para usuarios con experiencia limitada en seguridad de red. Este enfoque fácil de usar puede facilitar la gestión y el mantenimiento de Suricata en diversos entornos.

Por otro lado, la configuración de Snort se basa en archivos de configuración basados ​​en texto, lo que podría requerir más intervención manual y una curva de aprendizaje más pronunciada para los recién llegados. Sin embargo, la extensa documentación de Snort y el apoyo activo de la comunidad pueden ayudar a los usuarios a superar estos desafíos y configurar efectivamente el sistema para satisfacer sus necesidades.

- **Gestión de reglas**

La gestión de reglas es un aspecto crucial de cualquier solución NIDS, ya que determina la capacidad del sistema para detectar y prevenir amenazas. Suricata y Snort ofrecen conjuntos de reglas completos, pero difieren en cómo administran y actualizan estas reglas.

Suricata se beneficia de la herramienta Suricata-Update, que simplifica la gestión y actualización de conjuntos de reglas. Esta característica permite a los usuarios mantener fácilmente las últimas capacidades de detección de amenazas, lo que reduce el tiempo y el esfuerzo necesarios para mantener el sistema actualizado.

![NIDS](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nids.png?raw=true)

Herramienta Suricata-Update, de [https://suricata.readthedocs.io](https://suricata.readthedocs.io/)

Por el contrario, Snort se basa en la gestión manual de reglas, lo que puede llevar más tiempo y requerir más experiencia. Sin embargo, los conjuntos de reglas específicos de Snort para ciertos casos de uso, como la seguridad de aplicaciones web, pueden proporcionar mejores opciones de personalización para redes con requisitos de seguridad únicos. Esta flexibilidad puede hacer que Snort sea más adecuado para organizaciones con necesidades específicas de detección de amenazas.

### **Resumen**

Suricata ofrece un enfoque más fácil de usar para la instalación, configuración y administración de reglas, lo que puede beneficiar a los usuarios con experiencia limitada o limitaciones de tiempo. Snort, aunque potencialmente más difícil de configurar, ofrece mayores opciones de personalización y está respaldado por una extensa documentación y soporte de la comunidad. En última instancia, la elección entre Suricata y Snort dependerá de los requisitos únicos de una organización, los recursos y el nivel de experiencia de sus administradores.

| SURICATA | SNORT |
| --- | --- |
| Sin interfaz web incorporada (de terceros disponibles) | Sin interfaz web incorporada (de terceros disponibles) |
| La configuración basada en YAML simplifica la configuración | Métodos de configuración tradicionales |
| Actualización de Suricata para una gestión de reglas optimizada | Gestión manual de reglas y actualizaciones. |
| Configuración más sencilla gracias a la interfaz web y la configuración YAML | Puede requerir más esfuerzos de personalización y configuración. |
- **Comunidad y soporte**

Considerar el nivel de comunidad y soporte disponible para cada NIDS es crucial para cualquier herramienta de código abierto, ya que puede afectar la facilidad de implementación, configuración y mantenimiento continuo. En esta sección, compararemos la documentación, los foros, las integraciones de terceros y la frecuencia de actualización de Suricata y Snort.

- **Documentación**

Suricata y Snort cuentan con documentación completa y bien organizada, lo que brinda a los usuarios recursos valiosos para comprender, configurar y solucionar problemas de sus respectivos sistemas. **[La documentación de Suricata](https://suricata.readthedocs.io/en/suricata-6.0.0/index.html)**  se actualiza con frecuencia para reflejar las últimas funciones y mejoras, lo que garantiza que los usuarios puedan mantenerse al día con el panorama de seguridad cibernética en rápida evolución.

**[La documentación de Snort](https://www.snort.org/documents)** , aunque también es extensa, puede requerir más tiempo para navegar debido a su larga historia y la variedad de integraciones de terceros disponibles. Sin embargo, la documentación de Snort cubre una amplia gama de temas, lo que la convierte en un recurso valioso para los usuarios que buscan personalizar y optimizar su implementación NIDS.

- **Foros**

Suricata y Snort tienen comunidades activas y comprometidas, con foros que brindan una plataforma para que los usuarios hagan preguntas, compartan conocimientos y colaboren en diversos temas relacionados con sus implementaciones NIDS. Estos foros son invaluables para los usuarios que buscan asistencia, orientación o consejo de profesionales y pares con experiencia en el campo de la seguridad cibernética.

![Foros](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/foros.png?raw=true)

Foros de Suricata, desde [https://suricata.io](https://suricata.io/)

![Suricata2](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/suricata2.png?raw=true)

Blog de Snort, de [https://blog.snort.org](https://blog.snort.org/)

- **Integraciones de terceros**

Dada la presencia más prolongada de Snort en el mercado, ha acumulado una gama más amplia de integraciones de terceros en comparación con Suricata. Estas integraciones incluyen varias herramientas, plataformas y servicios que pueden mejorar las capacidades de Snort y agilizar su implementación y administración.

Suricata, si bien sigue ofreciendo una lista cada vez mayor de integraciones de terceros, es posible que aún no coincida con el extenso ecosistema de Snort. Sin embargo, el desarrollo activo de Suricata y su enfoque en la compatibilidad con herramientas y plataformas existentes sugieren que su gama de integraciones de terceros continuará expandiéndose con el tiempo.

- **Frecuencia de actualización**

Suricata se beneficia de una comunidad de desarrollo activa que publica con frecuencia actualizaciones y mejoras de sus características y capacidades. Este compromiso con la mejora continua garantiza que los usuarios de Suricata puedan mantenerse a la vanguardia de las cambiantes amenazas a la seguridad cibernética y aprovechar las últimas innovaciones en detección y prevención de intrusiones. Suricata publica actualizaciones importantes en promedio cada 3 meses.

Snort, aunque también recibe actualizaciones periódicas, puede no tener la misma frecuencia de mejoras que Suricata debido a su madurez y posición establecida en el mercado. Sin embargo, las actualizaciones de Snort aún brindan importantes mejoras de seguridad y correcciones de errores, lo que garantiza que el sistema siga siendo efectivo y confiable. Snort publica actualizaciones menores en promedio cada 2 o 3 semanas.

### **Resumen**

Tanto Suricata como Snort ofrecen un sólido soporte comunitario, con documentación extensa, foros activos y una variedad de integraciones de terceros. La historia más larga de Snort proporciona un ecosistema de integraciones más extenso, mientras que Suricata se beneficia de actualizaciones y mejoras frecuentes debido a su desarrollo activo. La elección entre Suricata y Snort dependerá de las necesidades y preferencias específicas de una organización y del valor que le dan al soporte comunitario, la documentación y las integraciones de terceros.

| SURICATA | SNORT |
| --- | --- |
| Apoyo activo de la comunidad | Apoyo activo de la comunidad |
| Amplia documentación | Amplia documentación |
| Desarrollo activo, lo que resulta en actualizaciones y mejoras frecuentes. | Una gama más amplia de integraciones de terceros debido a su mayor presencia en el mercado. |
| Open Information Security Foundation (OISF) como principal organización de desarrollo | Mantenido por sistemas Cisco |
- **Costo**

Al igual que con las otras medidas, el costo es un factor importante a considerar. Ambas herramientas son de código abierto, lo que significa que están disponibles gratuitamente. Sin embargo, puede haber costos adicionales asociados con el soporte, la capacitación y otros recursos.

| FACTOR DE COSTO | SURICATA | SNORT |
| --- | --- | --- |
| Licencia | Fuente abierta | Fuente abierta |
| Opciones de soporte | Comunidad (Gratis) | Comunidad (Gratis)
Pagado-Personal $30/año-Profesional desde $300/año |
| Recursos de capacitación | Gratis
Pagado (A partir de $2,000 desde Suricata) | Gratis |
| Herramientas de terceros | Gratis
Pagado (ejemplo: Elastic desde $95/mes) | Gratis
pagado (Reglas de Talos) -Personal $30/año-Profesional desde $400/año |
| Requisitos de hardware | Varía según la escala | Varía según la escala |

### **Conclusión**

En conclusión, tanto Suricata como Snort son potentes sistemas de detección de intrusiones en la red que brindan una protección sólida para su entorno de red. Si bien comparten muchas similitudes, también tienen características únicas, características de rendimiento y apoyo de la comunidad, lo que hace que la elección entre ellos dependa de las necesidades y recursos específicos de su organización.

![Suricata3](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/suricata3.png?raw=true)

Hemos comparado y contrastado los aspectos clave de Suricata y Snort, incluidas características, funcionalidad, rendimiento, escalabilidad, facilidad de uso, configuración, soporte comunitario y costo. Al comprender estos factores, podrá tomar una decisión informada sobre cuál es el mejor NIDS para su organización.

En última instancia, la elección entre Suricata y Snort dependerá de los requisitos únicos de su red, los recursos disponibles y el nivel de personalización deseado. Cualquiera que sea la herramienta que elija, puede estar seguro de que está dando un paso proactivo para mejorar la seguridad de su red y proteger su organización de posibles amenazas cibernéticas. Puede continuar aprendiendo formas efectivas de proteger su red tomando uno de los cursos a continuación.

### **Preguntas más frecuentes**

- **¿Suricata es una IPS o un IDS?**

Suricata funciona principalmente como un sistema de detección de intrusiones en la red (NIDS). Sin embargo, también se puede configurar como un sistema de prevención de intrusiones (IPS) implementándolo en línea. En este modo, Suricata puede bloquear activamente el tráfico malicioso además de detectar y alertar sobre amenazas potenciales. Esta versatilidad hace que Suricata sea adecuado para diversos casos de uso de seguridad de red, según los requisitos específicos de la organización.

- **¿Snort sigue siendo relevante?**

Sí, Snort sigue siendo relevante en el panorama de la seguridad cibernética. A pesar de la aparición de herramientas más nuevas como Suricata, la larga presencia de Snort en el mercado ha establecido su compatibilidad con una amplia gama de dispositivos, sistemas operativos y herramientas de terceros. La detección basada en reglas y el análisis de protocolos de Snort continúan brindando una seguridad de red efectiva. Su amplio soporte comunitario garantiza que el software se mantenga actualizado y responda a las amenazas en evolución.

- **¿Suricata tiene GUI?**

No orgánicamente al software. Sin embargo, Suricata ofrece una interfaz gráfica de usuario (GUI) a través de varias herramientas de gestión basadas en web. Una opción popular es la distribución SELKS, que incluye Suricata y otras herramientas de seguridad, junto con un panel Kibana preconfigurado para visualización y gestión. Al utilizar estas herramientas basadas en web, los administradores pueden administrar fácilmente la configuración de Suricata y monitorear la actividad de la red en un entorno fácil de usar.

Instalar y configurar el sistema de detección de intrusos Snort 3 en Ubuntu

Requisitos previos

- Un servidor con Ubuntu
- Se configura una contraseña raíz en el servidor.