# SIEM

### **쯈u칠 es un SIEM?**

SIEM o Gesti칩n de Eventos e Informaci칩n de Seguridad (Security Information and Event Management) es una categor칤a de software que tiene como objetivo otorgar a las organizaciones informaci칩n 칰til sobre potenciales amenazas de seguridad de sus redes cr칤ticas de negocio, a trav칠s de la estandarizaci칩n de datos y priorizaci칩n de amenazas. Esto es posible mediante un an치lisis centralizado de datos de seguridad, obtenidos desde m칰ltiples sistemas, que incluyen aplicaciones antivirus, firewalls y soluciones de prevenci칩n de intrusiones.

Las soluciones SIEM son una soluci칩n h칤brida de las categor칤as de productos como SIM (*Security Information Management*) y SEM (*Security Event Manager*). La tecnolog칤a SIEM proporciona un an치lisis en tiempo real de las alertas de seguridad generadas por el hardware y software de red. Las soluciones SIEM pueden venir como software, aplicaciones, o administraci칩n de servicios, y tambi칠n son utilizados para registrar datos de seguridad y generar reportes para fines de cumplimiento.

> SEM: Es el primer 치rea de gesti칩n de la seguridad, se ocupa de la monitorizaci칩n en tiempo real, correlaci칩n de eventos, notificaciones y vistas de la consola que com칰nmente se conoce como Gesti칩n de Eventos de Seguridad (Security Event Management).
 
> **SIM**: Ofrece almacenamiento a largo plazo, an치lisis y comunicaci칩n de los datos de eventos, y se conoce como **Gesti칩n de Seguridad de la Informaci칩n (*Security Information Management*)**.

El t칠rmino Gesti칩n de la Informaci칩n de Seguridad y de Eventos (***Security Information and Event Management***) describe m칰ltiples capacidades como la recopilaci칩n, an치lisis y presentaci칩n de informaci칩n de la red y los dispositivos de seguridad. A esto se le a침aden

las aplicaciones de gesti칩n de identidades y accesos, gesti칩n de vulnerabilidades y los instrumentos de pol칤tica de cumplimiento, sistema operativo, base de datos, logs, y datos de amenazas externas. La clave es monitorizar y ayudar a controlar los privilegios de usuario y de servicio, servicios de directorio y otros cambios de configuraci칩n del sistema, as칤 como proporcionar datos para auditor칤a de eventos, revisi칩n y respuesta a incidentes.

La detecci칩n de eventos de inter칠s puede ser a trav칠s de cualquiera de los grupos funcionales, con el soporte SEM, capaz de monitorizar en tiempo real; y el SIM, que proporciona un medio eficaz para comparar la gran cantidad de eventos recopilados. Los SIEM est치n dise침ados para recopilar eventos de seguridad a partir de una amplia variedad de fuentes dentro de una organizaci칩n. Una vez que el SIEM tiene los eventos, procesa los datos para estandarizarlos, lleva a cabo el an치lisis de los datos "normalizados", genera alertas cuando detecta actividad an칩mala, y produce informes a petici칩n de los administradores. Algunos productos SIEM tambi칠n pueden actuar para bloquear las actividades maliciosas.

### **쯇or qu칠 es importante tener un SIEM?**

No es un secreto que las amenazas de seguridad aumentan continuamente, y que pueden provenir tanto de fuentes internas como externas. Una preocupaci칩n que crece es la posibilidad de que, accidentalmente, los empleados configuren err칩neamente los ajustes de seguridad, dejando los datos vulnerables a un ataque. Para prevenir estos problemas, las organizaciones de IT han incorporado varios sistemas para protegerse de intrusiones y de una gran cantidad de amenazas diversas.

La desventaja de estos sistemas de protecci칩n es que generan tanta informaci칩n para monitorizar, que los equipos de IT se enfrentan al problema de tener que interpretarla en su totalidad para poder reconocer los problemas reales. De hecho, el volumen de datos de Seguridad que fluyen a los equipos de Seguridad de IT con poco personal, es m치s que nada in칰til, a menos que pueda ser r치pidamente analizado y filtrado en alertas procesables. Teniendo en cuenta la cantidad de datos que pueden llegar a ser, para las organizaciones ya no es posible hacer este an치lisis en forma manual. Es aqu칤 donde aparece el software SIEM.

Con un SIEM, los profesionales de IT cuentan con un m칠todo efectivo para automatizar sus procesos y centralizar la gesti칩n de Seguridad de una forma que ayude a simplificar la dif칤cil tarea de proteger informaci칩n sensible. Un SIEM proporciona a los expertos una ventaja para comprender la diferencia entre una amenaza de bajo riesgo y una que puede ser determinante para su negocio.

<aside>
游녤 **La estandarizaci칩n de datos es fundamental**
</aside>

La posibilidad de contar con datos de Seguridad que fluyen en una vista centralizada de su infraestructura es efectiva solo si esos datos pueden ser estandarizados. Esto significa que, a pesar de las miles o millones de entradas provenientes de los distintos sistemas y fuentes, todo puede ser colocado en un formato com칰n, listo para que la soluci칩n SIEM pueda ejecutar su an치lisis y correlaci칩n. Esto reduce la carga de trabajo de su equipo y le permite aprovechar una vista optimizada de la actividad y las potenciales preocupaciones.

## **Funcionalidades claves de una soluci칩n SIEM**

Las soluciones SIEM disponibles comparten puntos en com칰n que son importantes para sus operaciones. Debe contar con la capacidad de:

- Centralizar la vista de potenciales amenazas
- Determinar qu칠 amenazas requieren resoluci칩n y cu치les son solamente ruido
- Escalar temas a los analistas de Seguridad apropiados, para que puedan tomar una acci칩n r치pida
- Incluir el contexto de los eventos de Seguridad para permitir resoluciones bien informadas
- Documentar, en un registro de auditor칤a, los eventos detectados y c칩mo fueron resueltos
- Cumplir con las regulaciones de la industria en un formato de reporte sencillo

## **El rol de SIEM en el cumplimiento regulatorio**

Los SIEM ganaron popularidad entre las grandes compa침칤as que deben cumplir con PCI DSS (el Est치ndar de Seguridad de Datos para la Industria de Tarjetas de Pago). Adem치s, dispone de aplicaciones muy 칰tiles que ayudan al cumplimiento de normativas como la Regulaci칩n General de Protecci칩n de Datos (GDPR), y Sarbanes-Oxley (SOX), entre otras. Estas leyes obligan a las empresas a contar con mecanismos instalados que les permitan detectar amenazas y resolverlas r치pidamente. Esto significa que debe saber lo que est치 sucediendo en un amplio espectro de su infraestructura de IT, ya sea en entornos locales, en la nube, o h칤bridos.

Una soluci칩n SIEM es fundamental para obtener la informaci칩n necesaria para monitorizar datos y actuar r치pidamente sobre las amenazas que est치n determinadas a ser una causa de alarma. Cuando toda esta actividad est치 capturada en un registro de auditor칤a detallado, los auditores pueden ver que su compa침칤a est치 tomando los pasos necesarios para proteger sus datos.

### **Ejemplos de SIEM en acci칩n:**

Un SIEM puede ser utilizado para detectar cualquier n칰mero de amenazas de Seguridad, incluso la presencia de ransomware, accesos no autorizados a datos, intentos de log-in fallidos que no coinciden con los problemas est치ndares de log-in, y picos inusuales en el ancho de banda. Ya sea que estas amenazas provengan de fuentes internas o externas, el software es capaz de enviar una alerta priorizada que notifique a su equipo del problema potencial para que sea investigado de inmediato. A medida que las amenazas de Seguridad evolucionan, las soluciones SIEM se convierten en un componente cr칤tico para proporcionar a las organizaciones un entorno seguro para sus datos.

- **Capacidades de detecci칩n en tiempo real**

La gesti칩n de eventos de seguridad (SEM) proporciona herramientas y funcionalidades en tiempo real o casi para facilitar la gesti칩n de los eventos relacionados con la seguridad, mediante la evaluaci칩n de los eventos y la correlaci칩n de la informaci칩n procedente de diferentes fuentes. Al no depender de una sola fuente de informaci칩n, como lo hacen los IDS / IPS, la funci칩n de gesti칩n de eventos puede ayudar a reducir el n칰mero de falsos positivos, asegurando que el evento que haya sido descubierto se comunique al resto de sistemas. A medida que la base de datos se actualiza se vuelve m치s eficaz y diferencia mejor los incidentes de seguridad de los patrones habituales de eventos.

Las tecnolog칤as avanzadas SEM soportan capacidades de visualizaci칩n de datos, que pueden ayudar al analista de seguridad a evaluar r치pidamente los acontecimientos y tendencias. Las funciones de an치lisis de amenazas y la priorizaci칩n de eventos proporcionan una asistencia extra al personal de operaciones de seguridad, ya que pueden concentrar sus esfuerzos en la investigaci칩n de los eventos que tienen las clasificaciones de amenaza m치s altas.

- **SEM en industria**

Las herramientas y funcionalidades proporcionadas por el gestor de eventos de seguridad son a menudo muy competitivas en el sector industrial. Debido al uso de protocolos propietarios de los elementos industriales, se requiere llevar a cabo un aprendizaje exhaustivo; pero gracias a los pocos cambios ocurridos en la red y su alta estabilidad proporciona una seguridad elevada, al poder detectar f치cilmente cualquier conexi칩n o mensaje fuera de la transmisi칩n habitual entre las m치quinas.

- **Gesti칩n de archivos de eventos**

Las funciones del SIM se caracterizan por el an치lisis de datos en tiempo no real, a trav칠s de la recopilaci칩n y estandarizaci칩n de sistemas dispares y la informaci칩n centralizada de aplicaciones (por ejemplo, eventos del sistema, pistas de auditor칤a, registros de eventos y registros de transacciones).

El analista de seguridad puede consultar el archivo y recuperar informaci칩n a trav칠s de consultas estandarizadas; almacenando la informaci칩n de diferentes sistemas en un solo lugar, de manera cronol칩gica y formalizada.

Las tecnolog칤as avanzadas SIM pueden evaluar estos eventos guardados, a medida que se recogen o bajo demanda, con el fin de examinar comportamientos an칩malos en futuros an치lisis.

El an치lisis forense se favorece por las funciones de gesti칩n de eventos, mientras que los eventos centralizados ayudan a gestionar los tiempos de retenci칩n para cumplir con las leyes y normas aplicables. La capacidad de generaci칩n de informes puede simplificar las evaluaciones internas y los ciclos de auditor칤a de una organizaci칩n.

Los sistemas SIEM proporcionan detecci칩n de eventos por medio de la evaluaci칩n en tiempo real de la informaci칩n y por el an치lisis forense de eventos previamente almacenados.

El funcionamiento para analizar la red se basa en reglas y firmas, aunque tambi칠n dispone de soporte para crear nuevos scripts mediante el lenguaje LUA. Dispone de entradas y salidas estandarizadas a formatos como YAML que le permiten integrarse f치cilmente con otras herramientas como SIEM o bases de datos. Al involucrar a la comunidad de c칩digo abierto y el conjunto de los recursos m치s importantes de reglas IDS/IPS disponible, OISF ha construido el motor Suricata para simplificar el proceso de mantenimiento del nivel de seguridad 칩ptimo. A trav칠s de asociaciones estrat칠gicas, OISF est치 aprovechando la experiencia de Amenazas Emergentes y otros recursos importantes en la industria para proporcionar las reglas m치s actualizadas y completas disponibles.

![SIEM1](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/siem1.png?raw=true)

***Fases en la gesti칩n de amenazas***

**SIM en la industria**

Las funciones de recopilaci칩n de datos son perfectas para los procesos de auditor칤a. Por suerte, los datos registrados por los sensores suelen ser muy homog칠neos en redes donde los equipos no se modifican durante grandes periodos de tiempo. Es f치cilmente detectable cualquier anomal칤a en los protocolos, valores o tiempos, viendo al instante los cambios producidos por posibles ataques a la red.

## **Entendiendo un SIEM**

Los SIEM requieren de una gran cantidad de planificaci칩n antes de que comience la ejecuci칩n, identificaci칩n y prevenci칩n de las violaciones de seguridad. La implementaci칩n suele declararse como desalentadora para gran cantidad de empresas, muchas veces siendo externalizada, por ser dif칤cil de ajustar y puede llevar un tiempo considerable antes de obtener los resultados deseados.

Existen varias razones que podr칤an conducir a una empresa a poner en pr치ctica un SIEM, desde el cumplimiento de una norma de gobierno o de industria, pasando por haber sido la v칤ctima de un ataque cibern칠tico, o tal vez obtener un cierto nivel de seguridad antes de firmar un contrato. Independientemente de la convicci칩n, cuando una compa침칤a se decide a implementar un SIEM, tendr치 que realizar grandes esfuerzos antes de que comience a ver los resultados.

## **Implantaci칩n del SIEM en redes industriales**

La implementaci칩n de un SIEM en una red OT conlleva varias dificultades:

- **Ciclos de vida muy largos:** El problema m치s habitual en los sistemas industriales viene por el ciclo de vida, muchas veces entre 20 y 40 a침os dependiendo del tipo de industria. A침adir elementos de seguridad a la red o a equipo, pueda afectar, modificar o retrasar la se침al de comunicaciones de los PLC u otros equipos, debido a la baja potencia de procesado con la que cuenta. Esto puede conllevar a una problem치tica asociada a la compatibilidad y al funcionamiento entre los equipos de esa red.
- **Prestaciones**: Los ordenadores que se encuentran en las redes industriales, as칤 como los propios dispositivos industriales, suelen ser equipos poco potentes, desfasados y desactualizados, con las capacidades justas para las tareas de control asignadas. Un antivirus moderno, las herramientas IDS/IPS y otras que son necesarias para el procesamiento de los logs, pueden conllevar incompatibilidades, disminuci칩n de potencia los dispositivos o incluso el mal funcionamiento general del sistema.
- **Personal**: Los empleados y t칠cnicos necesarios para la gesti칩n de los SIEM deben tener adem치s los conocimientos suficientes para entender los protocolos y equipos de la red industrial para poder interpretar correctamente los eventos generados.

## **Consideraciones de implantaci칩n de un SIEM**

La implantaci칩n de un SIEM requiere un profundo conocimiento de la topolog칤a de red y de sus protocolos, y de una comprensi칩n clara de lo que se espera que haga. La mejor manera de implantar un SIEM es por medio de sus dos componentes m치s importantes por separado, la gesti칩n de las capacidades de registro y seguimiento por una parte y la respuesta ante las alertas por otra. La primera tarea para la organizaci칩n ser치 conocer que considera como activo cr칤tico y posteriormente se pasar치 al estudio de su protecci칩n.

Algunas compa침칤as disponen de una variedad de eventos que recopilar y procesar de manera diferente. Antes de que el sistema SIEM sea capaz de proporcionar informes 칰tiles, los diversos eventos deber치n ser normalizados para que los datos sean coherentes. Antes de que una empresa pueda sacar el m치ximo provecho de su SIEM, deber치 configurar el sistema para hacer frente a los datos que se recogen en cada tipo de dispositivo, c칩mo y d칩nde se almacenan los datos, y c칩mo los incidentes crean los avisos, adem치s de gestionar el horario, que tambi칠n puede ser condicionante a la hora de generar los avisos.

Cada SIEM tiene su propio conjunto de requisitos para la recopilaci칩n de eventos. Hay muchos tipos de fuentes de eventos, pero syslog y los registros de eventos de Windows generalmente cubren el 75 por ciento o m치s del entorno de una empresa. La seguridad es un proceso y no una operaci칩n t치ctica. Con el fin de obtener los mejores resultados medibles para la inversi칩n en el SIEM deber치n elegir las mejores situaciones para incorporar sus sensores distribuidos por la red.

![SIEM2](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/siem2.png?raw=true)

## **El camino hacia el 칠xito SIEM**

Hacer funcionar correctamente un SIEM para que sea eficiente y efectivo para la empresa requiere de una serie de pasos y medidas a tener en cuenta:

- Recoger los eventos de las fuentes de seguridad est치ndar.
- Enriquecer los eventos con datos suplementarios provenientes de otras fuentes.
- Aplicar inteligencia de global de amenazas (listas negras).
- Correlaci칩n de la informaci칩n recogida.
- Investigar los eventos generados, realizando seguimiento y correcci칩n.
- Documentar las acciones a realizar, los procedimientos operativos est치ndar, acuerdos de nivel de servicio, tickets de problema.
- Incorporar nueva informaci칩n al SIEM mediante la creaci칩n de listas blancas o nuevos contenidos.

<aside>
游눠 En algunos casos, una organizaci칩n podr칤a optar por la gesti칩n externalizada SIEM sobre una empresa especializada en seguridad. En los sistemas IT la gesti칩n se llevar칤a desde las propias instalaciones de la empresa de seguridad, pero en los sistemas OT es m치s com칰n que un t칠cnico o m치s de la empresa de seguridad se desplacen a trabajar conjuntamente en la industria.
</aside>

## **Gesti칩n interna vs externalizada**

El beneficio de SIEM dedicado hace que los datos de la empresa nunca salgan al exterior, la empresa tiene control sobre el hardware y los eventos almacenados. Tienen la capacidad de configurar las correlaciones (reglas), la presentaci칩n de informes, los per칤odos de

retenci칩n, y otros ajustes para satisfacer sus necesidades. Los SIEM administrados internamente, pueden causar problemas en la dotaci칩n de personal o que el personal asignado pueda ser requerido para otros proyectos o funciones.

La gesti칩n de un SIEM requiere una formaci칩n especializada y de unos procedimientos de trabajo normalizados que deben ser creados y mantenidos para cada entorno. Un enfoque fuera de las instalaciones requiere que los eventos se env칤en al administrador, y con esto, se pierde la visibilidad.

Las desventajas a las que un cliente se enfrenta cuando se trata de un SIEM externalizado son: la falta de visibilidad y la incapacidad para moverse entre proveedores y mantener los eventos m치s antiguos. Esta falta de visibilidad provoca problemas con la b칰squeda de nuevas amenazas. Dado que los proveedores de servicios gestionados se suelen especializar en un fabricante de SIEM, son mucho m치s eficientes y por lo general tienen una mayor experiencia para recurrir a operaciones.

## **Capacidades de un SIEM**

- **Agregaci칩n de datos**: SEM / LM (administraci칩n de logs) soluciones para administraci칩n de logs desde muchas fuentes, incluyendo redes, seguridad, servidores, bases de datos, aplicaciones, proporcionando la capacidad de consolidar los datos monitorizados para ayudar a evitar la p칠rdida de los acontecimientos cruciales.
- **Correlaci칩n**: busca atributos comunes y relaciona eventos en paquetes o incidentes. Esta tecnolog칤a realiza t칠cnicas de correlaci칩n para integrar diferentes fuentes, con el fin de convertir los datos en informaci칩n.
- **Alerta**: el an치lisis automatizado de eventos correlacionados y la producci칩n de alertas, que ser치n enviadas al administrador.
- **Cuadros de mando**: SIEM / LM herramienta para transformar los datos y convertirlos en tablas y gr치ficas informativas que ayuden a reconocer patrones o identificar actividades an칩malas.
- **Cumplimiento**: Las aplicaciones SIEM se pueden emplear para automatizar la recopilaci칩n de datos y en la elaboraci칩n de informes adaptados a normativas existentes.
- **Retenci칩n**: SIEM / SIM emplea soluciones a largo plazo de almacenamiento de datos, que constituyen un proceso cr칤tico en la investigaci칩n forense, ya que es poco probable que el descubrimiento de una violaci칩n de la red sea en el instante en el que se produzca.
- **Redundancia**: Los motores de correlaci칩n no requieren ser redundantes, sin embargo, es muy aconsejable que la base de datos si est칠 redundada para no perder informaci칩n.
- **Escalabilidad**: Permitir que el sistema sea configurado jer치rquicamente, de manera que pueda crecer atendiendo a las necesidades.

## **Opciones SIEM basadas en la nube**

Un enfoque que est치 empezando a crecer es el SIEM como un servicio en la nube. Mientras que los proveedores en la nube podr칤an ofrecer programas especiales para los clientes SIEMaaS (SIEM as a Service) por primera vez, los proveedores m치s grandes quieren ofrecer tambi칠n soluciones SIEM. Los proveedores deben reconocer que los eventos son propiedad del cliente, y los clientes tienen que entender que los eventos pueden contener informaci칩n confidencial de la empresa.

Se recomienda que si la empresa recoge datos protegidos, se ha de firmar un acuerdo entre ambos para asegurar que los datos se manejan apropiadamente. A diferencia tradicional, en el software SIEM basado en la nube generalmente se factura en funci칩n del modelo de uso, y no por servidor o por usuario. Sin embargo, si el software SIEM env칤a todos los eventos a la nube, o de lo contrario se configura incorrectamente, el costo del ancho de banda del proveedor de la nube podr칤a ser alto.

Las empresas m치s peque침as pueden encontrar mayores beneficios en la utilizaci칩n de un proveedor de servicios que ofrece seguridad basada en SaaS o un proveedor de servicios de seguridad gestionada (MSSP) que va a proporcionar algunas de las demandas en curso.

## **SIEM Open Source**

Existe una gran multitud de ofertas y opciones, en este estudio nos centraremos en uno de los SIEM m치s conocidos y populares, se trata de Security Onion, desarrollado por Doug Burks, creando una implementaci칩n o uni칩n de todos los programas libres para el trabajo con IDS/IPS de una forma muy sencilla de instalar, permitiendo instalar software de terceros como Splunk por medio de aplicaciones.

Existen otros muchos SIEM, tambi칠n efectivos contra amenazas, pero pueden llevar asociados costes o quiz치 puedan ser menos usados. Por hablar de otras posibilidades, tenemos a modo de ejemplo:

- AlienVault Open Source SIEM (OSSIM), [https://www.alienvault.com/products/ossim](https://www.alienvault.com/products/ossim)
- EMC RSA Security Analytics, [http://spain.emc.com/security/security-analytics/security-analytics.htm](http://spain.emc.com/security/security-analytics/security-analytics.htm)
- HP ArcSight Enterprise Security Manager (ESM), [http://www8.hp.com/es/es/software-solutions/arcsight-esm-enterprise-security-management/](http://www8.hp.com/es/es/software-solutions/arcsight-esm-enterprise-security-management/)
- IBM Security QRadar SIEM, [http://www-03.ibm.com/software/products/es/qradar-siem](http://www-03.ibm.com/software/products/es/qradar-siem)
- LogRhythm Security Intelligence Platform, [https://logrhythm.com/es/](https://logrhythm.com/es/)
- McAfee Enterprise Security Manager, [http://www.mcafee.com/es/products/enterprise-security-manager.aspx](http://www.mcafee.com/es/products/enterprise-security-manager.aspx)
- SolarWinds Log & Event Manager, [http://www.solarwinds.com/log-event-manager](http://www.solarwinds.com/log-event-manager)
- Splunk Enterprise, [https://www.splunk.com/en_us/products/splunk-enterprise.html](https://www.splunk.com/en_us/products/splunk-enterprise.html)
- Lookwise Enterprise Manager, [http://www.lookwisesolutions.com/index.php/es/productos/lookwise-enterprise-manager](http://www.lookwisesolutions.com/index.php/es/productos/lookwise-enterprise-manager)
- Graylog 2, [https://www.graylog.org/](https://www.graylog.org/)
- LOGanalize, [http://loganalyzer.adiscon.com/](http://loganalyzer.adiscon.com/)