# Enumeraci√≥n y explotaci√≥n de vulnerabilidades

## **Enumeraci√≥n web con WPScan**

WPScan se lanz√≥ por primera vez en 2011, ha sobrevivido al tiempo y se destac√≥ como una herramienta vital que todo pentester deber√≠a tener en su caja de herramientas.

WPScan es capaz de enumerar e investigar algunas categor√≠as de vulnerabilidades de seguridad presentes en los sitios de WordPress como:

- Divulgaci√≥n de informaci√≥n confidencial (versiones de instalaci√≥n de complementos y temas para vulnerabilidades reveladas o CVE)
- Descubrimiento de ruta (buscando permisos de archivos mal configurados)
- Pol√≠ticas de contrase√±as d√©biles (fuerza bruta de contrase√±as)
- Presencia de instalaci√≥n predeterminada (buscando archivos predeterminados)
- Prueba de firewalls de aplicaciones web (complementos WAF comunes)

### **Instalaci√≥n:**

Afortunadamente, WPScan viene preinstalado en la √∫ltima versi√≥n de Kali Linux y Parrot OS. Si est√° utilizando una versi√≥n anterior de Kali, simplemente puede instalarla desde el siguiente comando en su terminal.

> sudo apt update && sudo apt install wpscan

![WPScan1](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/wpscan1.png?raw=true)

Si est√° utilizando diferentes sistemas operativos y otras distribuciones, puede consultar la documentaci√≥n del [desarrollador](https://github.com/wpscanteam/wpscan#install) y aprender c√≥mo instalarlo en su m√°quina.

**Base de datos de WPScan:**

WPScan utiliza informaci√≥n dentro de una base de datos local como punto de referencia principal al enumerar temas y complementos. Antes de utilizar WPScan, se recomienda encarecidamente que actualice esta base de datos antes de realizar cualquier an√°lisis.

Para actualizar su base de datos wpscan, simplemente ejecute este comando en su terminal

> wpscan --update

![WPScan2](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/wpscan2.png?raw=true)

### **Enumeraci√≥n de temas:**

WPS puede tener algunas formas de determinar el tema instalado en el sitio. B√°sicamente, primero utiliza una t√©cnica que tambi√©n podemos hacer manualmente. Simplemente podemos mirar los activos de las cargas del navegador web y luego buscar la ubicaci√≥n del tema instalado en el servidor web. Usando la pesta√±a "Red" en su navegador web, puede ver qu√© archivos se cargan cuando visita ese sitio.

![WPScan3](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/wpscan3.png?raw=true)

Arriba podemos ver una captura de pantalla donde se han cargado muchos archivos y mientras los revisaba encontr√© esta URL

[http://www.anywordpressintalledsite.com/wp-content/themes/twentynineteen](http://www.anywordpressintalledsite.com/wp-content/themes/twentynineteen)

Al mirar esta URL podemos estar seguros de que el tema instalado es twentynineteen. Ahora automaticemos nuestro trabajo, usemos nuestro wpscan para descubrir qu√© tema exacto se est√° ejecutando escribiendo el siguiente comando

> wpscan --url http://www.anywordpressintalledsite.com/ --enumerate t
> 

y aqu√≠ esta el resultado:

![WPScan4](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/wpscan4.png?raw=true)

Lo mejor de¬† wpscan es que le dice c√≥mo descubri√≥ ese resultado.

![WPScan5](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/wpscan5.png?raw=true)

### **Enumeraci√≥n de complementos:**

una caracter√≠stica muy com√∫n del servidor web es la lista de directorios, es como el comando **ls** en Linux. Enumera los archivos y directorios enumerados en ese servidor web. El ‚ÄúListado de directorios‚Äù ocurre cuando no hay ning√∫n archivo presente que se le haya indicado al servidor web que procese. Un archivo muy com√∫n es ‚Äúindex.html‚Äù e ‚Äúindex.php‚Äù. Como estos archivos no est√°n presentes en el directorio /a/, se muestran los contenidos:

![WPScan6](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/wpscan6.png?raw=true)

wpscan puede aprovechar esta funci√≥n para averiguar qu√© complementos est√°n instalados. Dado que todos estar√°n ubicados en /wp-content/plugins/pluginname, WPScan puede enumerar complementos comunes/conocidos. Podemos usar el siguiente comando para enumerar complementos.

> wpscan --url http://www.anywordpressintalledsite.com/ --enumerate p
> 

Al leer la documentaci√≥n para desarrolladores de WordPress, podemos aprender sobre el "[read me](https://developer.wordpress.org/plugins/wordpress-org/how-your-readme-txt-works/#how-the-readme-is-parsed)" para descubrir c√≥mo WPScan determin√≥ el n√∫mero de versi√≥n. Simplemente, los complementos deben tener un archivo ‚ÄúREADME.txt‚Äù. Este archivo contiene metainformaci√≥n como el nombre del complemento, las versiones de WordPress con las que es compatible y una descripci√≥n.

![WPScan7](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/wpscan7.png?raw=true)

### **Enumeraci√≥n de usuarios:**

Despu√©s de leer todo esto, creo que se dar√° cuenta de lo poderosa que es esta herramienta. Entonces, si te digo que tambi√©n podemos enumerar usuarios usando esta herramienta, no te sorprender√°. La forma en que WPScan enumera a los usuarios es interesantemente simple. Los sitios de WordPress utilizan autores para las publicaciones. Los autores son de hecho un tipo de usuario.

![WPScan8](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/wpscan8.png?raw=true)

Usemos nuestro wpscan para escanear a los usuarios y ¬øc√≥mo podemos hacerlo exactamente? simple siguiendo el comando dado

> wpscan --url http://www.anywordpressintalledsite.com/ --enumerate u

![WPScan9](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/wpscan9.png?raw=true)

Arriba podemos ver que encontr√≥ al usuario pero dice algo de fuerza bruta. s√≠, tambi√©n puede hacer eso. wpscan puede aplicar fuerza bruta usando una lista mundial. ¬øDespu√©s de eso dice error de inicio de sesi√≥n? s√≠, intent√≥ iniciar sesi√≥n con ese nombre de usuario y descubri√≥ que el usuario es real.

![WPSca10](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/wpscan10.png?raw=true)

**La bandera "Vulnerable":**

hasta ahora solo hemos enumerado temas, complementos y usuarios y luego visitaremos sitios como MITRE, NVD y CVEDetails para buscar los nombres de estos complementos y los n√∫meros de versi√≥n para determinar cualquier vulnerabilidad. Lo cual lleva bastante tiempo y es aburrido. Es por eso que wpscan tiene un indicador espec√≠fico para hacer nuestro trabajo y ese indicador es -v. Para comprobar si alg√∫n complemento instalado es vulnerable o no, podemos escribir este comando y averiguarlo.

> wpscan --url http://www.anywordpressintalledsite.com/ --enumerate vp

Arriba dije -v flag pero escrib√≠ vp. ¬øComet√≠ un error? No, esa p significa complemento para que pueda indicarle a wpscan que verifique los complementos si son vulnerables o no.

![WPSca11](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/wpscan11.png?raw=true)

Obtuvimos nuestros resultados en solo unos segundos y descubrimos que los complementos no son vulnerables.

### **Ataque de contrase√±a:**

Despu√©s de determinar una lista de posibles nombres de usuario en la instalaci√≥n de WordPress, podemos usar WPScan para realizar una t√©cnica de fuerza bruta contra el nombre de usuario que especificamos y una lista de contrase√±as que proporcionamos. Simplemente, usamos el resultado de nuestra enumeraci√≥n de nombre de usuario para crear un comando como este:

> wpscan --url http://www.anywordpressintalledsite.com/ ‚Äì-passwords rockyou.txt ‚Äì-usernames Phreakazoid

![WPSca12](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/wpscan12.png?raw=true)

### Ajuste de la agresividad de WPScan (WAF):

a menos que se especifique, WPScan intentar√° ser lo menos "ruidoso" posible. Muchas solicitudes a un servidor web pueden activar cosas como firewalls y, en √∫ltima instancia, provocar que el servidor lo bloquee.

Esto significa que nuestro WPScan puede omitir algunos complementos y temas. Afortunadamente, podemos usar argumentos como --plugins-detectiony un perfil de agresividad (pasivo/agresivo) para especificar esto. Por ejemplo:--plugins-detection aggressive

### **Resumen - Hoja de referencia:**

> p Enumerate Plugins --enumerate p

> t¬†Enumerate Themes --enumerate t

> u Enumerate Usernames --enumerate -u

> v¬† check if plugin is vulnerable¬† --enumerate vp

> aggressive adjust aggressiveness --plugins-detection aggressive
 

## **Enumeraci√≥n web usando Gobuster**

### **Enumeraci√≥n manual**

Cuando comienza su enumeraci√≥n web, la mejor herramienta que puede utilizar es su navegador favorito. El m√≠o es Firefox, as√≠ que puedes usar el tuyo como Chrome, Opera y Brave tambi√©n es bastante bueno. Mantiene un registro de los datos que recibe y de qui√©n. Podemos usar esto para una variedad de actividades: encontrar esa foto exacta o, m√°s √∫tilmente, la ubicaci√≥n de ciertos archivos o activos que se est√°n cargando. Esto podr√≠a incluir cosas desde scripts hasta URL de p√°ginas.

### **Usando nuestra consola de desarrollador de navegadores**

Los navegadores, incluidos Chrome y Firefox, tienen un conjunto de herramientas ubicadas en "Herramientas de desarrollo/Consola". Vamos a hablar de Firefox, sin embargo, Chrome tiene una suite muy similar. Esta suite incluye una gama de herramientas que incluyen:

- Ver el c√≥digo fuente de la p√°gina
- Encontrar activos
- Depuraci√≥n y ejecuci√≥n de c√≥digo como javascript en el lado del cliente (nuestro navegador)

Usando "F12" en nuestro teclado, este es un atajo para iniciar este conjunto de herramientas.

![WPSca13](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/wpscan13.png?raw=true)

En la imagen de arriba puede ver el encabezado de la p√°gina Hola mundo y all√≠ abajo puede ver que la herramienta "inspector" de la secci√≥n est√° abierta. Esto nos permite ver el c√≥digo fuente html de la p√°gina web. A menudo contiene cosas como comentarios de desarrolladores y el nombre de ciertos aspectos de las caracter√≠sticas de la p√°gina web, incluidos formularios y me gusta.

Los desarrolladores suelen dejar comentarios en forma de **<! ‚Äî ‚Üí** etiquetas‚Ä¶por ejemplo: <! ‚Äî Este es un comentario ‚Üí que no se muestra en el navegador como podemos ver aqu√≠:

![WPSca14](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/wpscan14.png?raw=true)

## **Gobuster**

Gobuster es una de las mejores herramientas que existen para enumerar sitios web y por web me refiero a directorios, DNS, subdominios y mucho m√°s. Puede obtener m√°s informaci√≥n y el c√≥digo fuente [aqu√≠](https://github.com/OJ/gobuster) .

**Comencemos con c√≥mo instalar Gobuster en Kali Linux:**

Puede instalar gobuster usando el siguiente comando en su terminal.

> sudo apto instalar gobuster

**Flags**

> - t --threads¬†No. de subprocesos simult√°neos
> - v --verbose Salida detallada
> - z --no-progress No mostrar el progreso
> - q --quiet No imprimir el banner y el ruido
> - o -- salida Archivo de salida para escribir los resultados

Normalmente cambiar√© la cantidad de subprocesos a 64 para aumentar la velocidad de mis escaneos. Si no cambia la cantidad de subprocesos, Gobuster puede ser un poco lento.

## **Modos Gobuster**

Gobuster es una herramienta muy poderosa y vers√°til. Tiene diferentes modos para hacer diferentes cosas, como el modo dir se usa cuando busca directorios web en una aplicaci√≥n web y el modo dns se usa cuando busca subdominios.

### **Modo ‚Äúdir‚Äù:**

podemos adivinar qu√© hace este modo, ya que su nombre lo indica se utiliza para forzar directorios en aplicaciones web. Es una herramienta muy poderosa que no solo escanea el sitio web sino que tambi√©n devuelve su c√≥digo de estado y esto le permitir√° saber inmediatamente si usted, como usuario externo, puede solicitar ese directorio o no. La funcionalidad adicional de Gobuster es que tambi√©n te permite buscar archivos con la adici√≥n de una simple bandera.

- **Usando el modo dir** :

Para usar el modo dir, escriba el siguiente comando

> gobuster dir

Este no es el comando completo pero le dice al gobuster que el usuario desea buscar directorios en web. Ahora, despu√©s de esto, tendr√°s que agregar la URL y la lista de palabras.

> gobuster dir -u [http://](https://google.com/)10.10.10.10 -w wordlist.txt

**Nota** : La URL ser√° la ruta base desde donde Gobuster comienza a buscar. Entonces, la URL anterior utiliza el directorio web ra√≠z. Por ejemplo, en una instalaci√≥n t√≠pica de Apache en Linux, esto es */var/www/html* . ***[Entonces ,](http://10.10.10.10/products.)*** si tiene un directorio de " **productos** " y desea enumerar ese directorio, debe configurar la URL como *[http://10.10.10.10/productos* .](http://10.10.10.10/products.) Tambi√©n puedes pensar en esto como *[http://example.com/path/to/folder* .](http://example.com/path/to/folder.) Observe tambi√©n que especifiqu√© el protocolo HTTP. Esto es importante y necesario.

**Otras banderas √∫tiles:**

> - c --cookies¬†Cookies que se usar√°n en las solicitudes
> - x --extensions Extensi√≥n(es) de archivo a buscar
> - H --headers Especifique encabezados HTTP, -H 'Encabezado1: val1'
> - k --no-tls -validation Omitir la verificaci√≥n del certificado TLS
> - n --no-status No imprimir c√≥digos de estado
> - P --password Contrase√±a para autenticaci√≥n b√°sica
> - s --status-codes C√≥digos de estado positivos
> - b --status-codes-blacklist C√≥digos de estado negativos
> - U --username Nombre de usuario para autenticaci√≥n b√°sica

aqu√≠ -x o - el indicador de extensiones es realmente √∫til para buscar archivos con una extensi√≥n espec√≠fica.

> gobuster dir -u http://10.10.10.10 -w wordlist.txt -x html,php,bak

En el comando anterior especificamos buscar solo aquellos archivos que tengan extensi√≥n .html, .php, .bak. El indicador -k es especial porque tiene un uso importante durante las pruebas de penetraci√≥n y captura los eventos del indicador. En una sala de captura de bandera en TryHackMe, por ejemplo, si HTTPS est√° habilitado, lo m√°s probable es que encuentre un error de certificado no v√°lido como el siguiente

![WPSca15](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/wpscan15.png?raw=true)

Si ejecuta gobuster en este sitio sin -k flag gobuster aparecer√° un error largo, as√≠ que para evitar este tipo de certificaciones no v√°lidas y brindarle sus resultados, use -k falg en su comando.

### **Modo ‚Äúdns‚Äù:**

el siguiente modo en el que nos centraremos es el modo ‚Äúdns‚Äù. Esto permite a Gobuster aplicar fuerza bruta a subdominios. Durante una prueba de penetraci√≥n (o capturar la bandera), es importante verificar los subdominios del dominio principal de su objetivo. Los subdominios aumentan su alcance, por lo que un alcance mayor tiene mayores posibilidades de encontrar una vulnerabilidad.

- **Usando el modo ‚Äúdns‚Äù:**

Puede usar el modo dns escribiendo el siguiente comando en su terminal

> gobuster dns 

Como modo directorio, este comando est√° incompleto, esto le indicar√° al gobuster que el usuario desea realizar fuerza bruta en el subdominio, por lo que debe especificar nuevamente un dominio y un archivo de lista de palabras.

> gobuster dns -d mydomain.com -w subdomains.txt

Este comando le dice a gobuster que realice una fuerza bruta en un subdominio en midominio.com

Otras falgs √∫tiles:

> -c --show-cname Mostrar registros CNAME (no se puede usar con '-i')
> - i --show-ips Mostrar direcciones IP
> - r --resolverUsar servidor DNS personalizado

### **Modo vhost:**

El √∫ltimo modo en el que nos centraremos es el modo ‚Äúvhost‚Äù. Esto permite a Gobuster aplicar fuerza bruta a hosts virtuales. Los hosts virtuales son diferentes sitios web en la misma m√°quina. En algunos casos, pueden parecer subdominios, ¬°pero no te dejes enga√±ar! Los hosts virtuales est√°n basados ‚Äã‚Äãen IP y se ejecutan en el mismo servidor. Esto no suele ser evidente para el usuario final. En un compromiso, puede que valga la pena ejecutar Gobuster en este modo para ver si se le ocurre algo. ¬°Nunca se sabe, puede que encuentre algo! Al participar en salas de TryHackMe, los hosts virtuales ser√≠an una buena manera de ocultar un sitio web completamente diferente si no apareciera nada en el escaneo del puerto principal 80/443.

**Usando el modo vhost:**

como dir y dns, simplemente puede escribir el siguiente comando y ejecutar el modo vhost en gobuster:

> gobuster vhost

Esto notifica al gobuster que el usuario desea aplicar fuerza bruta a los hosts virtuales en la URL de destino. Despu√©s de esto, debes proporcionar una URL y un archivo de lista de palabras.

> gobuster vhost -u [http://10.10.10.10](http://10.10.10.10/) -w wordlist.txt

**Otras banderas √∫tiles:**

Puedes ver su bandera y otra documentaci√≥n en la [documentaci√≥n oficial.](https://github.com/OJ/gobuster#vhost-mode-options)

**Listas de palabras predeterminadas de Kali Linux:**

estas son las listas de palabras predeterminadas que vienen preinstaladas en Kali Linux. Mencionar√© las listas de palabras uso para realizar fuerza bruta de directorios en Kali Linux.

- /usr/share/wordlists/dirbuster/directory-list-2.3-*.txt
- /usr/share/wordlists/dirbuster/directory-list-1.0.txt
- /usr/share/listas de palabras/dirb/big.txt
- /usr/share/wordlists/dirb/common.txt
- /usr/share/listas de palabras/dirb/small.txt
- /usr/share/wordlists/dirb/extensions_common.txt: ¬°√∫til para buscar archivos!

/usr/share/wordlists tiene muchas listas de palabras para diferentes tareas. Puedes ir all√≠ y comprobarlas todas vos mismo.

**Listas no est√°ndar:**

adem√°s de lo anterior, Daniel Miessler ha creado un incre√≠ble repositorio de GitHub llamado [SecLists](https://github.com/danielmiessler/SecLists) . Compila muchas listas diferentes utilizadas para muchas cosas diferentes. ¬°La mejor parte es que est√° en apto! simplemente puede instalar todas esas listas de palabras en su kali usando el siguiente comando:

> sudo apt install seclists

En estas dos listas de palabras creo que obtendr√°s todo tipo de listas mundiales para hacer tu trabajo de fuerza bruta.

## **Burp Suite: enumeraci√≥n de p√°ginas web y pruebas de vulnerabilidad**

**¬øQu√© es Burp Suite?**

Burp Suite es una plataforma integral para pruebas de seguridad de aplicaciones web. Se puede utilizar para enumeraciones y an√°lisis detallados de aplicaciones web. La herramienta puede simplemente interceptar solicitudes HTTP/S y actuar como intermediario entre el usuario y los sitios. Los detalles necesarios se capturan del sitio web a medida que el usuario navega. Esta informaci√≥n proporciona informaci√≥n sobre la seguridad de una aplicaci√≥n web. *Burp puede actuar como intermediario interceptando el tr√°fico desde su navegador a una p√°gina web, permiti√©ndole modificar y automatizar cambios en las solicitudes de la p√°gina web.*

Al abrir Burp, te encuentras con un proyecto en blanco con un mont√≥n de pesta√±as. No te preocupes, cubriremos las pesta√±as esenciales.

### **Configuraci√≥n de la suite Burp**

Confirme que el oyente Burp Proxy est√© activo

- Abra burp y navegue hasta la pesta√±a proxy ‚Üí opciones
- Verifique que el detector de proxy est√© activo y configurado en 127.0.0.1:8080

Configurar proxy en el navegador web

- Para Firefox, navegue a preferencias ‚Üí avanzado ‚Üí red ‚Üí configuraci√≥n
- Active *la configuraci√≥n manual de proxy: verifique que est√© configurado en el mismo proxy que burp (127.0.0.1 en el puerto 8080).*

![WPSca16](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/wpscan16.png?raw=true)

### **Instalaci√≥n del certificado SSL Burp**

- Navegue hasta [http://burp](http://burp/) y descargue el certificado haciendo clic en *Certificado CA* a la derecha.
- Regrese a la p√°gina de configuraci√≥n de seguridad de la red en Firefox y haga clic en *Certificados*
- Desde all√≠, importe el certificado que descarg√≥ y marque todas las casillas.

![WPSca17](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/wpscan17.png?raw=true)

### **Caracter√≠sticas b√°sicas**

Para comenzar, familiaric√©monos con algunas de las pesta√±as comunes disponibles en Burp Suite: Intruso, Repetidor y Secuenciador.

**Intruder**

Con Burp Intruder, se pueden automatizar ataques personalizados contra aplicaciones web. La personalizaci√≥n de ataques requiere que especifiquemos una o m√°s cargas √∫tiles y la posici√≥n donde se colocar√°n en el sitio web.

- Casos de uso: enumeraci√≥n de identificadores, recopilaci√≥n de datos √∫tiles y b√∫squeda de vulnerabilidades.

**Repeater**

- El repetidor se puede utilizar para repetir solicitudes HTTP individuales manipuladas manualmente. Esto resulta tremendamente √∫til cuando se prueban varias cargas √∫tiles en la misma solicitud. Con el repetidor puedes probar par√°metros en la misma p√°gina sin hacer ning√∫n trabajo adicional con el navegador. Emitir solicitudes en una secuencia espec√≠fica se vuelve mucho m√°s f√°cil y puede identificar c√≥mo reacciona la p√°gina a los par√°metros cambiantes en cada paso.
- Casos de uso: probar un conjunto de par√°metros espec√≠ficos en la misma solicitud de p√°gina web y volver a emitir solicitudes para verificar manualmente los problemas informados.

**Sequencer**

- El secuenciador Burp se puede utilizar para analizar la calidad de la aleatoriedad en una muestra de elementos de datos. En √∫ltima instancia, esto significa que el secuenciador es bueno para probar elementos de datos que deben ser impredecibles.
- Casos de uso: prueba de tokens anti-CSRF o tokens de restablecimiento de contrase√±a, etc.

### **Ejemplo de explotaci√≥n de vulnerabilidad con Burp**

Burp Suite nos brinda herramientas de automatizaci√≥n adicionales para usar mientras probamos una aplicaci√≥n web. Para practicar el ataque a vulnerabilidades utilizaremos la **[aplicaci√≥n web Damn Vulnerable (DVWA)](http://www.dvwa.co.uk/)** . **DVWA** viene precargado con Metasploitable 2 pero tambi√©n se puede descargar de forma independiente y ejecutar desde un servidor local. **DVWA** est√° separado para ataques espec√≠ficos, como se ve en su barra de navegaci√≥n lateral. Esto nos brinda la oportunidad de explorar ataques web comunes en distintos niveles de dificultad.

Una vez que **DVWA** est√© en funcionamiento, inicie sesi√≥n y navegue hasta la pesta√±a de seguridad para cambiar el nivel de seguridad a bajo. Esto har√° que el sitio web sea vulnerable a una gama m√°s amplia de ataques, lo que har√° que sea m√°s f√°cil sentirse c√≥modo con una nueva herramienta.

**Fuerza bruta en una p√°gina de inicio de sesi√≥n**

Para este ejemplo usaremos Intruder de Burp para alterar la solicitud HTTP para la p√°gina de inicio de sesi√≥n dentro de **DVWA** .

- Comience iniciando sesi√≥n en **DVWA** usando el nombre de usuario " *admin* " y la contrase√±a "*password*".
- Verifique que la seguridad de **DVWA** est√© baja para este ataque. Unos niveles de seguridad m√°s altos impedir√°n que este ataque funcione.
- Navega a la secci√≥n *Fuerza Bruta* de la navegaci√≥n lateral. Aqu√≠ ver√° cuadros de entrada para nombre de usuario y contrase√±a.
- Al pasar las credenciales incorrectas aparecer√° un error.

![WPSca18](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/wpscan18.png?raw=true)

Intento de nombre de usuario: admin y contrase√±a: 1234, lo que arroj√≥ un error. Supongamos que conocemos el nombre de usuario del usuario que inici√≥ sesi√≥n en el sitio. Podemos usar Burp para interceptar solicitudes e intentar obtener una lista de contrase√±as en esta p√°gina de inicio de sesi√≥n.

Muestra que el nombre de usuario y la contrase√±a se pasan en la URL

- Haga clic derecho en la secci√≥n sin formato y *Enviar a Intruso*
- Desde la pesta√±a *Intruso ‚Üí Posiciones* podemos seleccionar los par√°metros que queremos modificar en nuestra solicitud. Desde el principio se seleccionan todas las entradas posibles. Presione el bot√≥n borrar a la derecha para borrar las selecciones.
- Resalte el valor de la contrase√±a. En mi caso, la contrase√±a inicial ingresada fue "1234". Seleccione ese valor y presione el bot√≥n Agregar a la derecha.

![WPSca19](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/wpscan19.png?raw=true)

Se podr√≠an realizar m√°s selecciones para modificar m√°s valores en cada solicitud.

- La √∫ltima parte de este ataque es agregar una carga √∫til para modificar el valor de la contrase√±a que seleccionamos.
- Vaya a la pesta√±a *Cargas √∫tiles* . El conjunto de carga √∫til permanecer√° como una lista simple y a continuaci√≥n agregaremos valores a una lista para que Burp los use en su carga √∫til.
- La siguiente imagen muestra las contrase√±as adivinadas agregadas a la carga √∫til para que Burp las pruebe. La lista de contrase√±as comunes se puede descargar en l√≠nea para utilizarla en intentos de fuerza bruta m√°s extensos.
- Haga clic en *Iniciar ataque* para iniciar el ataque.

![WPSca20](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/wpscan20.png?raw=true)

- Deber√≠a aparecer una nueva ventana mostrando los resultados de Intruder.

![WPSca21](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/wpscan21.png?raw=true)

- ¬øC√≥mo sabemos si funcion√≥? Observar la longitud nos dice que cuando la carga √∫til es "password", obtenemos un resultado diferente al de los otros env√≠os. Eso significa que deber√≠amos examinar m√°s de cerca ese valor.
- Al hacer clic en la fila, aparecer√°n acciones adicionales en la parte inferior de la ventana.
- Pasar a la pesta√±a *Renderizar* nos mostrar√° el resultado cuando se ingrese esa carga √∫til espec√≠fica.

![WPSca22](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/wpscan22.png?raw=true)

- Como puede ver, la contrase√±a funcion√≥ y se nos muestra una p√°gina de inicio de sesi√≥n v√°lida. Esto se puede verificar yendo a **DVWA** y probando administrador y contrase√±a como valores de inicio de sesi√≥n. El mismo resultado deber√≠a aparecer.

![WPSca24](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/wpscan24.png?raw=true)

¬°Felicidades! Ya ha completado su primer ataque utilizando Burp para modificar las solicitudes HTTP. Este es un ejemplo sencillo de c√≥mo se puede utilizar Burp para realizar pruebas de seguridad de aplicaciones. Existen muchos m√°s ataques a aplicaciones web. Burp Suite proporciona herramientas adicionales para solucionar ataques, ya sea de forma manual o automatizada. Profundizar en Burp Suite revelar√° cu√°n poderoso puede ser realmente.

### **¬øQu√© sigue?**

- Consulte tutoriales de ataques adicionales en el sitio web de Burp Suite para familiarizarse con el papel de Burp en ataques m√°s intensivos.
- Utilice Burp para realizar ataques web comunes a otra aplicaci√≥n web vulnerable, como [Mutillidae](https://www.owasp.org/index.php/OWASP_Mutillidae_2_Project) o el [proyecto OWASP WebGoat](https://www.owasp.org/index.php/Category:OWASP_WebGoat_Project) .
- Contin√∫e usando Burp en su pr√≥ximo flujo de trabajo de prueba de aplicaciones web y juegue con una extensi√≥n de terceros para Burp para agregar m√°s funciones.
- Actualice a la versi√≥n Pro para comprobar las capacidades de escaneo de vulnerabilidades de Burp Suite. Si el precio de Pro parece demasiado elevado, entonces OWASP Zap es una alternativa gratuita a Burp que permite escanear vulnerabilidades.

### Recursos adicionales

- [La metodolog√≠a Burp](https://support.portswigger.net/customer/portal/articles/2326039-the-burp-methodology-) : tutoriales proporcionados por Burp Suite
- [Burp Suite para la seguridad de aplicaciones web](https://vimeo.com/album/3510171) : tutoriales en v√≠deo de Bucky Roberts

## **Nuclei: Automatizaci√≥n de pruebas de servicios de red y aplicaciones web**

Nuclei es un marco de c√≥digo abierto dise√±ado para automatizar la detecci√≥n y explotaci√≥n de vulnerabilidades en aplicaciones web y otros servicios de red. Permite a los pentester e investigadores de seguridad definir plantillas personalizadas que especifican un conjunto de solicitudes HTTP para enviar a un objetivo, junto con las reglas de coincidencia correspondientes que pueden usarse para identificar vulnerabilidades o configuraciones incorrectas.

### **Instalaci√≥n**

Para instalar Nuclei, puedes descargar la √∫ltima versi√≥n desde el repositorio oficial de [GitHub](https://github.com/projectdiscovery/nuclei) y seguir las instrucciones.

### **Hoja de trucos**

Aqu√≠ hay una hoja de trucos completa con algunos comandos de Nuclei com√∫nmente utilizados para la b√∫squeda de recompensas por errores:

> 1. Mostrar informaci√≥n de ayuda
>  
> nuclei -h
> 
> 2. Mostrar la versi√≥n actual de Nuclei
> 
> nuclei -version
> 
> 3. Cargar una lista de objetivos desde un archivo
> 
> nuclei -l target.txt -t ~ /nuclei-templates/
> 
> 4. Especificar un √∫nico objetivo para probar
> 
> nuclei -t https: // ejemplo.com -t ~ /nuclei-templates/
> 
> 5. Especifique una URL para probar
> 
> los n√∫cleos -u https: // ejemplo.com -t ~ /nuclei-templates/
> 
> 6. Ejecute n√∫cleos en modo silencioso (suprima la salida)
> 
> n√∫cleos -silent -t https: // ejemplo.com -t ~ /nuclei-templates/
> 
> 7. Especifica el n√∫mero de subprocesos simult√°neos para usar
> 
> n√∫cleos -c 10 -t https: // ejemplo.com -t ~ /nuclei-templates/
> 
> 8. Omitir plantillas que requieren
> 
> n√∫cleos de autenticaci√≥n - no -verify -t https: // ejemplo.com -t ~ /nuclei-templates/
> 
> 9. Personaliza el formato de salida del informe de
> 
> n√∫cleos nuclei -o output.txt -t https: // ejemplo. com -t ~ /nuclei-templates/
> 
> 10. Ignorar errores de certificado SSL
> 
> nuclei -insecure -t https: // ejemplo.com -t ~ /nuclei-templates/
> 
> 11. Especificar un encabezado HTTP personalizado para incluir en las solicitudes
> 
> nuclei -headers "Autorizaci√≥n: Bearer TOKEN" -t https: // ejemplo.com -t ~ /nuclei-templates/
> 
> 12. Especifique una cadena de agente de usuario personalizada para incluir en las solicitudes
> 
> nuclei -user-agent "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, como Gecko) Chrome/58.0.3029.110 Safari/537.3" -t https: // ejemplo.com -t ~ /nuclei-templates/
> 

<aside>
üëâ Estos comandos deber√≠an ayudarlo a comenzar a ejecutar Nuclei y personalizar sus pruebas de acuerdo con sus necesidades espec√≠ficas. Es importante tener en cuenta que Nuclei admite muchos m√°s comandos y opciones adem√°s de estos, as√≠ que aseg√∫rese de consultar la documentaci√≥n oficial para obtener m√°s informaci√≥n.
</aside>

### **Plantillas**

Para crear una plantilla para Nuclei, siga estos pasos:

1. Elija un objetivo para probar, como una aplicaci√≥n web o un servicio de red.
2. Identifique una vulnerabilidad o configuraci√≥n incorrecta que desee probar.
3. Utilice el lenguaje de plantilla de Nuclei para definir la prueba. El lenguaje de plantilla se basa en la sintaxis YAML y admite una amplia gama de funciones, como solicitudes HTTP, coincidencia de respuestas y variables. Consulte la documentaci√≥n de Nuclei para obtener m√°s informaci√≥n sobre el lenguaje de la plantilla y sus caracter√≠sticas.
4. Guarde la plantilla en un archivo con una extensi√≥n .yaml. Se recomienda guardar las plantillas en una carpeta dentro del directorio de plantillas de Nuclei para facilitar su administraci√≥n y organizaci√≥n.
5. Pruebe la plantilla ejecutando Nuclei con la bandera -t y especificando la ruta al archivo de plantilla. Por ejemplo:

> n√∫cleos -t https://example.com -t ~/nuclei-templates/my-template.yaml

Analice el resultado para determinar si la prueba fue exitosa y si se identific√≥ alguna vulnerabilidad o configuraci√≥n incorrecta. Realice cambios en la plantilla seg√∫n sea necesario y repita el proceso de prueba hasta lograr los resultados deseados.

- *Recuerde probar sus plantillas de manera cuidadosa y responsable, y siempre obtenga el permiso del objetivo antes de realizar cualquier pentest.*

### **Script de inyecci√≥n SQL de plantilla de n√∫cleos personalizados con explicaciones :**

> id: example-template¬†# A unique identifier for the template

> info:¬† # Information about the template

> name: Example Template

> author: Your Name

> severity: low

> requests:¬† # List of HTTP requests to send

> method: GET¬† # HTTP method (GET, POST, etc.)

> path: /¬† # Request path

> headers:¬† # Optional request headers

> User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64)

> matchers:  # List of matchers to apply to the response

> type: word  # Matcher type (word, status, regex, etc.)

> words: "Example"¬† # Keyword to search for in the response

> attacks:  # Optional list of attack payloads to send

> - payload: "' OR true--"

### **Explicaci√≥n:**

- id: un identificador √∫nico para la plantilla que se puede utilizar para hacer referencia a ella en argumentos de l√≠nea de comandos y otras plantillas.
- info: metadatos sobre la plantilla, como el nombre, el autor y la gravedad de las vulnerabilidades o configuraciones incorrectas que prueba.
- requests: una lista de solicitudes HTTP para enviar al destino. Esta secci√≥n define el m√©todo HTTP, la ruta, los encabezados y otros atributos de las solicitudes. Las solicitudes se pueden personalizar a√∫n m√°s con variables, credenciales de autenticaci√≥n y otras caracter√≠sticas.
- matchers: Una lista de comparadores para aplicar a la respuesta de las solicitudes. Los comparadores definen c√≥mo buscar patrones o palabras clave espec√≠ficos en el cuerpo o los encabezados de la respuesta. Nuclei admite varios tipos de comparadores, como palabras, expresiones regulares, estados y binarios.
- attacks: una lista opcional de cargas √∫tiles de ataque para enviar las solicitudes. Estas cargas √∫tiles se pueden utilizar para probar vulnerabilidades como inyecci√≥n SQL, XSS e inyecci√≥n de comandos. Nuclei admite varios tipos de cargas √∫tiles, incluidas las basadas en archivos, las basadas en par√°metros y las basadas en JSON.

### **Conclusi√≥n**

Nuclei es una poderosa herramienta de c√≥digo abierto que automatiza el escaneo de vulnerabilidades de servicios de red y aplicaciones web. Su enfoque flexible y personalizable permite a los usuarios crear y utilizar plantillas para identificar vulnerabilidades y configuraciones err√≥neas. Al utilizar Nuclei con otras herramientas, los cazarrecompensas de errores pueden optimizar sus flujos de trabajo de prueba y mejorar la seguridad. El desarrollo de Nuclei y el apoyo de la comunidad lo convierten en una herramienta valiosa para las pruebas de seguridad.