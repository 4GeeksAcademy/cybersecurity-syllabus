## Gesti√≥n de vulnerabilidades con Nessus

### **Nessus ¬øC√≥mo hallar vulnerabilidades?**

Nessus es una herramienta muy utilizada durante un Pentesting, espec√≠ficamente, en la fase de Escan√©o. Este post estar√° dividido en dos partes: la primera consiste en una muy breve rese√±a de Nessus como producto y, en la segunda parte, se realiza una demostraci√≥n de Nessus.

Nessus es el motor de detecci√≥n de vulnerabilidades perteneciente a la empresa Tenable y es pr√°cticamente el standard como herramienta para este proceso. Existen otras herramientas similares para realizar el hallazgo de vulnerabilidades, algunas con versiones gratuitas como OpenVAS y otras con muy buen desempe√±o como es Qualys.

Tenable permite utilizar su versi√≥n gratuita del motor de detecci√≥n de vulnerabilidades Nessus para peque√±os entornos, lo que a la vez permite empezar a interiorizarse en proceso de gesti√≥n de vulnerabilidades. Es por esto que realizaremos la instalaci√≥n de Nessus en un entorno Windows como prueba de concepto y como laboratorio de pr√°ctica, sin que adem√°s esto impida su utilizaci√≥n en un ambiente de peque√±a red como por ejemplo en un hogar o un peque√±o negocio.

Las amenazas siempre estar√°n presentes tanto a nivel externo como interno en cualquier tipo de equipo pero sin duda que cuando se habla de entornos corporativos o de equipos donde existe informaci√≥n confidencial y extremadamente delicada, se corre el riego de que el robo de informaci√≥n se convierta en un verdadero dolor de cabeza. Para prevenir esto existe una distribuci√≥n de Linux que esta desarrollada especialmente para todos los temas relacionados con an√°lisis de vulnerabilidades.

<aside>
üí° Kali Linux entrega al usuario m√°s de 600 herramientas de penetraci√≥n, pero esta cantidad puede aumentarse usando herramientas extras y una de las m√°s llamativas es Nessus.
</aside>

![Kali Linux 1](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/kali-linux1.png?raw=true)

### **¬øQu√© es Nessus?**

Es una herramienta utilizada principalmente para escanear vulnerabilidades, es desarrollada y mantenida por [Tenable](https://www.tenable.com/). Tiene un motor para escanear los objetivos que se basa en plugins; los plugins son peque√±os programas escritos en un lenguaje de scripting denominado **Nessus Attack Scripting Language (NASL)** que le indican al motor que es lo que debe evaluar en el objetivo, con el fin de determinar las fallas del mismo.

Nessus se ha desarrollado como una herramienta de escaneo de seguridad remota la cual hace el escaneo al equipo remoto para generar las alertas y en caso de detectar alguna vulnerabilidad que ponga en riesgo tanto la informaci√≥n como los datos all√≠ alojados. Para ello realiza m√°s de 1200 verificaciones en el destino para analizar hasta el √∫ltimo byte la presencia de alg√∫n software que sea perjudicial.

### **¬øCu√°ntos plugins tiene Nessus y qui√©n los desarrolla?**

En la actualidad Nessus tiene m√°s de 133.088 plugins, la mayor parte de estos plugins es desarrollado por la gente de Tenable y unos cuantos por la comunidad.

### **¬øQu√© tipo de licencias existen?**

Al momento de pensar en adquirir Nessus se va a encontrar con las siguientes opciones:

- **nessus essentials**: Una versi√≥n que est√° pensada para uso casero, puede realizar escaneos hasta en 16 direcciones IP
- **nessus professional:** Una versi√≥n comercial que permite realizar escaneos a host ilimitados, est√° enfocada a consultores y Pen Testers
- **tenable.io:** Esta versi√≥n est√° m√°s enfocada a la gesti√≥n de vulnerabilidades en compa√±√≠as de cualquier tama√±o.

### Principales caracter√≠sticas de Nessus

Dentro de las principales caracter√≠sticas de Nessus destacamos:

- Nessus hace un an√°lisis completo de la configuraci√≥n del servidor y no se queda solo en los an√°lisis tradicionales
- Dispone de informaci√≥n actualizada sobre nuevas vulnerabilidades y ataques que puedan poner en riesgo los datos e informaci√≥n
- Nessus es de c√≥digo abierto
- Nessus est√° en la capacidad de ser implementado diversas plataformas incluyendo Raspberry Pi
- Dispone de complementos compilados din√°micamente para mejorar el rendimiento y la eficiencia de las tareas de escaneo
- Integra m√°s de 450 plantillas preconfiguradas para una mejor administraci√≥n de las vulnerabilidades a detectar
- Podemos crear reportes personalizados para obtener acceso a la informaci√≥n generada

<aside>
üìñ Nessus trabaja haciendo un an√°lisis en cada puerto del equipo para determinar el tipo de servicio que est√° en ejecuci√≥n y de este modo realizar pruebas para validar que el servicio no tenga o presente vulnerabilidades que afecten la normal operaci√≥n.
</aside>

### Requisitos m√≠nimos

Los requisitos m√≠nimos para usar Nessus son:

- CPU de 4 n√∫cleos con velocidad de 2 GHz
- RAM de 4 GB recomendado 8 GB
- Espacio en disco duro de 30 GB

### Sistemas operativos disponibles

Nessus, aparte de Kali, puede ser instalado en sistemas operativos como:

- Debian 9, 10 / Kali Linux 2017 y Rolling (86x, i386)
- Red Hat 6, 7 8
- FreeBSD 11, 12
- SUSE Enterprise 11 SP4, 12 SP3
- Ubuntu 14 al 18
- Windows 7 al 11
- Mac OS X 10.9, 10.10, 10.11, 10.12, 10.13, 10,14, 10.15, 11.x y 12

### Navegadores

Adicional puede ser usado en los siguientes navegadores:

- Google Chrome (50+)
- Safari (10+)
- Mozilla Firefox (50+)

Ahora te ense√±ar√° c√≥mo instalar Nessus en Kali Linux y gestionar equipos remotos para detectar sus vulnerabilidades.

## **¬øC√≥mo instalar Nessus en Kali Linux?**

Vamos a la URL de Nessus para descargar el respectivo instalador: [NESSUS](https://www.solvetic.com/tutoriales/article/11878-como-instalar-y-usar-nessus-en-kali-linux/Nessus)

![Kali Linux 2](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/kali-linux2.png?raw=true)

Damos clic en el instalador de Debian para 64 bits:

![Kali Linux 3](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/kali-linux3.png?raw=true)

Aceptamos los t√©rminos de la licencia:

![Kali Linux 4](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/kali-linux4.png?raw=true)

Este archivo lo guardamos localmente. Abrimos la terminal de Kali Linux, accedemos a Descargas: usando el comando:

> cd Descargas

Listamos el contenido con "ls":

![Kali Linux 5](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/kali-linux5.png?raw=true)

Instalamos Nessus con el comando:

`sudo dpkg -i archivo.deb`

Ingresamos la contrase√±a y esperamos que finalice el proceso:

![Kali Linux 6](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/kali-linux6.png?raw=true)

Iniciamos el servicio de Nessus:

`sudo /bin/systemctl start nessusd.service`

Una vez iniciado, abrimos un navegador e ingresamos a Nessus:

`https://kali:8834`

Veremos lo siguiente:

![Kali Linux 7](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/kali-linux7.png?raw=true)

Damos clic en "Advanced" y luego damos clic en "Accept the Risk and Continue" para ir a Nessus:

![Kali Linux 8](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/kali-linux8.png?raw=true)

Este ser√° el entorno inicial de Nessus:

![Kali Linux 9](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/kali-linux9.png?raw=true)

Seleccionamos "Nessus Essentials" y luego damos clic en "Continue", ingresamos el usuario a crear con un correo v√°lido, damos clic en "Email" y luego Ingresamos el c√≥digo recibido en el correo registrado:

![Kali Linux 10](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/kali-linux10.png?raw=true)

Asignamos el usuario y contrase√±a de Nessus. Damos clic en "Submit" y se iniciar√° el proceso de descarga de los complementos:

![Kali Linux 11](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/kali-linux11.png?raw=true)

Ahora se lleva a cabo el proceso de compilaci√≥n de los componentes.¬† Esperamos que el proceso, el cual tarda, vaya finalizando:

![Kali Linux 12](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/kali-linux12.png?raw=true)

Al finalizar veremos lo siguiente:

![Kali Linux 13](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/kali-linux13.png?raw=true)

Cierra la ventana emergente para ver el entorno de Nessus:

![Kali Linux 14](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/kali-linux14.png?raw=true)

### **Escanear y buscar vulnerabilidades con Nessus**

Damos clic en "New Scan" y seleccionamos el tipo de escaneo a usar, como vemos las opciones son variadas:

![Nessus1](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nessus1.png?raw=true)

**Las opciones de escaneo que nos ofrece Nessus son:**

- Host Discovery: Ejecuta un escaneo sencillo para descubrir hosts activos y puertos abiertos
- Basic Network Scan: Hace un an√°lisis completo del sistema necesario para cualquier host seleccionado, es ideal para analizar vulnerabilidades internas
- Advanced Scan: Este an√°lisis permite personalizar la configuraci√≥n del escaneo
- Advanced Dynamic Scan: Permite configurar filtros de complementos din√°micos sin tener que hacerlo de forma manual
- Malware Scan: Como su nombre lo indica, busca malware en sistemas Windows y Unix
- Mobile Device Scan: Permite realizar an√°lisis a dispositivos m√≥viles usando Microsoft Exchange o un MDM
- Web Application Tests: Es funcional para buscar vulnerabilidades web publicadas y no publicadas o desconocidas
- Credentialed Patch Audit: Ejecuta una auditor√≠a de parches con credenciales
- Intel AMT Security Bypass: Se encarga de realizar comprobaciones remotas y locales para CVE-2017-5689
- Spectre and Meltdown: Se encarga de llevar a cabo verificaciones remotas y locales para CVE-2017-5753, CVE-2017-5715 y CVE-2017-5754
- WannaCry Ransomeware: Busca el famoso ransomware WannaCry
- Ripple20 Remote Scan: Ubica equipos que ejecutan la pila Treck en la red
- Zerologon Remote Scan: Detecta la vulnerabilidad de elevaci√≥n de privilegios (Zerologon) propia de Microsoft Netlogon
- Solarigate: Permite encontrar vulnerabilidades de SolarWinds Solorigate usando comprobaciones remotas y locales
- ProxyLogon: MS Exchange: ejecuta comprobaciones remotas y locales para detectar vulnerabilidades de Microsoft Exchange Server
- PrintNightmare: Hace an√°lisis y verificaciones locales para CVE-2021-34527, es una vulnerabilidad PrintNightmare Windows Print Spooler
- Active Directory Starter Scan: Busca configuraciones incorrectas en Active Directory
- Log4Shell: Puede detectar la vulnerabilidad Log4Shell en Apache Log4j
- Compliance: Hace una auditor√≠a de la infraestructura de la nube y audita la configuraci√≥n de servicios en la nube de terceros
- Internal PCI Network Scan: Lleva a cabo un an√°lisis de vulnerabilidad PCI DSS interno
- MDM Config Audit: Audita la configuraci√≥n de los administradores de dispositivos m√≥viles MDM
- Offline Config Audit: Hace una auditoria de la configuraci√≥n de los dispositivos de red locales
- Policy Compliance Auditing: Lleva a cabo una auditoria de las configuraciones del sistema tomando como base una l√≠nea de base existente
- SCAP and OVAL Auditing: Analiza sistemas de auditor√≠a a trav√©s de definiciones SCAP y OVAL

Podemos ver como las opciones son variadas y funcionales.

Damos clic en "Basic Network Scan" para un escaneo b√°sico e ingresamos los detalles del escaneo con la IP objetivo:

![Nessus2](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nessus2.png?raw=true)

![Nessus3](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nessus3.png?raw=true)

Damos clic en "Save" para guardar este proyecto:

![Nessus4](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nessus4.png?raw=true)

Damos clic en el icono "Launch" para iniciar el escaneo en el equipo de destino:

![Nessus5](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nessus5.png?raw=true)

Esperamos que el escaneo sea realizado, al finalizar pulsamos sobre el objetivo para ver las vulnerabilidades encontradas:

![Nessus6](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nessus6.png?raw=true)

Cada una estar√° dividida por colores en base a su nivel de riesgo indicando la cantidad y al lado podemos ver una representaci√≥n de estas, damos clic sobre alguna secci√≥n para ver m√°s espec√≠ficamente las vulnerabilidades detectadas:

![Nessus7](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nessus7.png?raw=true)

Es posible ver un resumen de todas las vulnerabilidades de ese tipo y damos clic en alg√∫n elemento para tener acceso a detalles m√°s completos:

![Nessus8](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nessus8.png?raw=true)

Es posible guardar un reporte del an√°lisis ejecutado, para ello damos clic en "Report":

![Nessus9](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nessus9.png?raw=true)

Se abrir√° la siguiente ventana donde seleccionamos el formato y detalles a usar:

![Nessus10](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nessus10.png?raw=true)

Damos clic en "Generate Report" y despu√©s de creado lo abrimos o guardamos. Este reporte contendr√° todo el resultado generado por Nessus. Navegamos por las diferentes paginas para ver los resultados:

![Nessus11](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nessus11.png?raw=true)

Nessus es una valiosa herramienta de escaneo remoto para encontrar vulnerabilidades y tomar acciones sobre ellas antes que sea tarde.

# Instalaci√≥n de Nessus Essentials en Windows 10

1. Descargar Nessus Essentials: [nessus](https://es-la.tenable.com/products/nessus)

![Nessus12](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nessus12.png?raw=true)

2. Un correo electr√≥nico: ser√° la direcci√≥n en la cual recibiremos el c√≥digo de activaci√≥n de Nessus

## Instalaci√≥n

Si nos registramos en el sitio para iniciar la prueba recibiremos un correo con la licencia y un link de descarga para diversas plataformas

![Nessus13](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nessus13.png?raw=true)

Descargamos para el Sistema Operativo que corresponda, en este caso para Windows:

![Nessus14](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nessus14.png?raw=true)

Una vez descargado procedemos a la instalaci√≥n:

![Nessus15](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nessus15.png?raw=true)

Next:

![Nessus16](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nessus16.png?raw=true)

Aceptar la licencia:

![Nessus17](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nessus17.png?raw=true)

Escoger el directorio de destino:

![Nessus18](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nessus18.png?raw=true)

Install (luego aceptar cuando Windows consulte si desea que esta aplicaci√≥n realice cambios en el equipo):

![Nessus19](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nessus19.png?raw=true)

Esperamos que termine la instalaci√≥n, podr√≠a solicitar la instalaci√≥n de componentes adicionales necesarios:

![Nessus20](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nessus20.png?raw=true)

![Nessus21](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nessus21.png?raw=true)

![Nessus22](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nessus22.png?raw=true)

![Nessus23](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nessus23.png?raw=true)

El driver WinPcap debemos instalarlo con la opci√≥n de iniciarlo al inicial el sistema, tal como muestra la foto:

![Nessus24](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nessus24.png?raw=true)

Finalizar la instalaci√≥n de componentes adicionales:

![Nessus25](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nessus25.png?raw=true)

Finalizar la instalaci√≥n de Nessus:

![Nessus26](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nessus26.png?raw=true)

Luego inciar el navegador del sistema en localhost:8834

![Nessus27](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nessus27.png?raw=true)

Como el certificado de conexi√≥n segura es auto firmado debemos aceptar la opci√≥n de ingresar a pesar de las advertencias de seguridad:

![Nessus28](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nessus28.png?raw=true)

En la siguiente etapa escogemos Nessus Essentials:

![Nessus29](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nessus29.png?raw=true)

Como ya tenemos nuestro c√≥digo de activaci√≥n, en este caso presionamos Skip, caso contrario en esta etapa se puede solicitar un c√≥digo de activaci√≥n que llegar√° al correo electr√≥nico indicado:

![Nessus30](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nessus30.png?raw=true)

Ingresamos el c√≥digo de activaci√≥n:

![Nessus31](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nessus31.png?raw=true)

Creamos una cuenta de usuario administrador, en este ejemplo le puse de nombre "admin" :

![Nessus32](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nessus32.png?raw=true)

Esperamos que compile el resto del sistema y actualice la informaci√≥n de vulnerabilidades:

![Nessus33](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nessus33.png?raw=true)

![Nessus34](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nessus34.png?raw=true)

Una vez que esto est√© completado, en la primera vez que ingresemos nos solicitar√° que ingresemos nuestro segmento de red actual para realizar una b√∫squeda de equipos, generalmente la red dom√©stica es 192.168.0.0/24. En mi caso es 192.168.1.0/24, esto se puede ver f√°cilmente en Windows ingresando el comando ‚Äúipconfig‚Äù.

![Nessus35](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nessus35.png?raw=true)

Aqu√≠ tomamos los 3 primeros octetos de nuestra direcci√≥n de red como base, asumiendo que estamos en un segmento con m√°scara 24 (configuraci√≥n dom√©stica est√°ndard), por tanto el segmento de red que debo analizar es 192.168.1.0/24

![Nessus36](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nessus36.png?raw=true)

Una vez iniciada la b√∫squeda de activos aparecer√°n para seleccionar aquellos en los cuales desea realizar un an√°lisis de vulnerabilidades inicial:

![Nessus37](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nessus37.png?raw=true)

![Nessus38](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nessus38.png?raw=true)

Selecciono todos aquellos que se encuentren en mi red y quiero analizar, en mi caso no analizar√© la IP 1 ya que es la del router dom√©stico:

![Nessus39](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nessus39.png?raw=true)

Una vez que iniciemos el an√°lisis aparecer√°n los activos con los hallazgos correspondientes

![Nessus40](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nessus40.png?raw=true)

Una vez terminado este an√°lisis podremos ver que ya realizamos un descubrimiento de hosts y un an√°lisis b√°sico de la red, vamos a ‚ÄúMy Basic Network Scan‚Äù:

![Nessus41](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nessus41.png?raw=true)

Aparecer√°n todos los hosts analizados y sus vulnerabilidades

![Nessus42](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nessus42.png?raw=true)

Ingresando a los detalles de cada host podemos ver cuales son los hallazgos de cada uno

![Nessus43](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nessus43.png?raw=true)

Y posteriormente en cada vulnerabilidad:

![Nessus44](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nessus44.png?raw=true)

Tambi√©n podemos ver los detalles de cada vulnerabilidad y una sugerencia de remediaci√≥n:

![Nessus45](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nessus45.png?raw=true)

### **Conclusi√≥n**

Nessus Essentials es una forma relativamente simple para realizar b√∫squeda de vulnerabilidades en peque√±os entornos dom√©sticos o de peque√±os negocios, su capacidad gratuita de 16 IP m√°ximo permite realizar diversos tipos de b√∫squedas de agujeros de seguridad en nuestros equipos, ya la vez entrega la capacidad de conocer el c√≥mo solucionar estos problemas.