# **Identificaci√≥n de sistemas y servicios vulnerables.**

La identificaci√≥n de sistemas y servicios vulnerables es un paso cr√≠tico en las pruebas de penetraci√≥n y la evaluaci√≥n de seguridad. Aqu√≠ se describen los pasos generales y algunas herramientas comunes utilizadas para llevar a cabo esta tarea:

- **Escaneo de Puertos:** Utiliza herramientas como Nmap, Masscan o Unicornscan para identificar puertos abiertos en el sistema objetivo.
- **Identificaci√≥n de Servicios:** Examina los servicios en los puertos abiertos utilizando t√©cnicas como el fingerprinting para determinar la versi√≥n y el tipo de servicio.
- **B√∫squeda de Vulnerabilidades Conocidas:** Utiliza bases de datos de vulnerabilidades, como el NIST National Vulnerability Database (NVD) o el Common Vulnerabilities and Exposures (CVE), para buscar vulnerabilidades conocidas asociadas a las versiones de servicios identificadas.
- **Escaneo Activo y An√°lisis de Configuraci√≥n:** Utiliza herramientas como Nessus o OpenVAS para realizar escaneos de vulnerabilidades y analizar configuraciones en busca de debilidades conocidas.
- **Explotaci√≥n Selectiva:** Si se cuenta con autorizaci√≥n expl√≠cita, se puede intentar la explotaci√≥n controlada de vulnerabilidades para confirmar su existencia y evaluar el impacto potencial.
- **An√°lisis de Logs y Documentaci√≥n:** Examina registros de sistemas y servicios para identificar actividades an√≥malas, y documenta todas las vulnerabilidades identificadas.

> üí° Es fundamental que todas las actividades se realicen con el consentimiento del propietario del sistema y en conformidad con las leyes y regulaciones aplicables. Adem√°s, los resultados deben ser documentados de manera clara y comunicados al cliente de manera √©tica y profesional.

![vulnerablity analysis](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/analysis.png?raw=true)

## **Evaluaci√≥n de vulnerabilidad: qu√© es y c√≥mo realizarla**

Una evaluaci√≥n de vulnerabilidad analiza y estima los riesgos de las debilidades en seguridad de los sistemas de una organizaci√≥n. Se conocen m√°s de 180.000 vulnerabilidades de seguridad y cada a√±o se descubren nuevas. Con tantas brechas potenciales en la infraestructura y tantas posibilidades de ataque en los sistemas, no es sorprendente que la ciberdelincuencia haya aumentado considerablemente en los √∫ltimos a√±os. Sin embargo, cuando se realizan de forma regular y correcta, las evaluaciones de vulnerabilidad pueden actuar como medida preventiva contra estas crecientes amenazas a la seguridad. Hay que considerar que, incluso con defensas de seguridad de primera calidad, los sistemas de informaci√≥n y seguridad de una organizaci√≥n pueden ser atacados, pirateados o secuestrados por los ciberdelincuentes.

## **Qu√© es una evaluaci√≥n de vulnerabilidad**

Una evaluaci√≥n de la vulnerabilidad es el proceso de revisi√≥n y estimaci√≥n de todas las posibles debilidades de seguridad en la infraestructura de un sistema de informaci√≥n. Este tipo de evaluaci√≥n se utiliza para identificar, priorizar y mitigar vulnerabilidades y para minimizar potenciales amenazas a la seguridad. Estas evaluaciones tambi√©n descubren y analizan las vulnerabilidades dentro del entorno f√≠sico de la organizaci√≥n. Los objetivos de una evaluaci√≥n de la vulnerabilidad pueden desglosarse en tres ideas principales:

- Identificar todas las vulnerabilidades
- Documentar las vulnerabilidades para su futura identificaci√≥n y soluci√≥n
- Orientar a los desarrolladores que crean soluciones para esas amenazas

Las evaluaciones de vulnerabilidad deben realizarse regularmente, especialmente cuando se instalan nuevos equipos, se a√±aden puertos o se introducen servicios. Adem√°s, las evaluaciones de vulnerabilidad pueden prevenir ataques al sistema en dispositivos -nuevos y antiguos- debido a amenazas como:

- Ataques de inyecci√≥n, incluyendo ataques XSS y ataques SQL
- Configuraciones d√©biles por defecto, como contrase√±as de administraci√≥n y nombres de usuario f√°ciles de adivinar
- Ataques de malware y programas maliciosos
- Herramientas y dispositivos de autenticaci√≥n defectuosos
- Datos sin cifrar

> üí° En el caso de las organizaciones de riesgo -como los bancos, los sistemas gubernamentales y aquellos que tienen acceso a informaci√≥n personal, como centros sanitarios-, las evaluaciones de vulnerabilidad pueden ayudar a identificar y reducir los puntos d√©biles antes de que sean explotados por los hackers.

## **Tipos de evaluaciones de vulnerabilidades**

Los diferentes tipos de evaluaciones de vulnerabilidad utilizan herramientas individuales para identificar los puntos d√©biles del sistema y de la red. Los sistemas independientes pueden necesitar varios tipos de evaluaciones para identificar todas sus posibles vulnerabilidades.

- **Evaluaci√≥n del host:** Una evaluaci√≥n del host se centra en los servidores, estaciones de trabajo y otros elementos de la red cr√≠ticos. Aunque los puertos y servicios pueden ser escaneados con evaluaciones de red, una evaluaci√≥n de host es capaz de repasar el historial de parches y la configuraci√≥n.
- **Evaluaci√≥n de la red:** Una evaluaci√≥n de la red se utiliza para identificar posibles vulnerabilidades de conjunto. Puede realizarse tanto para redes conectadas por cable como inal√°mbricas; estas evaluaciones ayudan a prevenir los ataques de seguridad dirigidos a esas redes privadas y p√∫blicas, as√≠ como a la informaci√≥n accesible de los equipos conectados.
- **Evaluaci√≥n inal√°mbrica:** El objetivo de una evaluaci√≥n inal√°mbrica es analizar la red Wi-Fi de una organizaci√≥n. Las redes inal√°mbricas inseguras, incluidas las que tienen puntos de acceso no aprobados, pueden provocar ataques a toda la infraestructura de una organizaci√≥n. Estas evaluaciones tambi√©n verifican que la red de una organizaci√≥n est√° configurada de forma segura con HTTPS.
- **Evaluaciones de bases de datos:** Las evaluaciones de bases de datos analizan el conjunto de datos almacenados de una organizaci√≥n en busca de vulnerabilidades. Los ataques maliciosos, como las inyecciones SQL, suelen tener como objetivo bases de datos con configuraciones err√≥neas, bases de datos no registradas y aquellas que tienen test de desarrollo d√©biles (DevTest). Estas evaluaciones tambi√©n ayudan a las organizaciones a identificar d√≥nde hay que clasificar la informaci√≥n personal en una infraestructura.
- **Evaluaci√≥n de aplicaciones:** Una evaluaci√≥n de aplicaciones analiza las apps web, los sitios y el c√≥digo fuente en busca de descargas de software incorrectas, configuraciones rotas y otras vulnerabilidades de seguridad. Suelen ser escaneos automatizados del c√≥digo y la infraestructura del front-end.


![Evaluaciones Vulnerabilad](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/evaluaciones-vulnerabilad.png?raw=true)

## **Evaluaci√≥n de vulnerabilidades frente a test de penetraci√≥n**

Las evaluaciones de vulnerabilidades y las pruebas de penetraci√≥n no son lo mismo, pero como las evaluaciones de vulnerabilidad tambi√©n pueden incluir un test de penetraci√≥n, ambas pueden confundirse f√°cilmente. Estas evaluaciones duales se conocen a menudo como evaluaci√≥n de vulnerabilidades/test de penetraci√≥n o VAPT, pero no tienen por qu√© realizarse siempre juntas.

Las pruebas de penetraci√≥n se utilizan espec√≠ficamente para encontrar debilidades en el personal, en la organizaci√≥n y en sus procedimientos y es un proceso adicional que puede a√±adirse a toda la evaluaci√≥n de la vulnerabilidad. Las pruebas de penetraci√≥n tambi√©n intentan crear un da√±o en una aplicaci√≥n o red explotando posibles debilidades en un entorno controlado, a fin de demostrar que las vulnerabilidades existen realmente.

Las pruebas de penetraci√≥n utilizan maniobras tanto autom√°ticas como manuales para comprobar las vulnerabilidades. Esas debilidades luego son analizadas por los investigadores para poder crear protecciones y defensas espec√≠ficas. Sin embargo, no son suficientes por s√≠ solas y deben ir seguidas de una evaluaci√≥n completa de la vulnerabilidad.

## **Realizaci√≥n de una evaluaci√≥n de la vulnerabilidad: etapas para identificar las vulnerabilidades**

Si se realiza una evaluaci√≥n de la vulnerabilidad sin una prueba de penetraci√≥n, hay cuatro etapas principales.

![Etapas Evaluacion](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/etapas-evaluacion.png?raw=true)

## **Identificaci√≥n de activos y vulnerabilidades**

La identificaci√≥n es la primera etapa cuando se realiza una evaluaci√≥n de vulnerabilidades: antes de comenzar un esc√°ner, debes identificar los activos escaneables, incluyendo herramientas populares, como dispositivos m√≥viles, dispositivos del Internet de las Cosas y programas basados en la nube. A continuaci√≥n, la infraestructura es escaneada por herramientas automatizadas o manualmente por analistas de seguridad. Se elabora un informe de evaluaci√≥n de vulnerabilidad que describe los puntos d√©biles identificados.

## **An√°lisis**

En la etapa de an√°lisis de una evaluaci√≥n de vulnerabilidad, el objetivo es encontrar el origen y la causa de cada debilidad. Para identificar la causa ra√≠z, los componentes de la infraestructura que son responsables de cada vulnerabilidad deben ser verificados y analizados m√°s a fondo. En la etapa de an√°lisis tambi√©n se comprueba si hay sistemas mal instalados o actualizados.

Los esc√°neres de vulnerabilidad -y sus bases de datos integradas de vulnerabilidades conocidas- pueden se√±alar posibles puntos d√©biles del sistema, dispositivos vulnerables y software de riesgo para ayudar a completar esta etapa. Dado que muchas vulnerabilidades se comunican p√∫blicamente, se pueden identificar r√°pidamente y analizar su causa original.

## **Evaluaci√≥n de riesgo y priorizaci√≥n**

Despu√©s de haber identificado y analizado las vulnerabilidades de tu organizaci√≥n, es el momento de llevar a cabo una evaluaci√≥n de riesgos y determinar la priorizaci√≥n. La primera etapa deber√≠a haber proporcionado informes de evaluaci√≥n, que pueden utilizarse para determinar qu√© vulnerabilidades son m√°s peligrosas para una organizaci√≥n. Durante una evaluaci√≥n de riesgos, los analistas de seguridad asignan a cada vulnerabilidad una puntuaci√≥n de gravedad; los n√∫meros m√°s altos indican puntos d√©biles que deben abordarse lo antes posible. Las vulnerabilidades se clasifican en funci√≥n de una serie de factores, entre ellos:

- Los sistemas afectados
- La informaci√≥n puesta en riesgo
- Facilidad de ataque o compromiso
- Da√±o potencial a la infraestructura y a la organizaci√≥n

## **Reparaci√≥n y mitigaci√≥n**

La etapa final al realizar una evaluaci√≥n de vulnerabilidad es la de remediaci√≥n y mitigaci√≥n. Esta etapa suele estar a cargo de los profesionales de la seguridad y los equipos de operaciones, y se centra en encontrar formas de aliviar las debilidades mientras se desarrollan planes para disminuir la posibilidad de que vuelvan a aparecer las vulnerabilidades. Al crear planes de remediaci√≥n y mitigaci√≥n, los profesionales deben centrarse en dos factores:

- **Gravedad:** tras la priorizaci√≥n, los equipos deben abordar primero las vulnerabilidades m√°s graves. Con el tiempo, deber√≠an ser capaces de crear y publicar correcciones para cada vulnerabilidad detectada pero la correcci√≥n temprana se centra en las m√°s peligrosas.
- **Exposici√≥n a la vulnerabilidad:** determinar si una vulnerabilidad est√° orientada al p√∫blico o a la Red tambi√©n deber√≠a ser una de las principales preocupaciones de los profesionales de la reparaci√≥n. Las vulnerabilidades orientadas a Internet son m√°s f√°ciles de explotar por los ciberdelincuentes, por lo que estas debilidades deben mitigarse en primer lugar, seguidas de los dispositivos propiedad de los empleados y los que almacenan informaci√≥n sensible.

Si se publican parches del sistema o correcciones de la vulnerabilidad, el proceso de evaluaci√≥n de la vulnerabilidad debe comenzar de nuevo. Es importante ejecutar una evaluaci√≥n cuando se instala cualquier tipo de sistema o parche nuevo para as√≠ identificar, analizar, priorizar y remediar r√°pidamente cualquier nueva vulnerabilidad que pueda surgir.

## **Herramientas de evaluaci√≥n de la vulnerabilidad**

Con frecuencia las herramientas de evaluaci√≥n de la vulnerabilidad son procesos automatizados que pueden ser utilizados por cualquiera, desde los expertos en ciberseguridad y los cazadores de amenazas hasta el trabajador que se conecta en su casa. Estas herramientas escanean los sistemas en busca de vulnerabilidades existentes y de nuevos puntos d√©biles no comunicados. Adem√°s, cada herramienta de evaluaci√≥n tiene un prop√≥sito espec√≠fico basado en el tipo de evaluaci√≥n que debe realizar.

**Tipos de herramientas de evaluaci√≥n de la vulnerabilidad:**

- Esc√°neres de aplicaciones web
- Esc√°neres de protocolos
- Esc√°neres de red
- Esc√°neres de vulnerabilidad externa e interna
- Esc√°neres ambientales

Adem√°s del tipo de evaluaci√≥n que realiza cada herramienta, √©stas tienen caracter√≠sticas propias que el usuario debe tener en cuenta. A la hora de elegir una herramienta de evaluaci√≥n, ten en cuenta estas caracter√≠sticas:

- Frecuencia de las actualizaciones
- Capacidad para minimizar los falsos positivos y negativos
- Capacidad de integraci√≥n con otras herramientas de evaluaci√≥n y seguridad
- Resultados procesables

Si bien las evaluaciones de vulnerabilidad son una parte necesaria del proceso de ciberseguridad, hay precauciones adicionales que puedes tomar para mantener mejor protegida la infraestructura. Invertir en una VPN puede ayudar a proteger tu navegaci√≥n en redes p√∫blicas y privadas, mientras que un antivirus puede ayudar a mantener seguros tanto los dispositivos m√≥viles como de sobremesa.

## **Identificando sistemas operativos y servicios**

Como vemos, nmap nos permite detectar puertos que est√°n escuchando en una IP o un rango. Posteriormente veremos adem√°s c√≥mo se pueden definir otras t√©cnicas de sondeo. Adem√°s, nmap nos permite intentar identificar qu√© tecnolog√≠a (producto, versi√≥n, etc.) hay detr√°s de un puerto abierto, o incluso el sistema operativo instalado en un servidor, con los par√°metros -O y -sV. Esta detecci√≥n se basa en la ‚Äúfirma‚Äù (fingerprint) de las respuestas que da el servicio a determinadas llamadas.

```bash
sudo nmap -O -sV 192.168.1.1
```

![Etapas Evaluacion](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/etapas-evaluacion.png?raw=true)

En este caso, no solamente sabemos que esta m√°quina tiene determinados puertos abiertos. Tambi√©n nos dice que es un linux y las versiones de los distintos puertos que est√°n escuchando, de forma que esta informaci√≥n puede ser utilizada para explotar vulnerabilidades sobre versiones no parcheadas, etc.

![Sudo nmap](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/sudo-nmap.png?raw=true)

## **Utilizando m√°s t√©cnicas de sondeo**

Por defecto nmap utiliza SYN como t√©cnica de sondeo. Es una t√©cnica r√°pida y poco intrusiva / detectable, pero en ocasiones , pero soporta en total 12 t√©cnicas distintas que podemos definir como par√°metros, tal como podemos ver en el [manual de uso de la herramienta](https://nmap.org/man/es/man-port-scanning-techniques.html). Por ejemplo, si queremos hacer un escaneo basado en llamadas UDP, podemos hacer una llamada del tipo:

```bash
sudo nmap -sU 192.168.1.1
```

![Sudo nmap](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/sudo-nmap.png?raw=true)
**Usuario**

## **Buscando vulnerabilidades con nmap**

Si bien existen herramientas m√°s ‚Äúc√≥modas‚Äù y espec√≠ficas para la b√∫squeda de vulnerabilidades, como por ejemplo Nessus, o suites como Metasploit que consolida diversas herramientas, nmap tambi√©n nos permite realizar an√°lisis de vulnerabilidades.

Para ello, utiliza una serie de scripts Lua que est√°n ubicados en una ruta de nuestra m√°quina (en el caso de Kali, en /usr/share/nmap/scripts/ ) y que se pueden invocar con ‚Äìscript o su equivalente -sC.

Los scripts pueden pertenecer a una o varias categor√≠as, de forma que podemos pedir a nmap que eval√∫e, por ejemplo, todos los scripts de una categor√≠a contra un host. Hay algunas categor√≠as especialmente interesantes como ‚Äúvuln‚Äù (scripts dedicados a detectar vulnerabilidades en el destino), ‚Äúexploit‚Äù, etc.

Por ejemplo, si queremos escanear los scripts de categor√≠a vulnerabilidad contra un host:

```bash
nmap --script vuln scanme.nmap.org
```

![Nmap Script](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/nmap-script.png?raw=true)

Como vemos, el script ha detectado muchas vulnerabilidades. Si analizamos los scripts veremos que muchos de ellos servir√°n para explotar estas vulnerabilidades. En definitiva, nmap incluye incluso opciones interesantes para evaluar vulnerabilidades e incluso lanzar exploits, si bien existen otras herramientas utilizadas com√∫nmente para este prop√≥sito.

## **Precauciones**

Siempre y cuando vamos a utilizar este tipo de programas o herramientas, debemos tener claro que esto puede ser peligroso para los usuarios. Al escanear los paquetes que se transportan por la red, podemos tener gran cantidad de informaci√≥n en nuestra mano. Esto hace que sea m√°s sencillo que se produzca alguna filtraci√≥n de datos. Por lo cual siempre se deben utilizar de forma adecuada, y con fines legales. Si bien el uso de este tipo de aplicaciones no es ilegal, todo lo contrario, debemos tener cuidado con su uso.

Tenemos una grand√≠sima cantidad de programas para realizar escaneos de vulnerabilidades a nuestras redes, equipos, servicios web y otros servicios que incorporan los servidores. Dependiendo de lo que estemos realizando, tendremos que utilizar un esc√°ner u otro.

## **Bases de datos de vulnerabilidades**

Un aspecto importante es que las distintas soluciones de gesti√≥n de seguridad inform√°tica se valen de estas bases de datos para apoyarnos en la mitigaci√≥n de los riesgos de potenciales ciberataques. Las bases de datos que encontrar√°s a continuaci√≥n, y otras m√°s, son los principales contribuyentes a las soluciones de gesti√≥n de seguridad. Antes de que existiesen est√°ndares como el **CVE y CVSS**, las distintas soluciones ten√≠an bases de datos propias de cada uno y con una gran disparidad de criterios a la hora de nombrarlos, clasificar su criticidad y otros aspectos m√°s.

## **CVE (Common Vulnerabilities and Exposures)**

Es una de las fuentes m√°s confiables a la hora de identificar, analizar y certificar una vulnerabilidad encontrada. Cada una de las vulnerabilidades presentes en esta base de datos, cuenta con n√∫mero **CVE**. Este √∫ltimo es proporcionado por un grupo de autoridades especializadas del grupo de trabajo CVE. Pero, ¬øpor qu√© una vulnerabilidad tendr√≠a un n√∫mero identificador? Esto permite que el manejo de la informaci√≥n respecto a la misma sea mucho m√°s confiable, evitando ambig√ºedades o datos err√≥neos que perjudiquen la informaci√≥n respecto a la vulnerabilidad en cuesti√≥n. Este mismo n√∫mero permite que sea f√°cilmente identificado y evaluado por las **distintas herramientas de seguridad** como los SIEM, que son los Sistemas de Gesti√≥n de Informaci√≥n y Eventos de Seguridad, para que puedan facilitar la puesta en marcha de acciones para mitigar los riesgos.

Desde su fundaci√≥n en el a√±o 1999, CVE se ha convertido en un est√°ndar a la hora de hacer p√∫blica cualquier vulnerabilidad. Como hemos comentado, las distintas herramientas de seguridad implementadas, sobre todo en redes empresariales, personas especializadas en seguridad inform√°tica, e incluso, el p√∫blico en general, logran comunicarse m√°s fluidamente. Esto √∫ltimo, respecto a lo que consiste cierta vulnerabilidad y sus impactos. Estamos seguros que en alg√∫n momento, habr√°s le√≠do alguna noticia, publicaci√≥n o tuit respecto a una o varias vulnerabilidades. En muchos casos, **hacen referencia al n√∫mero CVE** como una forma de respaldo seguro y confiable respecto a la informaci√≥n presentada.

## **CERT Base de Datos de Vulnerabilidades**

Otra base de datos que en esta ocasi√≥n corresponde a la prestigiosa [CERT](https://www.kb.cert.org/vuls/) (***Computer Emergency Response Team***). La misma provee informaci√≥n respecto a cualquier vulnerabilidad de software. Los datos que se incluyen son detalles t√©cnicos, posibles formas de remediaci√≥n y cu√°les son los fabricantes afectados. Varios de los registros encontrados son resultado del esfuerzo de individuos. As√≠ tambi√©n, personas que trabajan fuera de las instituciones de gobierno con el fin de poner a disposici√≥n de toda la informaci√≥n encontrada.

En consecuencia, varios de los registros podr√≠an dar la impresi√≥n de que falta profundidad respecto a uno o m√°s datos. Es por eso que la propia CERT recomienda referirse a bases de datos de instituciones de gobierno **como la NVD**, de la cual hablaremos a continuaci√≥n.

## **NVD (Base de Datos Nacional de Vulnerabilidades)**

Como comentamos recientemente, esta base de datos est√° ligada a una instituci√≥n gubernamental. La misma es la **[NIST](https://nvd.nist.gov/)**, que es el Instituto Nacional de Est√°ndares y Tecnolog√≠a. Es un extenso repositorio que aloja datos respecto a vulnerabilidades que se han gestionado mediante el protocolo SCAP. Sus siglas significan *Security Content Automation Protocol*.

La ventaja directa de estos datos es que se hace mucho m√°s f√°cil la automatizaci√≥n de tareas repetitivas de la gesti√≥n de vulnerabilidades, medici√≥n de indicadores de seguridad y cumplimiento. Adem√°s, podr√°s encontrar todo lo relacionado a fallos de seguridad encontrados en todo tipo de software. As√≠ tambi√©n, sabr√°s respecto a errores en la configuraci√≥n, el nombre del fabricante afectado y los potenciales impactos de la vulnerabilidad o fallo encontrado.

![received](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/received.png?raw=true)

Un detalle muy importante es que, al ingresar al panel de estad√≠sticas, nos encontraremos con las vulnerabilidades listadas con la clasificaci√≥n CVE, que corresponde a la primera base de datos que hemos citado. Esto significa que pr√°cticamente toda vulnerabilidad citada en CVE, tiene un respaldo extra de parte de la base de datos nacional. A pesar de que esta es una instituci√≥n que depende del gobierno de los Estados Unidos, es una de las fuentes m√°s consultadas para estar al tanto de las √∫ltimas vulnerabilidades.

Por otro lado, dicho panel muestra un par de gr√°ficos basados en **CVSS**. Estas siglas significan *Common Vulnerability Scoring System*. Este es un est√°ndar abierto que se utiliza para medir la gravedad de cada una de las vulnerabilidades encontradas. B√°sicamente, se cuenta con cuatro posibilidades o niveles: bajo, medio, alto y cr√≠tico. Se llega a concluir que una vulnerabilidad tiene determinado nivel en base a una serie de m√©tricas. El est√°ndar, as√≠ como todas las bases de datos que hemos citado, es de acceso libre y gratuito para cualquier persona interesada.
