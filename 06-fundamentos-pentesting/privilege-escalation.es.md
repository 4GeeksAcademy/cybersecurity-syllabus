---
title: "Escalaci√≥n de Privilegios Efectiva durante el pentesting"
subtitle: "Explora t√©cnicas avanzadas para escanear y explotar vulnerabilidades de seguridad, permitiendo la escalaci√≥n de privilegios en entornos de pentesting."
tags: ["pentesting", "ciberseguridad", "pruebas-penetracion"]
keyword: ["privilege escalation 22 - 1400"]
authors: ["blindma1den", "lorenagubaira"]
---

## B√∫squeda de vulnerabilidades de escalada de privilegios

La b√∫squeda de vulnerabilidades de escalada de privilegios es crucial para evaluar la seguridad de un sistema y prevenir posibles amenazas. Aqu√≠ se describen algunos pasos y t√©cnicas comunes utilizadas para identificar vulnerabilidades que podr√≠an permitir a un atacante elevar sus privilegios:

- **Recolecci√≥n de Informaci√≥n:** Obtener informaci√≥n detallada sobre el sistema, incluyendo la versi√≥n del sistema operativo, servicios en ejecuci√≥n y configuraciones de seguridad.
- **Enumeraci√≥n de Usuarios y Grupos:** Utilizar comandos y herramientas como whoami, id, o net user para enumerar usuarios y grupos en el sistema.
- **Revisi√≥n de Pol√≠ticas de Seguridad:** Examinar las pol√≠ticas de seguridad del sistema para comprender las restricciones y configuraciones de acceso.
- **An√°lisis de Configuraciones:** Revisar las configuraciones de seguridad, como permisos de archivos, configuraciones de servicios y pol√≠ticas de control de acceso.
- **B√∫squeda de Vulnerabilidades Conocidas:** Utilizar bases de datos de vulnerabilidades, esc√°neres de vulnerabilidades y herramientas como Nessus o OpenVAS para identificar vulnerabilidades conocidas.
- **Pruebas Activas de Escalada de Privilegios:** Realizar pruebas activas, como intentos de explotaci√≥n, para identificar vulnerabilidades que podr√≠an conducir a la escalada de privilegios.

## T√©cnicas Comunes

- **Elevaci√≥n de Privilegios del Usuario:** Buscar vulnerabilidades que permitan a un usuario regular elevar sus privilegios a niveles m√°s altos.
- **Explotaci√≥n de Servicios y Aplicaciones:** Buscar vulnerabilidades en servicios y aplicaciones que podr√≠an permitir la ejecuci√≥n de c√≥digo con privilegios elevados.
- **Ataques a Configuraciones D√©biles:** Identificar configuraciones de seguridad d√©biles o malas pr√°cticas que puedan ser explotadas para la escalada de privilegios.
- **Escalada de Privilegios a Nivel de Sistema:** Buscar vulnerabilidades que permitan a un usuario obtener privilegios de administrador o de sistema.
- **Explotaci√≥n de Servidores:** Investigar vulnerabilidades espec√≠ficas de servidores que puedan ser explotadas para la escalada de privilegios.

## Herramientas Comunes

- **Windows-Exploit-Suggester:** Herramienta para identificar posibles exploits en sistemas Windows.
    - **Uso:** B√∫squeda de exploits para versiones espec√≠ficas de Windows.
- **Linux Exploit Suggester:** Herramienta para identificar posibles exploits en sistemas Linux.
    - **Uso:** B√∫squeda de exploits para versiones espec√≠ficas de sistemas Linux.
- **PowerUp:** PowerShell script para enumerar informaci√≥n y buscar vulnerabilidades en sistemas Windows.
    - **Uso:** Identificaci√≥n de posibles vectores de escalada de privilegios.
- **BeRoot:** Herramienta para verificar configuraciones y buscar vulnerabilidades en sistemas Linux.
    - **Uso:** B√∫squeda de debilidades que podr√≠an conducir a la escalada de privilegios.
    
> üëâ Es crucial llevar a cabo estas actividades de manera √©tica y responsable, obteniendo siempre el consentimiento del propietario del sistema y respetando las leyes y regulaciones aplicables. La comunicaci√≥n transparente de los hallazgos es fundamental para facilitar la mitigaci√≥n y mejorar la seguridad del sistema evaluado.

## Uso de t√©cnicas b√°sicas para elevar los privilegios

El uso de t√©cnicas b√°sicas para elevar los privilegios es un componente cr√≠tico en las pruebas de penetraci√≥n. Aqu√≠ se describen algunas t√©cnicas comunes que los profesionales de seguridad pueden utilizar para identificar y explotar vulnerabilidades que conduzcan a la escalada de privilegios:

1. Explotaci√≥n de Servicios Vulnerables: Identificar servicios en ejecuci√≥n con vulnerabilidades conocidas y utilizar exploits espec√≠ficos para elevar los privilegios.
2. Explotaci√≥n de Configuraciones D√©biles: Identificar configuraciones incorrectas o d√©biles que permitan la escalada de privilegios, como permisos inadecuados en archivos o directorios.
3. Inyecci√≥n de Comandos: Explotar vulnerabilidades que permitan la inyecci√≥n de comandos para ejecutar c√≥digo arbitrario con privilegios elevados.
4. Explotaci√≥n de Vulnerabilidades de D√≠a Cero: Utilizar exploits de vulnerabilidades de d√≠a cero que a√∫n no han sido parcheadas por el fabricante.
5. Ataques de Fuerza Bruta: Realizar ataques de fuerza bruta para obtener acceso no autorizado a cuentas de usuario con privilegios m√°s altos.
6. Uso de Herramientas de Explotaci√≥n: Utilizar herramientas especializadas como Metasploit, PowerShell Empire o Covenant para automatizar la explotaci√≥n de vulnerabilidades y la escalada de privilegios.
7. Explotaci√≥n de Servidores con Permisos Elevados: Identificar servicios que se ejecutan con privilegios elevados y buscar vulnerabilidades que permitan la manipulaci√≥n de esos servicios.
8. Manipulaci√≥n de Tokens de Acceso: Modificar tokens de acceso para obtener privilegios adicionales en el sistema.
9. Uso de Exploits para Escalada de Privilegios Espec√≠ficos del Sistema Operativo: Utilizar exploits espec√≠ficos para la escalada de privilegios en sistemas operativos particulares, como Windows o Linux.
10. Explotaci√≥n de Vulnerabilidades de Aplicaciones Web: Identificar vulnerabilidades en aplicaciones web que permitan la escalada de privilegios a nivel de sistema.

## Consideraciones Importantes

- Consentimiento del Propietario: Obtener el consentimiento expl√≠cito del propietario del sistema antes de realizar pruebas de penetraci√≥n.
- Documentaci√≥n Detallada: Documentar cada acci√≥n realizada, incluyendo hallazgos, exploits utilizados y resultados obtenidos.
- Seguimiento √âtico y Legal: Realizar todas las actividades dentro de los l√≠mites √©ticos y legales, evitando cualquier da√±o no autorizado.
- Comunicaci√≥n Transparente: Comunicar de manera transparente con el cliente o el propietario del sistema sobre las acciones realizadas y los resultados obtenidos.

> üí° Es esencial llevar a cabo estas actividades de manera √©tica y responsable, garantizando siempre el consentimiento del propietario del sistema y respetando las leyes y regulaciones aplicables. La escalada de privilegios debe ser realizada con el objetivo de mejorar la seguridad del sistema, identificar debilidades y facilitar la mitigaci√≥n.

## Obtenci√≥n de acceso privilegiado en el sistema objetivo

La escalada de privilegios es el acto de explotar un error, una falla de dise√±o o la supervisi√≥n de la configuraci√≥n en un sistema operativo o aplicaci√≥n de software para obtener un acceso elevado a los recursos que normalmente est√°n protegidos de una aplicaci√≥n o usuario. Vamos a utilizar una distro de Linux vulnerable para poner un ejemplo de elevaci√≥n de privilegios, se trata de Metasploitable II. Nuestra m√°quina atacante ser√° un Kali Linux. El proceso que se va a llevar a cabo de manera resumida es el siguiente:

1. Buscamos los servicios que est√°n corriendo en la m√°quina Metasploitable.
2. Comprobamos si tiene vulnerabilidades.
3. Explotamos la vulnerabilidad que escogemos.
4. Estamos dentro con privilegios limitados, as√≠ que buscamos procesos corriendo como root y que no pertenezcan al kernel.
5. Buscamos un exploit que nos permita elevarnos y lo ejecutamos.

### Las m√°quinas y sus IPs son las siguientes

- Kali Linux > `192.168.1.50`
- Metasploitable II > `192.168.1.49`

Buscando servicios en la m√°quina v√≠ctima. Para esta tarea usaremos nmap, el comando a ejecutar:

```bash
nmap -p 1-65535 -T4 -sV 192.168.1.49
```

Como se va a usar Metasploit, podemos hacer uso de nmap en la propia herramienta (db_nmap), el resultado va a ser el mismo, pero se guardar√°n los resultados en la base de datos, para no perdernos antes borramos la base de datos con ‚Äúclear database‚Äù. La salida (no completa) se muestra en la siguiente captura:

![captura](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/captura.png?raw=true)

Ahora podemos consultar los servicios todas las veces que queramos con el comando services de Metasploit.

## Buscamos posibles exploits

Vamos a centrarnos en el puerto 21, el servicio FTP, y buscamos un posible exploit:

![exploits](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/exploits.png?raw=true)

Encontramos un exploit disponible para la versi√≥n que est√° corriendo en la m√°quina v√≠ctima. Configuramos el exploit y lo lanzamos:

![exploit disponible](https://github.com/4GeeksAcademy/cybersecurity-syllabus/blob/main/assets/exploit-disponible.png?raw=true)

Ya estamos dentro de la m√°quina v√≠ctima, y encima con el usuario root, que m√°s se puede pedir. En el pr√≥ximo post veremos que no siempre es tan f√°cil conseguir altos privilegios, y tendremos que trabajar un poco m√°s para llegar a ello.
