---
title: "Qué son los Fallos Criptográficos - Vulnerabilidad del OWASP top 10"
subtitle: "Entendiendo la vulnerabilidad de los Fallos Criptográficos: Cómo Identificarlos y Prevenirlos"
tags: ["ciberseguridad", "OWASP Top 10", "pentesting", "criptografia"]
authors: ["alesanchezr"]
---

En 2013, la infame violación de datos en Target Corporation expuso la información de las tarjetas de crédito de más de 40 millones de clientes. Una de las vulnerabilidades clave explotadas durante este ataque fue un fallo criptográfico. Los atacantes pudieron interceptar y descifrar datos sensibles debido a prácticas de cifrado débiles, lo que causó un daño financiero y reputacional significativo para la compañía.

## ¿Qué son los fallos criptográficos?

Los fallos criptográficos, anteriormente conocidos como "Exposición de Datos Sensibles" en el OWASP Top 10, ocurren cuando los datos sensibles no están adecuadamente protegidos a través del cifrado. Esto puede suceder por varias razones, como el uso de algoritmos criptográficos desactualizados o débiles, una gestión inadecuada de claves, o la falta de cifrado de los datos en tránsito o en reposo.

## Causas comunes de los fallos criptográficos

1. **Algoritmos débiles o desactualizados**: Usar algoritmos que ya no se consideran seguros, como MD5 o SHA-1, puede facilitar que los atacantes descifren datos sensibles.
2. **Gestión inadecuada de claves**: No generar, almacenar y gestionar de manera segura las claves criptográficas puede llevar al acceso no autorizado a los datos cifrados.
3. **Falta de cifrado**: No cifrar datos sensibles, ya sea en tránsito o en reposo, los deja vulnerables a la interceptación y el acceso no autorizado.
4. **Implementación deficiente**: La implementación incorrecta de los protocolos criptográficos puede introducir vulnerabilidades que los atacantes pueden explotar.

## Escenario de ejemplo

Considera una aplicación web que transmite información sensible del usuario, como detalles de la tarjeta de crédito, a través de una conexión HTTP no cifrada:

```
GET /user/123456 HTTP/1.1
Host: example.com
```

Si la aplicación no implementa cifrado, los detalles de la tarjeta de crédito estarán expuestos a los atacantes que puedan interceptar la solicitud y descifrar los datos.

## Cómo prevenir los fallos criptográficos

1. **Usa algoritmos de cifrado fuertes**: Implementa algoritmos criptográficos modernos, como AES, RSA y ECDH, que se consideran seguros y ampliamente utilizados.
2. **Gestión segura de claves**: Implementa prácticas seguras de gestión de claves, como la rotación de claves y el almacenamiento en ubicaciones seguras.
3. **Cifra los datos en tránsito**: Usa HTTPS/TLS para cifrar los datos transmitidos entre el cliente y el servidor.
4. **Cifra los datos en reposo**: Cifra los datos sensibles almacenados en el servidor, como los detalles de las tarjetas de crédito, antes de almacenarlos en la base de datos.
5. **Implementa autenticación y autorización adecuadas**: Asegúrate de que los usuarios estén autenticados y autorizados para acceder a los datos sensibles.

Al implementar estas medidas, las organizaciones pueden reducir significativamente el riesgo de fallos criptográficos y proteger los datos sensibles del acceso no autorizado.

## Frameworks de desarrollo web populares y métodos de cifrado de contraseñas

A continuación, se muestra una tabla con algunos de los frameworks de desarrollo web más populares en PHP, Node.js, Python, Ruby y Java, junto con sus métodos actuales de cifrado de contraseñas, los métodos previos utilizados antes de actualizar y el año en que decidieron actualizar:

| Lenguaje | Framework         | Métodos de cifrado de contraseñas actuales | Métodos previos de cifrado de contraseñas | Año de actualización |
|----------|-------------------|--------------------------------------------|-------------------------------------------|----------------------|
| PHP      | Laravel           | bcrypt                                     | MD5                                       | 2015                 |
| PHP      | Symfony           | bcrypt                                     | SHA-1                                     | 2014                 |
| PHP      | WordPress         | bcrypt                                     | MD5                                       | 2013                 |
| Node.js  | Express           | bcrypt                                     | SHA-1                                     | 2016                 |
| Node.js  | Koa               | bcrypt                                     | SHA-1                                     | 2016                 |
| Python   | Django            | PBKDF2, Argon2                             | SHA-1                                     | 2014                 |
| Python   | Flask             | bcrypt                                     | MD5                                       | 2015                 |
| Ruby     | Ruby on Rails     | bcrypt                                     | SHA-1                                     | 2013                 |
| Java     | Spring            | bcrypt                                     | MD5                                       | 2015                 |
| Java     | JavaServer Faces  | bcrypt                                     | SHA-1                                     | 2014                 |
| Otros    | Shopify           | bcrypt                                     | MD5                                       | 2015                 |

Estos frameworks implementan métodos de cifrado de contraseñas fuertes para garantizar la seguridad de los datos sensibles en aplicaciones web. Es importante seguir las mejores prácticas y mantener los métodos de cifrado actualizados para prevenir fallos criptográficos.

## Características comunes que debes cifrar

A continuación, se muestra una lista de características comunes en las que los frameworks de desarrollo web populares suelen decidir almacenar datos cifrados:

1. **Contraseñas de usuarios**: Asegurarse de que las contraseñas de los usuarios se almacenen en un formato cifrado para prevenir el acceso no autorizado en caso de una violación de datos.
2. **Información de tarjetas de crédito**: Cifrar los detalles de las tarjetas de crédito para cumplir con los estándares PCI-DSS y proteger la información financiera sensible.
3. **Información Personal Identificable (PII)**: Cifrar datos como números de seguridad social, direcciones y números de teléfono para proteger la privacidad del usuario.
4. **Tokens de sesión**: Almacenar tokens de sesión en un formato cifrado para prevenir el secuestro de sesiones y el acceso no autorizado.
5. **Claves y secretos de API**: Cifrar las claves y secretos de API para asegurar el acceso a servicios de terceros y evitar su uso indebido.
6. **Copias de seguridad de bases de datos**: Cifrar las copias de seguridad de las bases de datos para garantizar que los datos sensibles permanezcan protegidos incluso si se comprometen los archivos de respaldo.
7. **Archivos de configuración**: Cifrar la información sensible en los archivos de configuración, como credenciales de bases de datos y claves API, para evitar el acceso no autorizado.
8. **Direcciones de correo electrónico**: Cifrar las direcciones de correo electrónico para proteger la identidad del usuario y prevenir el spam o los ataques de phishing.
9. **Registros médicos**: Cifrar los registros médicos para cumplir con regulaciones como HIPAA y proteger la información médica sensible.
10. **Transacciones financieras**: Cifrar los detalles de las transacciones financieras para garantizar la integridad y confidencialidad de los datos.
11. **Cookies**: Cifrar las cookies para proteger la información de sesión y los datos del usuario almacenados en las cookies de ser accedidos o manipulados por terceros no autorizados.

Al cifrar estas características, los frameworks de desarrollo web mejoran la seguridad de los datos sensibles y reducen el riesgo de acceso no autorizado y violaciones de datos.

## Herramientas para detectar cifrado débil o inexistente

Detectar cifrado débil o inexistente es crucial para garantizar la seguridad de los datos sensibles.

Detectar fallos criptográficos implica identificar problemas como algoritmos débiles, implementaciones deficientes, uso incorrecto o gestión insuficiente de claves. A continuación, se presentan varias herramientas y técnicas comúnmente utilizadas para detectar estos fallos:

### 1. **Herramientas de análisis estático**
   Estas herramientas analizan el código fuente sin ejecutarlo para encontrar vulnerabilidades criptográficas en la base de código.
   - **Checkmarx**: Detecta algoritmos de criptografía inseguros o débiles e implementaciones incorrectas.
   - **SonarQube**: Identifica claves codificadas, uso de algoritmos criptográficos débiles y otros problemas relacionados con la criptografía.
   - **Fortify**: Escanea el uso incorrecto de la criptografía, malas prácticas de gestión de claves y algoritmos débiles.
   - **Semgrep**: Una herramienta de análisis estático de código abierto que permite reglas personalizadas para detectar patrones criptográficos inseguros en el código.

### 2. **Herramientas de análisis dinámico**
   Estas herramientas analizan el software durante su ejecución para encontrar fallos criptográficos en condiciones reales.
   - **Burp Suite**: Identifica el uso inseguro de la criptografía durante las pruebas de aplicaciones web (por ejemplo, configuraciones SSL/TLS débiles, falta de cifrado).
   - **OWASP ZAP**: Detecta conjuntos de cifrado SSL/TLS débiles y configuraciones criptográficas inseguras en aplicaciones web.
   - **AppScan**: La herramienta de IBM puede probar fallos y vulnerabilidades criptográficas durante la ejecución.

### 3. **Escáneres de vulnerabilidades**
   Estos escáneres pueden evaluar aplicaciones y sistemas desplegados para detectar configuraciones de cifrado débiles o bibliotecas criptográficas desactualizadas.
   - **Qualys SSL Labs**: Prueba específicamente las

 configuraciones SSL/TLS para asegurarse de que se utilicen métodos de cifrado fuertes y que el servidor no sea vulnerable a ataques como POODLE o BEAST.
   - **Nessus**: Escanea fallos criptográficos en servicios de red y servidores web, identificando algoritmos débiles y una gestión inadecuada de certificados.
   - **OpenVAS**: Identifica vulnerabilidades relacionadas con criptografía débil en redes y sistemas.

### 4. **Herramientas de prueba de SSL/TLS**
   Estas herramientas ayudan a verificar la configuración y seguridad de las implementaciones SSL/TLS.
   - **SSLyze**: Una herramienta para analizar la configuración SSL/TLS de los servidores y detectar debilidades, como conjuntos de cifrado débiles o versiones de protocolos inadecuadas.
   - **testssl.sh**: Una herramienta de línea de comandos que prueba las configuraciones SSL/TLS y destaca implementaciones criptográficas débiles y configuraciones incorrectas.
   - **CryptoLyzer**: Detecta problemas en los certificados SSL/TLS y los conjuntos de cifrado.

### 5. **Herramientas de pruebas de penetración**
   Las debilidades criptográficas también pueden ser reveladas durante pruebas de penetración manual utilizando estas herramientas:
   - **Metasploit**: Ofrece módulos para explotar implementaciones criptográficas débiles.
   - **John the Ripper**: Se utiliza para romper hashes de contraseñas débiles o funciones criptográficas mediante ataques de fuerza bruta.
   - **Hydra**: Una herramienta para la fuerza bruta de protocolos de autenticación cifrados.

### 6. **Bibliotecas y frameworks con auditorías de seguridad**
   - **Cryptosense Analyzer**: Diseñada específicamente para analizar protocolos y bibliotecas criptográficas en busca de fallos de implementación.
   - **Ghidra**: Una herramienta de ingeniería inversa que puede usarse para analizar código compilado en busca de errores criptográficos o puertas traseras.
   - **Binwalk**: Útil para ingeniería inversa y análisis de firmware para encontrar claves criptográficas y algoritmos inseguros.

### 7. **Revisión manual de código**
   Los auditores experimentados pueden revisar manualmente el código en busca de:
   - Uso incorrecto de bibliotecas criptográficas (por ejemplo, OpenSSL, BouncyCastle).
   - Generación o gestión de claves insegura.
   - Uso de algoritmos débiles o desactualizados (por ejemplo, MD5, SHA-1, DES).

### 8. **Pruebas de gestión de claves y entropía**
   Herramientas para probar la fortaleza y aleatoriedad de las claves y las fuentes de entropía:
   - **Entropy as a Service (EaaS)**: Prueba la entropía en la generación de números aleatorios.
   - **dieharder**: Una herramienta de pruebas de generadores de números aleatorios que puede ayudar a detectar problemas con entropía débil en la generación de claves criptográficas.

A continuación, se presenta una guía sobre cómo utilizar algunas de las herramientas mencionadas para detectar fallos criptográficos, junto con los pasos involucrados.

### 1. **Checkmarx (Análisis estático)**
   **Pasos**:
   - **Paso 1**: Instala Checkmarx e intégralo en tu canalización CI/CD o usa su interfaz web.
   - **Paso 2**: Configura un proyecto conectando tu repositorio o subiendo el código fuente.
   - **Paso 3**: Ejecuta un escaneo. Checkmarx analizará automáticamente el código fuente para detectar fallos criptográficos (por ejemplo, algoritmos débiles, claves codificadas).
   - **Paso 4**: Revisa el informe. Enfócate en los problemas identificados, como el uso inseguro de la criptografía.
   - **Paso 5**: Aplica las recomendaciones del informe detallado de Checkmarx para corregir las vulnerabilidades.

### 2. **Burp Suite (Análisis dinámico)**
   **Pasos**:
   - **Paso 1**: Instala Burp Suite y configúralo como proxy para tu navegador.
   - **Paso 2**: Abre la aplicación web que deseas probar y permite que Burp Suite capture el tráfico.
   - **Paso 3**: En la pestaña **"Scanner"**, lanza un escaneo automatizado en la aplicación.
   - **Paso 4**: Revisa el informe de escaneo en busca de problemas criptográficos, como configuraciones SSL/TLS débiles o falta de cifrado en comunicaciones sensibles.
   - **Paso 5**: Usa la herramienta "Repeater" o "Intruder" dentro de Burp Suite para probar manualmente la seguridad de las implementaciones de cifrado (por ejemplo, pruebas de ataques Padding Oracle).

### 3. **SSL Labs (Prueba de SSL/TLS)**
   **Pasos**:
   - **Paso 1**: Ve al [sitio web de SSL Labs](https://www.ssllabs.com/ssltest/) e ingresa el nombre de dominio del servidor que deseas probar.
   - **Paso 2**: Haz clic en "Submit" para iniciar la prueba.
   - **Paso 3**: Espera los resultados. SSL Labs proporcionará un análisis de la configuración SSL/TLS del servidor, destacando cualquier conjunto de cifrado débil, problemas de protocolo o vulnerabilidades.
   - **Paso 4**: Revisa los resultados, que incluyen una calificación (A-F) para la fortaleza general de SSL/TLS, recomendaciones para correcciones y detalles de los conjuntos de cifrado débiles o configuraciones incorrectas.
   - **Paso 5**: Implementa los cambios recomendados, como eliminar protocolos débiles como SSLv3 o usar cifrados fuertes como AES-256.

### 4. **SSLyze (Escáner de SSL/TLS)**
   **Pasos**:
   - **Paso 1**: Instala SSLyze usando pip:
     
```bash
     pip install sslyze
```

   - **Paso 2**: Ejecuta SSLyze para analizar la configuración SSL/TLS de un servidor de destino:
     
```bash
     sslyze --regular <dominio_destino>
```

   - **Paso 3**: Revisa la salida. SSLyze mostrará detalles sobre las versiones de SSL/TLS admitidas, conjuntos de cifrado, y destacará configuraciones débiles o vulnerables.
   - **Paso 4**: Enfócate en los conjuntos de cifrado débiles (por ejemplo, RC4, DES) y asegúrate de que se estén utilizando cifrados fuertes (por ejemplo, AES).
   - **Paso 5**: Corrige cualquier configuración incorrecta modificando la configuración SSL/TLS de tu servidor.

### 5. **testssl.sh (Prueba de SSL/TLS)**
   **Pasos**:
   - **Paso 1**: Clona el repositorio de testssl.sh desde GitHub:
     
```bash
     git clone https://github.com/drwetter/testssl.sh.git
     cd testssl.sh
```

   - **Paso 2**: Ejecuta un análisis contra tu servidor:
     
```bash
     ./testssl.sh <dominio_destino>
```

   - **Paso 3**: Analiza los resultados. testssl.sh mostrará vulnerabilidades relacionadas con protocolos criptográficos débiles, conjuntos de cifrado y problemas de certificados.
   - **Paso 4**: Implementa las correcciones sugeridas para los problemas SSL/TLS, como deshabilitar protocolos débiles (por ejemplo, TLS 1.0) o usar un certificado más fuerte.

### 6. **John the Ripper (Herramienta de pruebas de penetración)**
   **Pasos**:
   - **Paso 1**: Instala John the Ripper usando tu administrador de paquetes o desde el [sitio oficial de John the Ripper](https://www.openwall.com/john/).
   - **Paso 2**: Prepara una lista de hashes de contraseñas (por ejemplo, de una base de datos vulnerable) que deseas probar.
   - **Paso 3**: Ejecuta la herramienta contra el archivo de hashes de contraseñas:
     
```bash
     john <archivo_de_hashes>
```

   - **Paso 4**: Revisa los resultados. Si John the Ripper es capaz de romper hashes débiles (por ejemplo, MD5, SHA-1), esto indica un fallo criptográfico.
   - **Paso 5**: Fortalece tus mecanismos de hash usando algoritmos más fuertes como bcrypt o PBKDF2.

### 7. **Qualys SSL Labs Scanner (Escáner de vulnerabilidades)**
   **Pasos**:
   - **Paso 1**: Visita [Qualys SSL Labs](https://www.ssllabs.com/ssltest/) e ingresa el dominio de tu servidor para probar la configuración SSL/TLS.
   - **Paso 2**: Haz clic en "Submit" para iniciar el análisis.
   - **Paso 3**: Espera a que el análisis finalice, lo que destacará problemas criptográficos como conjuntos de cifrado débiles, versiones de protocolo y problemas con certificados.
   - **Paso 4**: Analiza el informe, enfocándote en las áreas donde la fortaleza SSL/TLS puede mejorarse.
   - **Paso 5**: Sigue las recomendaciones para actualizar la configuración de tu servidor y asegurarte de que se use criptografía fuerte.

### 8. **N

essus (Escáner de vulnerabilidades)**
   **Pasos**:
   - **Paso 1**: Instala Nessus desde [el sitio web de Tenable](https://www.tenable.com/products/nessus).
   - **Paso 2**: Crea un nuevo análisis y elige el tipo de análisis adecuado (por ejemplo, "Escaneo básico de red").
   - **Paso 3**: Ingresa el servidor de destino o la dirección IP y ejecuta el análisis.
   - **Paso 4**: Una vez que el análisis haya finalizado, Nessus proporcionará un informe destacando vulnerabilidades, incluidas configuraciones criptográficas débiles.
   - **Paso 5**: Soluciona cualquier vulnerabilidad detectada, como bibliotecas criptográficas desactualizadas o una gestión de claves insegura.

### 9. **Cryptosense Analyzer**
   **Pasos**:
   - **Paso 1**: Regístrate en Cryptosense Analyzer o descarga la herramienta desde su sitio web.
   - **Paso 2**: Sube el código fuente de tu aplicación o usa el agente de Cryptosense para monitorear las operaciones criptográficas de un sistema en ejecución.
   - **Paso 3**: Permite que Cryptosense analice las llamadas criptográficas, la gestión de claves y los protocolos en uso.
   - **Paso 4**: Revisa el informe detallado, que destaca problemas como algoritmos débiles, gestión incorrecta de claves o falta de aleatoriedad suficiente.
   - **Paso 5**: Sigue las mejores prácticas recomendadas para corregir cualquier problema criptográfico.

Al seguir estos pasos, puedes identificar y mitigar fallos criptográficos en tus aplicaciones y sistemas usando las herramientas adecuadas.
