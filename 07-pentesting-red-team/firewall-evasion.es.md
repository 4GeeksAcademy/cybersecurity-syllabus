---
title: "Como evadir un firewall"  
subtitle: "C칩mo evadir un web application firewall, utilizar herramientas como VPN, NMAP y verificar m칠todos de evasi칩n para una seguridad de red optimizada"  
tags: ["pentesting", "ciberseguridad", "Firewalls"]  
authors: ["blindma1den", "lorenagubaira"]  
keyword: "eludir firewall"

---

> Antes de leer este art칤culo, recomendamos leer sobre [firewalls y c칩mo funcionan](https://4geeks.com/es/lesson/que-es-un-firewall-y-como-ayuda-a-optimizar-la-seguridad-en-redes). Nos enfocaremos en la evasi칩n de firewalls, pero necesitas algunos conocimientos fundamentales sobre firewalls para entender la evasi칩n.

## 쯈u칠 estamos tratando de evadir contra un firewall?

La mayor칤a de los firewalls examinan los paquetes de red con una serie de filtros (a nivel de aplicaci칩n o red) mientras intentan entrar en la red. Luego, dependiendo de las direcciones IP de origen y destino, los protocolos y los puertos, el firewall decide si pueden entrar. Algunos **firewalls de aplicaciones web (WAF)** tambi칠n analizan los paquetes HTTP en busca de c칩digo malicioso, y otros incluyen antivirus, inspecci칩n de tr치fico cifrado y sistemas de prevenci칩n de intrusiones (IPS).

# M칠todos de evasi칩n

Aunque los **firewalls e IDS** pueden evitar que los paquetes maliciosos entren en una red, un atacante puede enviar paquetes modificados al objetivo para que el IDS/Firewall no los detecte. Estos son diez m칠todos de evasi칩n:

1. **Cifrado de datos**: al cifrar los datos transmitidos, se vuelve m치s dif칤cil para el firewall o el sistema de detecci칩n de intrusos detectar cualquier actividad maliciosa.
2. **VPN**: una red privada virtual (VPN) puede ayudar a evadir firewalls y sistemas de detecci칩n de intrusos enrutando el tr치fico a trav칠s de un servidor seguro.
3. **Servidor proxy**: Un servidor proxy puede ayudar a enmascarar el origen del tr치fico, lo que dificulta que el firewall o el sistema de detecci칩n de intrusos rastreen la fuente de un ataque.
4. **TOR**: La red TOR puede ayudar a enmascarar la identidad del usuario y el origen del tr치fico, lo que dificulta que el firewall o el sistema de detecci칩n de intrusos detecten cualquier actividad maliciosa.
5. **Cambio de puerto**: Al cambiar constantemente el puerto utilizado para transmitir datos, se vuelve m치s dif칤cil para el firewall o el sistema de detecci칩n de intrusos detectar cualquier actividad maliciosa.
6. **Esteganograf칤a**: Al ocultar datos dentro de otro archivo o mensaje, es m치s dif칤cil para el firewall o el sistema de detecci칩n de intrusos detectar cualquier actividad maliciosa.
7. **Protocolos de capa de aplicaci칩n**: Al utilizar protocolos de capa de aplicaci칩n como HTTP o SMTP, es m치s dif칤cil para el firewall o el sistema de detecci칩n de intrusos detectar cualquier actividad maliciosa.
8. **C칩digo malicioso:** Al usar c칩digo malicioso o malware, es m치s dif칤cil para el firewall o el sistema de detecci칩n de intrusos detectar cualquier actividad maliciosa.
9. **Ingenier칤a social**: Al enga침ar a los usuarios para que revelen informaci칩n confidencial o realicen ciertas acciones, es m치s f치cil para un atacante evadir el firewall o el sistema de detecci칩n de intrusos.
10. **Acceso f칤sico**: Al acceder f칤sicamente a la red o al sistema, un atacante puede evadir el firewall o el sistema de detecci칩n de intrusos.
11. **Software desactualizado**: Los firewalls dependen del software para funcionar correctamente, y este software debe actualizarse peri칩dicamente para mantenerse al d칤a con las 칰ltimas amenazas. Si no actualizas el software de tu firewall, puedes volverte vulnerable a ataques descubiertos desde la 칰ltima actualizaci칩n.
12. **Contrase침as d칠biles:** Una contrase침a fuerte y 칰nica es una de las formas m치s importantes de proteger tu firewall contra brechas de seguridad. Si utilizas una contrase침a d칠bil o f치cil de adivinar, los hackers pueden acceder f치cilmente a tu firewall y comprometer tu sistema.
13. **Acceso remoto inseguro:** Si permites el acceso remoto a tu sistema, es esencial proteger este acceso con una contrase침a fuerte y autenticaci칩n de dos factores. Si no se toman estas medidas, los hackers podr칤an acceder a tu firewall a trav칠s del acceso remoto.
14. **Reglas mal configuradas:** Los firewalls dependen de reglas para determinar qu칠 tr치fico se permite y cu치l se bloquea. Si estas reglas no se configuran correctamente, es posible que se permita pasar tr치fico no deseado a trav칠s del firewall y comprometer tu sistema.

> Para proteger tu firewall contra brechas de seguridad, es esencial actualizar regularmente tu software, utilizar contrase침as fuertes, proteger contra infecciones de malware, proteger el acceso remoto y configurar correctamente las reglas de tu firewall.

## Eludir un firewall utilizando SSL

Existe un m칠todo para eludir las restricciones de la red encapsulando varios tipos de tr치fico dentro de una conexi칩n HTTPS en el puerto 443. Involucra configurar un servidor proxy inverso con un certificado SSL y usar Stunnel para crear un t칰nel cifrado que enmascare el tr치fico SSH como HTTPS. Este enfoque permite a los usuarios eludir firewalls que generalmente permiten tr치fico HTTPS mientras bloquean otros tipos de tr치fico, disfrazando eficazmente el tr치fico no web como navegaci칩n web segura. La t칠cnica es particularmente 칰til en entornos menos seguros, pero puede ser menos efectiva contra firewalls avanzados con capacidades de inspecci칩n SSL.

> 游댠 Aqu칤 tienes un art칤culo detallado sobre [c칩mo eludir un firewall utilizando SSL](#).

## Eludir un firewall utilizando NMAP Script Engine

El Nmap Scripting Engine (NSE) puede ser particularmente efectivo para evadir firewalls utilizando scripts espec칤ficos dise침ados para eludir la detecci칩n y penetrar en redes restringidas. Estos scripts pueden manipular estructuras de paquetes, emplear escaneos se침uelo o suplantar direcciones IP para enga침ar a los firewalls y permitir tr치fico que de otro modo ser칤a bloqueado. Los scripts NSE tambi칠n pueden ayudar a identificar puertos abiertos que podr칤an ser pasados por alto por los firewalls o reglas de seguridad mal configuradas, proporcionando un camino para eludir las defensas de la red. Esto hace que NSE sea una herramienta poderosa para probar y eludir restricciones de firewalls durante evaluaciones de seguridad o pruebas de penetraci칩n.

> 游댠 Aqu칤 tienes un art칤culo detallado sobre c칩mo [utilizar el NMAP Script Engine para eludir un firewall](#).

## C칩mo evadir un WAF

### 쯈u칠 hacer para encontrar el proveedor del WAF y la direcci칩n IP real?

Divulgaci칩n de IP real

1. EJECUTA `shodan.io` o `censys.io`
2. Busca registros SPF y registros TXT.

Los registros SPF y TXT pueden tener una direcci칩n IP de una fuente no CloudFlare.

3. Tambi칠n puedes verificar en securitytrails.com. Los datos hist칩ricos pueden tener la IP original en el campo de registros antiguos.

**C칩mo probar que el WAF est치 configurado correctamente:**

- Los WAF utilizan los puertos est치ndar 80, 443, 8000, 8008, 8080 y 8088.
- Los WAF configuran sus cookies en las solicitudes.
- Los WAF est치n asociados con encabezados separados.
- Los WAF est치n expuestos en el encabezado del servidor.
- Los WAF est치n expuestos en el contenido de la respuesta.
- Los WAF responden con c칩digos de respuesta 칰nicos a solicitudes maliciosas.
- Env칤a una solicitud GET est치ndar desde un navegador, intercepta y registra los encabezados de respuesta (cookies espec칤ficas).
- Env칤a una solicitud desde la l칤nea de comandos (por ejemplo, cURL) y luego verifica el contenido y los encabezados de la respuesta.
- Env칤a solicitudes GET a puertos abiertos aleatorios y verifica banners que pueden exponer la identidad de los WAF.
- Prueba algunos payloads de inyecci칩n SQL como: or 1 = 1: para iniciar sesi칩n en formularios o recuperar una contrase침a.
- Prueba payloads de [XSS](https://4geeks.com/es/lesson/como-realizar-o-prevenir-el-ataque-xss-secuencias-de-comandos-entre-sitios) ruidosos como <script>confirm()</script> en algunos campos de entrada.
- Intenta agregar ../../../etc/passwd a un par치metro aleatorio en la URL.
- Agrega algunos payloads como ' OR SLEEP(5) OR ' al final de las URLs en cualquier par치metro aleatorio.
- Env칤a solicitudes GET con protocolos obsoletos como HTTP/0.9 (HTTP/0.9 no soporta consultas POST).
- Revisa el encabezado del servidor para diferentes tipos de interacciones.
- Env칤a un paquete FIN&RST en bruto al servidor e identifica una respuesta.
- Ataques de canal lateral: examina el comportamiento temporal del contenido de la solicitud y la respuesta.

## Herramientas para verificar y evadir WAF

> w3af: marco de ataque y auditor칤a de aplicaciones web

- **[wafw00f](https://github.com/EnableSecurity/wafw00f)**: Identifica y realiza fingerprint del firewall de aplicaciones web

- **[BypassWAF](https://github.com/vincentcox/bypass-firewalls-by-DNS-history):** elude firewalls abusando del historial DNS. Esta herramienta buscar치 registros A antiguos de DNS y verificar치 si el servidor responde para ese dominio.

- **[CloudFail](https://github.com/m0rtem/CloudFail)**: es una herramienta de reconocimiento t치ctico que intenta encontrar la direcci칩n IP original detr치s del WAF de Cloudflare.

## Evadiendo un Firewall de Aplicaciones Web

Existen diversas t칠cnicas de hacking espec칤ficas que pueden utilizarse para evadir diferentes tipos de firewalls, particularmente los Firewalls de

 Aplicaciones Web (WAF), como Codificaci칩n URL, Codificaci칩n Unicode, Renderizado HTML y Codificaci칩n Mixta, que modifican u ofuscan los payloads de manera que pueden eludir los mecanismos de detecci칩n del firewall.

La efectividad de estas t칠cnicas depende del tipo de firewall al que se est칠 apuntando. Por ejemplo, los firewalls de filtrado de paquetes simples pueden ser m치s susceptibles a t칠cnicas que manipulan par치metros, mientras que los firewalls m치s avanzados, como los Next-Generation Firewalls (NGFW) o los Firewalls de Aplicaciones Web (WAF), pueden requerir estrategias de evasi칩n m치s sofisticadas como Generaci칩n Din치mica de Payloads o Inyecci칩n SQL basada en tiempo.

Hemos preparado el siguiente art칤culo sobre t칠cnicas de evasi칩n de Firewalls de Aplicaciones Web para comprender mejor. Esperamos que sea un recurso pr치ctico para comprender y aplicar t칠cnicas de evasi칩n de firewalls en contextos de ciberseguridad.
